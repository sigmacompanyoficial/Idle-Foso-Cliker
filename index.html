<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Foso Cliker - Sigma Company</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JLHC8HP0RE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JLHC8HP0RE');
</script>
<style>
  :root { /* Paleta de colores "Senior" / "Cyber" */
    --bg: #020617; /* Casi negro */
    --panel: #0f172a; /* Azul pizarra oscuro */
    --accent: #22d3ee; /* Cian vibrante */
    --muted: #64748b; /* Gris azulado */
    --success: #2ecc71;
  }
  html, body {
      height: 100%; margin: 0; font-family: Inter, system-ui, Arial; color: #eef6ff; font-size: 15px;
      background: var(--bg); overflow: hidden; /* Evita el scroll */
  }
  .bigCounter { font-size: 20px; font-weight: 800; }
  .metaTiny { font-size: 12px; color: var(--muted); }
  .hidden { display: none !important; }
  .icon { width: 18px; height: 18px; stroke: currentColor; stroke-width: 2; fill: none; vertical-align: middle; }

  /* --- Main Layout --- */
  .game-container { position: relative; width: 100%; height: 100%; }
  .vaperWrap {
      position: fixed; inset: 0; z-index: 0;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
  }
  .vaperWrap svg {
      width: auto; height: 80vh; max-height: 700px;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,0.5));
      transition: transform 0.1s ease; /* Para la animaci√≥n de pulso */
  }
  /* Smoke overlay */
  .smoke-layer{position:absolute;inset:0;pointer-events:none;overflow:visible}
  .smoke{position:absolute;width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,0.6);filter:blur(0.5px);animation:smokeUp 1.2s ease-out forwards;will-change:transform,opacity}
  @keyframes smokeUp{0%{transform:translateY(0) scale(0.8);opacity:.85}100%{transform:translateY(-120px) scale(1.6);opacity:0}}
  /* Shop title fit for long names */
  .shopGrid .shopCard > div[style*="font-weight:700"]{font-size:13px;text-align:center;line-height:1.15}
  .controlsRow{display:flex;gap:12px;width:100%;justify-content:center;flex-wrap:wrap}

  /* --- Left Info Panel --- */
  .left-panel {
      position: fixed; top: 20px; left: 20px; z-index: 10;
      background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px);
      padding: 16px; border-radius: 12px; border: 1px solid rgba(100, 116, 139, 0.3);
      width: 620px; max-width: calc(100% - 40px); box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      display: flex; flex-direction: column; max-height: calc(100vh - 40px); overflow-y: auto;
  }
  .stats-grid {
      display: grid;
      flex-shrink: 0;
      grid-template-columns: auto 1fr;
      gap: 8px 12px;
      align-items: center;
  }
  .stats-grid .icon {
      grid-column: 1;
      width: 20px; height: 20px;
      color: var(--accent);
  }
  .stats-grid > div { grid-column: 2; }
  .stats-grid .bigCounter { font-size: 1.5em; }
  .stats-grid .metaTiny { color: var(--muted); }

  /* --- Right Collapsible Menu --- */
  .right-menu-toggle {
      position: fixed; top: 10px; right: 10px; z-index: 10021; /* Por encima del panel de ranking */
      width: 50px; height: 50px;
  }
  .right-menu {
      position: fixed; top: 0; right: 0; bottom: 0; z-index: 11;
      width: 280px; background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px);
      border-left: 1px solid rgba(100, 116, 139, 0.3);
      transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
      padding: 70px 20px 20px; display: flex; flex-direction: column; gap: 10px;
      overflow-y: auto; /* Scroll para el men√∫ */
  }
  .right-menu.active { transform: translateX(0); }
  .right-menu .mata-btn {
      width: 100%;
      justify-content: flex-start;
      position: relative; /* Para el punto de notificaci√≥n */
  }
  .right-menu .notify-dot { right: 12px; top: 50%; transform: translateY(-50%); }

  .right-menu .mata-btn { width: 100%; justify-content: flex-start; }

  /* Botones estilo "Senior" / "Hi-Tech" */
  .mata-btn{position:relative;display:inline-flex;align-items:center;gap:8px;padding:10px 16px;border-radius:8px;border:1px solid rgba(100, 116, 139, 0.4);background:var(--panel);color:#eef6ff;font-weight:700;cursor:pointer;box-shadow: 0 1px 2px rgba(0,0,0,0.2); transition:all .2s ease}
  .mata-btn:hover{transform:translateY(-1px);background: #1e293b; box-shadow: 0 0 15px -2px var(--accent), 0 4px 10px rgba(0,0,0,0.3);}
  .mata-btn:active{transform:translateY(0)}
  .mata-btn:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
  .mata-btn:active:not(:disabled) {
    transform: translateY(1px) scale(0.98);
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
  }
  .mata-btn[disabled]{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none;background: #0f172a; color: var(--muted);}
  .icon-16{width:16px;height:16px}
  .icon-20{width:20px;height:20px}

  .panel{background:var(--panel);padding:12px;border-radius:10px;border:1px solid rgba(100, 116, 139, 0.3); border-top: 2px solid var(--accent);}
  .shopGrid{display:grid;grid-template-columns:repeat(5, 1fr);gap:10px;margin-top:10px;overflow:auto;padding-right:6px}
  /* Tarjetas de tienda estilo "Senior" */
  .shopCard{background:var(--panel);padding:8px;border-radius:8px;display:flex;flex-direction:column;align-items:center;gap:6px;cursor:pointer;border:1px solid rgba(100, 116, 139, 0.4); transition: all 0.2s ease; box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);}

  /* --- Chat Styles --- */
  #chatPanel {
    margin-top: 15px;
    background: rgba(15, 23, 42, 0.5);
    border-radius: 10px;
    padding: 12px;
    width: 18rem;
    display: flex; flex-direction: column; /* Asegura el layout de columna flexible */
  }
  #chatPanel h3 { margin: 0 0 10px 0; color: var(--accent, #22d3ee); font-weight: 800; display:flex; align-items:center; gap:8px; }
  #mensajes {
    list-style: none; padding: 0; margin: 0; height: 220px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; flex-grow: 1; min-height: 50px;
  }
  #mensajes li {
    max-width: 85%; padding: 6px 10px; border-radius: 12px; position: relative; word-wrap: break-word; font-size: 13px; line-height: 1.3;
    transition: transform 0.2s ease-out;
    animation: slideInMessage 0.3s ease-out forwards;
  }
  @keyframes slideInMessage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  #mensajes li .hora {
    font-size: 10px; color: var(--muted); display: inline-block; margin-left: 8px; user-select: none;
  }
  #mensajes li.mio {
    background: #1a3a5a; align-self: flex-end; border-bottom-right-radius: 4px;
  }
  #mensajes li.otro {
    background: #2a3f5a; align-self: flex-start; border-bottom-left-radius: 4px;
  }
  #mensajes li.rank-gold, #rankingPanel .rank-gold td {
    background: linear-gradient(145deg, #fde047, #eab308); color: #422006; font-weight: bold;
  }
  #mensajes li.rank-silver, #rankingPanel .rank-silver td {
    background: linear-gradient(145deg, #e5e7eb, #9ca3af); color: #1f2937; font-weight: bold;
  }
  #mensajes li.rank-bronze, #rankingPanel .rank-bronze td {
    background: linear-gradient(145deg, #fcd3a1, #d97706); color: #451a03; font-weight: bold;
  }
  #mensajes li.rank-diamond, #rankingPanel .rank-diamond td {
    background: linear-gradient(145deg, #a5f3fc, #22d3ee); color: #0e7490; font-weight: bold;
  }
  #mensajes li.rank-gold strong, #mensajes li.rank-silver strong, #mensajes li.rank-bronze strong, #mensajes li.rank-diamond strong {
    color: inherit;
    text-shadow: 0 1px 1px rgba(255,255,255,0.2);
  }
  .message-content { display: flex; align-items: flex-end; }
  .message-text { flex-grow: 1; }
  .edited-indicator { font-size: 10px; color: var(--muted); margin-left: 5px; font-style: italic; }

  /* Chat Reactions */
  .reactions-container { display: flex; gap: 4px; margin-top: 4px; }
  .reaction { background: rgba(255,255,255,0.1); border-radius: 10px; padding: 2px 6px; font-size: 11px; cursor: pointer; }
  .reaction.reacted { background: var(--accent); color: var(--bg); }
  .emoji-picker {
    position: absolute;
    background: var(--panel);
    border: 1px solid var(--muted);
    border-radius: 8px;
    padding: 5px;
    display: flex;
    gap: 5px;
    bottom: 100%;
    right: 0;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s, visibility 0.2s;
  }
  li:hover .emoji-picker { opacity: 1; visibility: visible; }
  .emoji-picker span { cursor: pointer; padding: 4px; border-radius: 4px; transition: background 0.2s; }
  .emoji-picker span:hover { background: rgba(255,255,255,0.1); }
  .message-body { position: relative; }
  .message-body:hover .react-btn { opacity: 1; }
  .react-btn { position: absolute; top: 0; right: 0; transform: translateY(-100%) translateX(10px); opacity: 0; transition: opacity 0.2s; }
  .input-area { display: flex; margin-top: 10px; gap: 8px; }
  #replyingTo {
    background: rgba(0,0,0,0.2);
    padding: 8px;
    border-radius: 6px;
    margin-bottom: 8px;
    font-size: 12px;
    border-left: 3px solid var(--accent);
    position: relative;
  }
  #replyingTo p { margin: 0; color: var(--muted); }
  #replyingTo span {
    display: block;
    color: #fff;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  #cancelReply {
    position: absolute; top: 4px; right: 4px; cursor: pointer;
    width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;
  }
  .chat-ranking-container {
    display: flex;
    gap: 15px;
    overflow: hidden; /* Para que los hijos con flex:1 se comporten */
    margin-top: 10px;
    align-items: flex-start;
  }
  .chat-ranking-container > div { flex: 1; }
  .input-area input {
    flex-grow: 1;
    background: rgba(0,0,0,0.3);
    border: 1px solid var(--muted);
    color: var(--text);
    padding: 8px;
    border-radius: 6px;
    outline: none;
  }
  .input-area button {
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    background: var(--accent);
    color: var(--bg);
    cursor: pointer;
    font-weight: bold;
  }
  .shopCard:hover { box-shadow: 0 0 15px -3px var(--accent), inset 0 1px 0 rgba(255,255,255,0.03); border-color: var(--accent);}
  .shopCard img, .shopCard svg{width:72px;height:auto}
  .priceTag{background:rgba(0,0,0,0.4);padding:4px 8px;border-radius:6px;font-weight:700;font-size:13px}
  .hint{color:var(--muted);font-size:13px; line-height: 1.4; margin: 0;}
  footer{position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); text-align:center;color:var(--muted);font-size:13px; z-index: 5;}

  @media (max-width:600px){
    .left-panel { width: auto; left: 5px; right: 5px; top: 5px; padding: 10px; max-width: 100%; }
    .stats-grid { gap: 6px 10px; }
    .stats-grid .icon { width: 18px; height: 18px; }
    .stats-grid .bigCounter { font-size: 1.2em; }
    .right-menu { width: 240px; }
    .right-menu .mata-btn { padding: 8px 12px; gap: 6px; font-size: 14px; } /* Botones m√°s peque√±os */
    .right-menu { gap: 6px; } /* Menos espacio entre botones */
    .chat-ranking-container { flex-direction: column; gap: 10px; }
    .vaperWrap svg { height: 65vh; } /* Reducir altura del foso en m√≥viles */
    .modal-content { padding: 14px; width: min(96%, 980px); }
    .modal-body { padding-top: 10px; }
    .modal-title { font-size: 1.1em; }
    #rankingPanel table { font-size: 12px; }
    #rankingPanel tbody td { padding: 4px; }
    #maintenanceGameArea { width: 90%; max-width: 300px; height: 320px; }
    .vaperWrap svg.clicked {
      transform: scale(0.98); /* Animaci√≥n de pulso al hacer clic */
    }
    footer { display: none; } /* Ocultar footer en m√≥vil para m√°s espacio */
    #chatPanel { display: flex; flex-direction: column; min-height: 300px; max-height: 45vh; }
    #mensajes { height: auto; }
    .chat-ranking-container > div {
      min-width: 0; /* Allow flex items to shrink properly */
    }
  }
  @media (max-width: 900px) {
    /* 3 columnas para tablets, 2 para m√≥viles */
    .shopGrid{grid-template-columns:repeat(auto-fill, minmax(100px, 1fr));}
  }
  /* Modal mejorado: glass + bordes suaves + encabezado */
  .modal { position: fixed; inset:0; display:flex; justify-content:center; align-items:center; z-index:9999; background: rgba(3,10,20,0.65); backdrop-filter: blur(6px); }
  .modal.hidden { display:none; }
  .modal-content { /* Modal estilo "Senior" */
    position: relative; background: var(--panel); transition: transform 0.3s ease, opacity 0.3s ease;
    border: 1px solid rgba(100, 116, 139, 0.5);
    border-top: 3px solid var(--accent);
    box-shadow: 0 20px 60px rgba(0,0,0,0.55);
    animation: modalIn 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    border-radius: 16px;
    padding: 18px 18px 14px; width: min(94%, 980px); max-height: 84vh; overflow: hidden; color: #e7edf6;
  }
  .modal-header { display:flex; align-items:center; justify-content:space-between; gap:10px; padding-bottom:10px; border-bottom:1px solid rgba(100, 116, 139, 0.3); }
  .modal-title { font-weight:800; letter-spacing:.2px; }
  .close-btn { display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px; border-radius:8px; cursor:pointer; color:#9fb2c8; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06); }
  .close-btn:hover { background:rgba(255,255,255,0.08); color:#fff; }
  .modal-body { overflow:auto; max-height: calc(84vh - 68px); padding-top:12px; }
  @keyframes modalIn { from { opacity: 0; transform: scale(0.95) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }
  .modal.closing .modal-content {
    animation: modalOut 0.3s ease forwards;
  }
  @keyframes modalOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.95); } }
.powers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 15px;
  margin-top: 20px;
}
.power-card {
  background: #222;
  border: 1px solid #444;
  border-radius: 8px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  text-align: center;
}
.power-card .power-icon {
  font-size: 28px;
}
.power-card h4 {
  margin: 0;
  font-size: 14px;
}
.power-card p {
  margin: 0;
  font-size: 12px;
  transition: transform 0.2s, box-shadow 0.2s;
}
.power-card button:disabled {
  background: #444; color:#999; cursor: not-allowed;
}

/* Animaci√≥n de humo al hacer clic */
.smoke-on-click {
  position: absolute;
  bottom: 120px; /* Ajusta para que salga de la boquilla */
  left: 50%;
  width: 12px;
  height: 12px;
  background: rgba(255, 255, 255, 0.6);
  border-radius: 50%;
  filter: blur(2px);
  transform: translateX(-50%);
  pointer-events: none;
  animation: smokeUpOnClick 1.5s ease-out forwards;
}

@keyframes smokeUpOnClick { /* Ajustado para el foso grande */
  from { transform: translate(-50%, 0) scale(0.5); opacity: 0.9; }
  to   { transform: translate(-50%, -80px) scale(2.5); opacity: 0; }
}

/* --- Toast (Notificaciones) Estilo "Senior" --- */
#toastContainer {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column-reverse;
  gap: 10px;
  z-index: 10002;
  align-items: center;
}
.toast {
  display: flex; align-items: center; gap: 10px;
  background: var(--panel); color: #eef6ff;
  padding: 10px 16px; border-radius: 10px;
  border: 1px solid rgba(100, 116, 139, 0.4);
  box-shadow: 0 5px 20px rgba(0,0,0,0.4);
  font-weight: 600; font-size: 14px;
  animation: toastIn 0.3s ease forwards, toastOut 0.3s ease 1.7s forwards;
}
@keyframes toastIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes toastOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(20px); } }

#autoClickPointer {
  position: absolute;
  width: 24px;         /* m√°s peque√±o */
  height: 24px;
  background: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%23ffffff' d='M3 2l7 18 2-7 7-2z'/><path fill='%23000000' opacity='0.2' d='M10 20l2-7 7-2-9 9z'/></svg>") no-repeat center;
  background-size: contain;
  pointer-events: none;  /* no bloquea nada */
  opacity: 0;
  transform: scale(1);
  transition: transform 0.15s ease, opacity 0.15s ease;
  z-index: 1;           /* por debajo de UI pero encima del foso */
}
#autoClickPointer.active {
  opacity: 0.8;         /* aparece m√°s sutil */
  transform: scale(0.7);
}

.click-value {
  position: absolute;
  z-index: 10;
  pointer-events: none;
  font-size: 22px;
  font-weight: bold;
  color: #fff;
  text-shadow: 0 0 5px #ffc107, 0 0 10px #ffc107;
  animation: floatUp 1s ease-out forwards;
  white-space: nowrap; /* Evita que el texto se parta */
}

/* Click Ripple Animation */
.ripple {
  position: absolute;
  border-radius: 50%;
  background: rgba(34, 211, 238, 0.5);
  transform: scale(0);
  animation: ripple-effect 0.6s ease-out;
  pointer-events: none;
}
@keyframes ripple-effect { to { transform: scale(4); opacity: 0; } }


.notify-dot {
  position: absolute;
  top: 6px; right: 10px; width: 8px; height: 8px;
  background: #ef4444; border-radius: 50%;
  border: 1px solid var(--panel);
  box-shadow: 0 0 5px #ef4444;
}
.right-menu-toggle .notify-dot {
  position: absolute;
  top: 8px; right: 8px; width: 10px; height: 10px;
  background: #ef4444; border-radius: 50%;
  box-shadow: 0 0 5px #ef4444;
}

/* --- Estilos de Mantenimiento --- */
.maintenance-bar-container {
    width: 80%;
    max-width: 250px;
    margin-top: 5px;
    text-align: center;
}
.maintenance-bar {
    height: 12px;
    background: rgba(0,0,0,0.4);
    border-radius: 6px;
    border: 1px solid #444;
    overflow: hidden;
}
.maintenance-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #2ecc71, #f1c40f, #e74c3c);
    background-size: 300% 100%;
    transition: background-position 0.5s ease, width 0.5s ease;
}

/* Animaci√≥n de vibraci√≥n para foso da√±ado */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
  20%, 40%, 60%, 80% { transform: translateX(2px); }
}
.foso-shaking {
    animation: shake 0.5s infinite;
}
@keyframes floatUp {
    from { transform: translateY(0); opacity: 1; }
    to   { transform: translateY(-60px); opacity: 0; }
}

/* Animaci√≥n de vibraci√≥n para combo m√°ximo */
@keyframes combo-shake {
  0%, 100% { transform: translate(-1px, 1px) rotate(-1deg); }
  25% { transform: translate(1px, 1px) rotate(1deg); }
  50% { transform: translate(1px, -1px) rotate(-1deg); }
  75% { transform: translate(-1px, -1px) rotate(1deg); }
}
.foso-combo-max {
    animation: combo-shake 0.2s infinite;
}
.vaperWrap svg.clicked {
  transform: scale(0.99);
}


/* Lluvia de Monedas */
.coin-rain {
    position: fixed; top: -50px; left: 0; width: 100%; height: 100vh;
    pointer-events: none; z-index: 10003;
}
.coin {
    position: absolute; font-size: 24px; animation: fall 5s linear forwards;
}
@keyframes fall { from { top: -50px; } to { top: 100vh; transform: rotate(720deg); } }


/* Humo negro para foso da√±ado */
.black-smoke {
    background: rgba(50, 50, 50, 0.7) !important;
    filter: blur(3px) !important;
}

/* Mini-juego de Mantenimiento */
#maintenanceGameArea {
    position: relative;
    width: 300px;
    height: 360px;
    margin: 20px auto;
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 260"><rect x="20" y="20" width="60" height="220" rx="12" fill="%23333"/><rect x="20" y="0" width="60" height="20" rx="10" fill="%23111"/></svg>') no-repeat center center;
    background-size: contain;
}
.maintenance-point {
    position: absolute;
    width: 30px; height: 30px; background: rgba(255, 255, 0, 0.8);
    border: 2px solid white; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    font-weight: bold; color: black; cursor: pointer;
}
/* --- Estilos de Eventos Aleatorios --- */
#eventBanner {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(45deg, var(--accent), #f39c12);
    color: black;
    text-align: center;
    padding: 10px;
    font-weight: bold;
    z-index: 10001; /* Encima de todo */
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
}
/* Achievement Styles */
#achievementsGrid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 12px;
}

.achievement-card {
    background: var(--panel);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 8px;
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.2s ease;
}

.achievement-card.unlocked {
    background: linear-gradient(145deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.02));
    border-color: rgba(245, 158, 11, 0.3);
}

.achievement-icon {
    font-size: 28px;
    flex-shrink: 0;
    width: 32px; height: 32px;
}

.achievement-card.locked .achievement-icon {
    filter: grayscale(100%);
    opacity: 0.5;
}

.achievement-info h4 {
    margin: 0 0 4px;
    font-size: 14px;
    color: #fff;
}

.achievement-card.locked .achievement-info h4 {
    color: var(--muted);
}

.achievement-info p {
    margin: 0;
    font-size: 12px;
    color: var(--muted);
}

.achievement-card.unlocked .achievement-info p {
    color: #f5b041;
}

/* Wheel Styles */
.wheel-container {
    position: relative;
    width: 300px;
    height: 300px;
    margin: 20px auto;
}

.wheel-pointer {
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-top: 35px solid var(--accent);
    z-index: 10;
    filter: drop-shadow(0 -2px 2px rgba(0,0,0,0.5));
}

.wheel {
    list-style: none;
    padding: 0;
    margin: 0;
    position: relative;
    width: 300px;
    height: 300px;
    border-radius: 50%;
    overflow: hidden;
    transition: transform 5s cubic-bezier(0.2, 0.8, 0.2, 1);
    border: 8px solid #1a2a4a;
    box-shadow: 0 0 20px rgba(0,0,0,0.6), inset 0 0 15px rgba(0,0,0,0.4);
}

.wheel .segment {
    overflow: hidden;
    position: absolute;
    top: 0;
    right: 0;
    width: 50%;
    height: 50%;
    transform-origin: 0% 100%;
}

.wheel .segment .text {
    position: absolute;
    left: -100%;
    width: 200%;
    height: 200%;
    text-align: center;
    display: block;
    transform: skewY(45deg) rotate(22.5deg);
    background: var(--color);
    padding-top: 50px;
    font-weight: bold;
    color: white;
    font-size: 14px;
}

/* Mission Styles */
#missionsGrid {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.mission-card {
    background: var(--panel);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 8px;
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.mission-info {
    flex-grow: 1;
}

.mission-info h4 {
    margin: 0 0 4px;
    font-size: 14px;
}

.mission-progress-bar {
    width: 100%;
    height: 10px;
    background: rgba(0,0,0,0.3);
    border-radius: 5px;
    overflow: hidden;
    margin-top: 5px;
}

.mission-progress-fill {
    width: 0%;
    height: 100%;
    background: var(--accent);
    transition: width 0.3s ease;
}

.mission-card button {
    flex-shrink: 0;
}

/* --- Estilos del Panel de Ranking --- */
#rankingPanel {
  position: relative;
  width: auto;
  background: rgba(15, 23, 42, 0.5);
  border-radius: 10px;
  padding: 12px;
  color: #e7eef6;
  font-family: Inter, system-ui, Arial;
  font-size: 14px;
}
#rankingPanel h3 {
  margin: 0 0 10px 0;
  color: var(--accent, #22d3ee);
  font-weight: 800;
  display:flex; align-items:center; gap:8px;
}
#rankingPanel h3 svg {
  width: 24px; height: 24px;
  animation: trophy-shine 3s infinite;
}
@keyframes trophy-shine {
  0%, 100% { filter: drop-shadow(0 0 1px var(--accent)); }
  50% { filter: drop-shadow(0 0 6px var(--accent)); }
}
#rankingPanel #rankingTable tr {
  opacity: 0;
  transform: translateY(10px);
  animation: fadeInRow 0.5s ease forwards;
}
#rankingPanel .ranking-table-container { max-height: 200px; overflow-y: auto; }
#rankingPanel table { width:100%; border-collapse:collapse; }
#rankingPanel thead th { text-align:left; color: rgba(230,240,255,0.7); font-weight:700; padding:6px 6px 8px 0; font-size:12px; }
#rankingPanel tbody td { padding:6px 6px; border-bottom: 1px solid rgba(100,116,139,0.08); font-size:13px; color:#dfeeff; }
#rankingControls { display:flex; gap:8px; margin:10px 0 8px 0; align-items:center; }
#playerNameInput { flex:1; padding:6px 8px; border-radius:8px; border:1px solid rgba(100,116,139,0.2); background:rgba(0,0,0,0.12); color:inherit; }
.mini-btn { padding:6px 8px; border-radius:8px; border:none; cursor:pointer; font-weight:700; background: linear-gradient(90deg,#16a34a,#10b981); color:#04101a; }
.mini-btn.ghost { background: rgba(255,255,255,0.03); color:var(--muted,#aab4c4); border:1px solid rgba(100,116,139,0.12); }
#rankingEmpty { color: var(--muted,#8aa0b8); font-size:13px; padding:6px 0; }
#registerPrompt { font-size: 11px; color: #f59e0b; text-align: center; padding: 4px; background: rgba(245, 158, 11, 0.1); border-radius: 4px; margin-bottom: 6px; display: none; }
@keyframes fadeInRow {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
#rankingPanel .currentUser td {
  background: rgba(34, 211, 238, 0.1);
  font-weight: bold;
  color: #fff;
}
#vaperWrap, .vaperWrap {
  position: absolute;
  left: calc(50% + 100px);
  transform: translateX(-50%);
  z-index: 5;
}
/* --- Scroll vertical en la tabla de ranking --- */
#rankingContainer {
  max-height: 400px;   /* altura m√°xima visible */
  overflow-y: auto;    /* activa scroll vertical */
  scrollbar-width: thin; /* estiliza scroll (Firefox) */
}

/* opcional: estilo m√°s limpio en navegadores webkit */
#rankingContainer::-webkit-scrollbar {
  width: 8px;
}
#rankingContainer::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.3);
  border-radius: 4px;
}
#rankingContainer::-webkit-scrollbar-thumb:hover {
  background: rgba(255,255,255,0.5);
}
/* --- Scroll vertical solo dentro del √°rea del ranking --- */
#rankingContainer {
  max-height: 250px;   /* ajusta seg√∫n el espacio del panel */
  overflow-y: auto;    /* activa scroll vertical */
  overflow-x: hidden;  /* evita desplazamiento lateral */
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  margin-top: 6px;
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.3) transparent;
}

/* scroll m√°s limpio en Chrome / Edge */
#rankingContainer::-webkit-scrollbar {
  width: 8px;
}
#rankingContainer::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.3);
  border-radius: 4px;
}
#rankingContainer::-webkit-scrollbar-thumb:hover {
  background: rgba(255,255,255,0.5);
}

@media (max-width:900px){
  /* en pantallas peque√±as permitimos ocultar el panel con bot√≥n */
  #rankingPanel.collapsed { transform: translateX(-220px); transition: transform .25s ease; }
}

</style>
  <link rel="icon" type="image/png" href="logo%20oficial.png">
  <link rel="apple-touch-icon" href="logo%20oficial.png">
  <meta property="og:image" content="logo%20oficial.png">
</head>
<body>
  <!-- Banner para Eventos Aleatorios -->
  <div id="eventBanner" class="hidden">
      <span id="eventName"></span> - <span data-lang="time_left">Tiempo restante</span>: <span id="eventTimer">60s</span>
  </div>
<body>
  <div id="intro-animation" style="position:fixed;inset:0;background:#020617;display:flex;justify-content:center;align-items:center;z-index:10000;flex-direction:column;color:white;font-family:Arial,sans-serif;opacity:1;transition:opacity 1s ease-out;" class="no-scroll">
      <div class="intro-slide" id="intro-text1">
          <div style="width: 150px; height: 150px; margin-bottom: 20px;">
              <img src="ChatGPT Image 8 de set. del 2025, 12_51_42.png" alt="Sigma Company Logo" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <h1>Sigma Company Presenta</h1>
      </div>
      <div class="intro-slide" id="intro-text2" style="display:none;">
          <div style="width: 150px; height: 150px; margin-bottom: 20px;">
              <img src="logo oficial.png" alt="Idle Foso Clicker Logo" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <h1>Foso Tycoon</h1>
      </div>
  </div>
  <style>
      .intro-slide {
          display: flex;
          flex-direction: column;
          align-items: center;
          position: absolute;
          opacity: 0;
          transform: scale(0.9);
          transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      }
      .intro-slide.active {
          opacity: 1;
          transform: scale(1);
      }
  </style>

  <!-- Pantalla de advertencia mejorada -->
  <div id="advertencia" style="position:fixed;inset:0;background:#000;display:flex;justify-content:center;align-items:center;z-index:9999; padding: 10px;">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" style="width:100%;max-width:1200px;height:auto" font-family="Arial" font-weight="bold" text-anchor="middle">
      <defs>
        <radialGradient id="gBg" cx="50%" cy="40%" r="70%">
          <stop offset="0%" stop-color="#111"/>
          <stop offset="100%" stop-color="#000"/>
        </radialGradient>
      </defs>
      <rect width="800" height="600" fill="url(#gBg)"/>
      <polygon points="400,100 500,300 300,300" fill="yellow" stroke="black" stroke-width="5"/>
      <text x="400" y="280" font-size="150" fill="black">!</text>
      <text x="400" y="380" font-size="54" fill="white">FOSO IDLE TYCOON</text>
      <text x="400" y="430" font-size="54" fill="white">es una obra de ficci√≥n.</text>
      <text x="400" y="500" font-size="45" fill="white">Fumar y vapear da√±an la salud.</text>
      <text x="400" y="560" font-size="42" fill="white">Juega de forma responsable.</text>
    </svg>
  </div>
  
  <div class="game-container">
    <div class="left-panel">
        <div class="stats-grid">
            <!-- Sigmacoins -->
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
            <div>
                <div class="bigCounter"><span id="sigTotal">0</span> Œ£C</div>
                <div class="metaTiny"><span data-lang="per_click">Por clic</span>: <span id="perClick">1</span> Œ£C</div>
            </div>

            <!-- Rango -->
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
            <div>
                <div id="rankTitle" style="font-weight: bold; color: var(--accent);"></div>
                <div class="metaTiny"><span data-lang="total_clicks">Clicks totales</span>: <span id="totalClicks">0</span></div>
            </div>

            <!-- Moneda Exclusiva -->
            <svg class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M5 16L3 5l5.5 5L12 3l3.5 7L21 5l-2 11H5zm14 3H5a1 1 0 0 0 0 2h14a1 1 0 0 0 0-2z"/></svg>
            <div>
                <div class="bigCounter"><span id="exclusiveMoneyTotal">0</span> üëë</div>
                <div class="metaTiny" data-lang="exclusive_currency">Moneda Exclusiva</div>
            </div>

            <!-- Racha Diaria -->
            <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            <div>
                <div style="font-weight:700"><span data-lang="streak">Racha</span>: <span id="dailyStreak">0</span> <span data-lang="days">d√≠as</span></div>
                <div class="metaTiny" id="streakHint" data-lang="streak_hint">Vuelve cada d√≠a para aumentar tu racha</div>
            </div>
        </div>

          <!-- Barra de Combo -->
          <div id="comboContainer" class="hidden" style="width: 100%; text-align: center; margin-top: 15px;">
              <div id="comboText" style="font-weight: bold; color: #ffc107; font-size: 16px;"></div>
              <div style="background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden; height: 8px; margin-top: 4px;">
                  <div id="comboBar" style="width: 100%; height: 100%; background: #ffc107; transition: width 0.1s linear;"></div>
              </div>
          </div>

          <!-- Barra de Condici√≥n del Foso -->
          <div class="maintenance-bar-container" style="width: 100%; max-width: none; margin-top: 15px;">
              <div class="metaTiny" data-lang="foso_condition" style="display: flex; align-items: center; gap: 4px;"><svg class="icon" style="width:14px; height:14px;" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg> Condici√≥n del Foso</div>
              <div class="maintenance-bar">
                  <div id="maintenanceBarFill" class="maintenance-bar-fill"></div>
              </div>
          </div>

          <div class="chat-ranking-container">
            <!-- Chat Panel -->
            <div id="chatPanel">
              <h3><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path fill="currentColor" d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg> Sigma Chat</h3>
              <div id="replyingTo" class="hidden">
                <!-- Contenido de la respuesta aqu√≠ -->
              </div>
              <ul id="mensajes"></ul>
              <div class="input-area">
                <input id="msg" placeholder="Escribe un mensaje..." />
                <button id="enviar">Enviar</button>
              </div>
            </div>
            <!-- Panel de Ranking movido aqu√≠ -->
            <div id="rankingPanel" aria-label="Ranking ‚Äî M√°s clics, m√°s dinero">
              <h3><svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.2,5.2H18V3c0-0.6-0.4-1-1-1h-2.4c-0.6,0-1,0.4-1,1v2.2H8.2V3c0-0.6-0.4-1-1-1H4.8c-0.6,0-1,0.4-1,1v2.2H2.2 C1.5,5.2,1,5.7,1,6.4v3.2c0,0.4,0.2,0.7,0.5,0.9l7.5,4.5c0.3,0.2,0.7,0.2,1,0l7.5-4.5c0.3-0.2,0.5-0.5,0.5-0.9V6.4 C21.2,5.7,20.7,5.2,20.2,5.2z M4.8,18.8h14.4c0.6,0,1-0.4,1-1V11l-7.5,4.5c-0.3,0.2-0.7,0.2,1,0L3.8,11v6.8 C3.8,18.4,4.2,18.8,4.8,18.8z M19.2,20.8H4.8c-1.2,0-2.2-1-2.2-2.2v-1.2h18.8v1.2C21.4,19.8,20.4,20.8,19.2,20.8z"/></svg> Ranking</h3>
              <div id="registerPrompt">¬°Registra tu nombre para guardar tu puntuaci√≥n!</div>
              <div id="rankingControls">
                <input id="playerNameInput" placeholder="Tu nombre (Ej: Pepe42)" value="Jugador" />
                <button id="btnSaveNow" class="mini-btn" title="Guardar ahora">Guardar</button>
              </div>
              <div style="display:flex;gap:8px;align-items:center;margin-bottom:6px;">
                <div class="metaTiny" style="flex:1;color:var(--muted,#9fb2c8)">Œ£C: <span id="panelSigma">0</span></div>
                <div class="metaTiny" style="color:var(--muted,#9fb2c8)">Clicks: <span id="panelClicks">0</span></div>
              </div>
              <div id="rankingContainer">
                <table aria-live="polite" role="table">
                  <thead>
                    <tr><th>Jugador</th><th style="text-align:center">Clics</th></tr>
                  </thead>
                  <tbody id="rankingTable">
                    <tr id="rankingEmptyRow"><td colspan="3" id="rankingEmpty">Cargando ranking‚Ä¶</td></tr>
                  </tbody>
                </table>
              </div>
              <div style="margin-top:12px; display:flex; gap:8px;">
                <button id="btnToggleSave" class="mini-btn ghost" title="Activar/Desactivar guardado autom√°tico">Auto-save: ON</button>
                <button id="btnRefreshRanking" class="mini-btn ghost" title="Forzar recarga del ranking">Refrescar</button>
              </div>
            </div>
          </div>
<!-- ===========================
     SCRIPTS: FIREBASE + L√ìGICA
     =========================== -->
<script type="module">
  // ----- IMPORTS de Firebase (modular) -----
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getDatabase, ref, set, update, onValue, get, child, push, onChildAdded, onChildChanged, remove, query, limitToFirst } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

  // ----- CONFIG: reemplaza esto con tu firebaseConfig real -----
  const firebaseConfig = {
    apiKey: "AIzaSyDaS5OObMey6w21wyE2svLxFH9uKO5g6Gg",
    authDomain: "foso-game.firebaseapp.com",
    databaseURL: "https://foso-game-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "foso-game",
    storageBucket: "foso-game.firebasestorage.app",
    messagingSenderId: "256849527517",
    appId: "1:256849527517:web:2d9ef58d80d4b772a61134",
    measurementId: "G-JLHC8HP0RE"
  };
  // ------------------------------------------------------------

  // Inicializar Firebase
  let app, db;
  try {
    app = initializeApp(firebaseConfig);
    db = getDatabase(app);
  } catch (e) {
    console.error("Firebase initialization error:", e);
    document.getElementById('rankingEmpty').innerText = "Error Firebase: revisa firebaseConfig en el HTML.";
  }

  // Elementos UI
  const rankingTable = document.getElementById("rankingTable");
  const rankingEmpty = document.getElementById("rankingEmpty");
  const playerNameInput = document.getElementById("playerNameInput");
  const btnSaveNow = document.getElementById("btnSaveNow");
  const btnToggleSave = document.getElementById("btnToggleSave");
  const btnRefreshRanking = document.getElementById("btnRefreshRanking");
  const panelSigma = document.getElementById("panelSigma");
  const registerPrompt = document.getElementById("registerPrompt");
  const panelClicks = document.getElementById("panelClicks");
  let localPlayerId = localStorage.getItem('localPlayerId') || `Jugador#${Math.floor(1000 + Math.random() * 9000)}`;

  // Variable global para guardar el ranking ordenado
  let rankedPlayers = [];

  // Chat UI Elements
  const chatLista = document.getElementById("mensajes");
  const chatInput = document.getElementById("msg");
  const chatEnviarBtn = document.getElementById("enviar");
  const replyingToContainer = document.getElementById('replyingTo');

  // Usa los ids existentes en tu HTML si existen (para reflejar valores en el panel)
  const totalClicksEl = document.getElementById("totalClicks");
  const sigTotalEl = document.getElementById("sigTotal");

  // Modo auto-save
  let autoSaveEnabled = true;
  let autoSaveInterval = 5000; // ms
  let autoSaveTimer = null;

  // Estado del chat
  let replyingTo = null;

  // Guarda los datos del jugador en Realtime DB
  function savePlayerData(nombre, clicks, dinero, isAutoSave = false, oldNameToDelete = null) {
    if (!db || !nombre) return;
    if (!localStorage.getItem('playerName') && isAutoSave) return; // No auto-guardar si no hay nombre registrado

    // Si se est√° cambiando el nombre, borrar el antiguo.
    // oldNameToDelete es el nombre que estaba antes en localStorage o el ID de jugador temporal.
    if (oldNameToDelete && oldNameToDelete !== nombre) {
        remove(ref(db, 'players/' + sanitizeKey(oldNameToDelete))).catch(err => console.error("Error deleting old player data:", err));
    }

    const key = sanitizeKey(nombre);
    set(ref(db, 'players/' + key), {
      name: nombre,
      clicks: Number(clicks) || 0,
      dinero: Number(dinero) || 0,
      updatedAt: Date.now()
    }).catch(err => console.error("savePlayerData error:", err));
  }

  // Cargar ranking (suscripci√≥n en tiempo real)
  function loadRankingRealtime() {
    if (!db) return;
    const playersRef = ref(db, 'players');
    onValue(playersRef, (snapshot) => {
      const val = snapshot.val();
      renderRanking(val);
    }, (err) => {
      console.error("onValue error:", err);
      rankingEmpty.innerText = "No se pudo cargar el ranking.";
    });
  }

  // Renderiza la tabla desde el objeto players
  function renderRanking(dataObj) {
    rankingTable.innerHTML = "";
    if (!dataObj) {
      rankingEmpty.innerText = "A√∫n no hay jugadores.";
      rankingTable.appendChild(document.getElementById('rankingEmptyRow'));
      return;
    }
    // Transformar en array, ordenar y guardar en la variable global
    const players = Object.entries(dataObj).map(([k,v]) => {
      // soporta tanto estructura con nombre dentro como sin ella
      return {
        key: k,
        name: v?.name ?? k,
        clicks: Number(v?.clicks ?? 0),
        dinero: Number(v?.dinero ?? 0),
        updatedAt: v?.updatedAt ?? 0
      };
    }).sort((a,b) => b.clicks - a.clicks);
    
    rankedPlayers = players; // Actualizar la lista global
    // Si est√° vac√≠o
    if (players.length === 0) {
      rankingEmpty.innerText = "A√∫n no hay jugadores.";
      rankingTable.appendChild(document.getElementById('rankingEmptyRow'));
      return;
    }

    // Limitar filas al Top 15
    const top15 = players.slice(0, 15);
    const currentPlayerName = localStorage.getItem('playerName') || localPlayerId;
    let isPlayerInTop15 = false;

    top15.forEach((p, i) => {
      const tr = document.createElement("tr");
      const rankClasses = {
        0: 'rank-gold',
        1: 'rank-silver',
        2: 'rank-bronze'
      };
      tr.style.animationDelay = `${i * 0.05}s`;
      if (p.name === currentPlayerName) {
        tr.classList.add('currentUser');
        isPlayerInTop15 = true;
      }
      if (p.name.toLowerCase() === 'ceo') tr.classList.add('rank-diamond');
      else if (rankClasses[i]) tr.classList.add(rankClasses[i]);

      tr.innerHTML = `
        <td style="padding-left:6px; max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${escapeHtml(p.name)}">${escapeHtml(p.name)}</td>
        <td style="text-align:center">${p.clicks.toLocaleString()}</td>
      `;
      rankingTable.appendChild(tr);
    });

    // Si el jugador no est√° en el top 15, pero existe en la lista, a√±adirlo al final para que vea su posici√≥n
    if (!isPlayerInTop15) {
        const playerIndex = players.findIndex(p => p.name === currentPlayerName);
        if (playerIndex > -1) {
            const player = players[playerIndex];
            const rankClasses = {
                0: 'rank-gold',
                1: 'rank-silver',
                2: 'rank-bronze'
            };
            const tr = document.createElement("tr");
            tr.className = 'currentUser';
            if (player.name.toLowerCase() === 'ceo') tr.classList.add('rank-diamond');
            else if (rankClasses[playerIndex]) tr.classList.add(rankClasses[playerIndex]);

            tr.innerHTML = `
                <td style="padding-left:6px; max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${escapeHtml(player.name)}">${playerIndex + 1}. ${escapeHtml(player.name)}</td>
                <td style="text-align:center">${player.clicks.toLocaleString()}</td>
            `;
            rankingTable.appendChild(tr);
        }
    }
  }

  // Util: sanear clave para Realtime DB (no puntos, #, $, [, ])
  function sanitizeKey(k) {
    return String(k).replace(/[.#$[\]]/g, "_");
  }

  // Escape simple para nombres en HTML
  function escapeHtml(s) {
    return String(s).replace(/[&<>"']/g, c => ({
      '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
    }[c]));
  }

  // Formatear n√∫meros grandes con sufijos (k, M, B, T...)
  function formatNum(n) {
      if (n < 1e3) return n.toString();
      const suffixes = ["", "k", "M", "B", "T", "Qa", "Qi", "Sx", "Sp", "Oc", "No", "Dc"];
      const i = Math.floor(Math.log10(n) / 3);
      const num = (n / Math.pow(10, i * 3));
      // Evitar decimales si el n√∫mero es entero (ej: 1.00k -> 1k)
      // Mostrar 1 o 2 decimales si los tiene.
      if (num % 1 === 0) {
          return num.toFixed(0) + suffixes[i];
      } else if (num < 10) {
          return num.toFixed(2) + suffixes[i];
      }
      return num.toFixed(1) + suffixes[i];
  }

  // Actualiza los valores del panel desde tu UI del juego si existen
  function refreshPanelFromGameUI() {
    const clicks = totalClicksEl ? (Number(totalClicksEl.innerText) || 0) : 0;
    const dinero = window.gameState ? window.gameState.sig : 0; // Usar el estado real del juego
    panelClicks.innerText = clicks.toLocaleString();
    panelSigma.innerText = dinero.toLocaleString();
  }

  // Guardado autom√°tico peri√≥dico (toma el nombre del input)
  function startAutoSave() {
    stopAutoSave();
    autoSaveTimer = setInterval(() => {
      const name = localStorage.getItem('playerName') || localPlayerId; // Usar siempre el nombre guardado para el auto-save
      const clicks = totalClicksEl ? parseInt(totalClicksEl.innerText.replace(/,/g, ''), 10) || 0 : 0;
      const dinero = window.gameState ? window.gameState.sig : 0;
      savePlayerData(name, clicks, dinero, true); // isAutoSave = true
      // actualizar panel (local)
      refreshPanelFromGameUI();
    }, autoSaveInterval);
  }
  function stopAutoSave() {
    if (autoSaveTimer) clearInterval(autoSaveTimer);
    autoSaveTimer = null;
  }

  // Botones UI
  btnSaveNow.addEventListener("click", async () => {
    const oldName = localStorage.getItem('playerName') || localPlayerId;
    const newName = playerNameInput.value.trim();
    if (!newName) {
        showToast("El nombre no puede estar vac√≠o.", "error");
        return;
    }

    // Si el nombre ha cambiado y no es la primera vez (ya hay un nombre guardado)
    if (newName !== oldName && localStorage.getItem('playerName')) {
        if ((state.exclusiveMoney || 0) < 1000) {
            showToast("Necesitas 1000 üëë para cambiar tu nombre.", "error");
            playerNameInput.value = oldName; // Revertir al nombre anterior
            return;
        }
        state.exclusiveMoney -= 1000;
        showToast("-1000 üëë por cambiar de nombre.", "info");
    }

    // Comprobar si el nombre ya existe
    const playersSnapshot = await get(ref(db, 'players'));
    const playersData = playersSnapshot.val() || {};
    const existingPlayer = Object.values(playersData).find(p => p.name.toLowerCase() === newName.toLowerCase());

    if (existingPlayer && existingPlayer.name.toLowerCase() !== oldName.toLowerCase()) {
        showToast(`El nombre "${newName}" ya est√° en uso. Elige otro.`, "error");
    } else {
        // Guardar el nombre localmente
        localStorage.setItem('playerName', newName);
        // Si el nombre es nuevo, actualizamos el localPlayerId para futuras sesiones si no se guarda un nombre.
        if (newName !== oldName) {
            localPlayerId = newName;
            localStorage.setItem('localPlayerId', localPlayerId);
        }

        registerPrompt.style.display = 'none';

        const clicks = totalClicksEl ? parseInt(totalClicksEl.innerText.replace(/,/g, ''), 10) || 0 : 0;
        const dinero = window.gameState ? window.gameState.sig : 0;
        // Pasamos el nombre antiguo para que sea borrado si es diferente
        savePlayerData(newName, clicks, dinero, false, oldName);
        refreshPanelFromGameUI();
        btnSaveNow.innerText = "Guardado ‚úì";
        setTimeout(()=> btnSaveNow.innerText = "Guardar", 900);
    }
  });

  btnToggleSave.addEventListener("click", () => {
    autoSaveEnabled = !autoSaveEnabled;
    btnToggleSave.innerText = autoSaveEnabled ? "Auto-save: ON" : "Auto-save: OFF";
    btnToggleSave.classList.toggle("ghost", !autoSaveEnabled);
    if (autoSaveEnabled) startAutoSave(); else stopAutoSave();
  });

  btnRefreshRanking.addEventListener("click", () => {
    // Si quieres forzar una recarga puntual, simplemente recarga la subscripci√≥n
    loadOnceAndRender();
  });

  // Carga inicial y mecanismos
  function loadOnceAndRender() {
    if (!db) return;
    // Leer una vez y renderizar (complemento a la suscripci√≥n)
    const dbRef = ref(db);
    get(child(dbRef, 'players')).then(snapshot => {
      renderRanking(snapshot.val());
    }).catch(err => {
      console.error("loadOnce error:", err);
    });
  }

  // On start: suscribirse y arrancar auto-save
  (function initRankingModule(){
    refreshPanelFromGameUI();
    localPlayerId = localStorage.getItem('localPlayerId') || `Jugador#${Math.floor(1000 + Math.random() * 9000)}`;
    localStorage.setItem('localPlayerId', localPlayerId);
    const savedName = localStorage.getItem('playerName');
    if (savedName) {
        playerNameInput.value = savedName;
    } else {
        registerPrompt.style.display = 'block';
        playerNameInput.value = localPlayerId;
    }
    if (db) {
      loadRankingRealtime(); // escucha en tiempo real
      loadOnceAndRender();   // carga inicial
      if (autoSaveEnabled) startAutoSave();
    }
    // actualizar panel cada segundo para reflejar cambios locales en la UI del juego
    setInterval(refreshPanelFromGameUI, 1000);
    // Guardar antes de cerrar (√∫ltimo intento)
    window.addEventListener("beforeunload", () => {
      if (!db) return;
      const name = localStorage.getItem('playerName') || localPlayerId;
      const clicks = totalClicksEl ? parseInt(totalClicksEl.innerText.replace(/,/g, ''), 10) || 0 : 0;
      const dinero = window.gameState ? window.gameState.sig : 0;
      try { savePlayerData(name, clicks, dinero); } catch(e){}
    });
    playerNameInput.addEventListener('input', () => {
        registerPrompt.style.display = (!name || name === "Jugador") ? 'block' : 'none';
    });

    // ----- CHAT LOGIC -----
    const chatRef = ref(db, "chat");


    // Mostrar mensajes nuevos
    onChildAdded(chatRef, (snap) => {
      if (!chatLista) return;
      const data = snap.val();
      const li = document.createElement("li");
      const hora = new Date(data.hora).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      
      const miNombre = playerNameInput.value || localPlayerId;
      const isMyMessage = data.nombre === miNombre;

      // Rellenar el contenido del mensaje
      li.innerHTML = buildMessageHTML(data, miNombre);
      
      // Asignar clases de ranking y tipo de mensaje
      assignMessageClasses(li, data, miNombre);

      li.id = snap.key;

      // A√±adir listener para responder
      li.addEventListener('click', () => {
        replyingTo = { id: snap.key, nombre: data.nombre, texto: data.texto };
        renderReplyingTo();
      });

      // A√±adir listener para editar (si es mi mensaje)
      if (isMyMessage) {
        li.addEventListener('dblclick', () => editMessage(snap.key, li));
      }

      // Listeners para reacciones
      li.querySelectorAll('.reaction, .emoji-picker span').forEach(el => {
        el.addEventListener('click', (e) => {
          e.stopPropagation(); // Evitar que se active el "responder"
          toggleReaction(snap.key, el.dataset.emoji);
        });
      });

      chatLista.appendChild(li);
      chatLista.scrollTop = chatLista.scrollHeight; // scroll autom√°tico
    });

    // Actualizar mensajes existentes (para reacciones, ediciones, etc.)
    onChildChanged(chatRef, (snap) => {
        const messageId = snap.key;
        const data = snap.val();
        const li = document.getElementById(messageId);
        if (li) {
            const miNombre = playerNameInput.value || localPlayerId;
            const isMyMessage = data.nombre === miNombre;

            // Guardar el estado del scroll
            const isScrolledToBottom = chatLista.scrollHeight - chatLista.clientHeight <= chatLista.scrollTop + 1;

            // Actualizar el contenido del mensaje
            li.innerHTML = buildMessageHTML(data, miNombre);
            
            // Re-asignar clases por si el ranking del jugador ha cambiado
            assignMessageClasses(li, data, miNombre);

            // Re-adjuntar los listeners
            li.addEventListener('click', () => {
                replyingTo = { id: snap.key, nombre: data.nombre, texto: data.texto };
                renderReplyingTo();
            });

            if (isMyMessage) {
                li.addEventListener('dblclick', () => editMessage(snap.key, li));
            }

            li.querySelectorAll('.reaction, .emoji-picker span').forEach(el => {
                el.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleReaction(snap.key, el.dataset.emoji);
                });
            });

            // Restaurar el scroll si estaba al final
            if (isScrolledToBottom) {
                chatLista.scrollTop = chatLista.scrollHeight;
            }
        }
    });

    function buildMessageHTML(data, miNombre) {
        const hora = new Date(data.hora).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        let replyHtml = '';
        if (data.replyTo) {
            replyHtml = `<div style="background:rgba(0,0,0,0.15); padding: 4px 8px; border-radius:6px; margin-bottom:4px; font-size:11px; border-left: 2px solid #64748b;"><strong>${escapeHtml(data.replyTo.nombre)}:</strong><div style="white-space:nowrap; overflow:hidden; text-overflow:ellipsis; color: #bdc3c7;">${escapeHtml(data.replyTo.texto)}</div></div>`;
        }

        let reactionsHtml = '<div class="reactions-container">';
        if (data.reactions) {
            for (const emoji in data.reactions) {
                const userList = data.reactions[emoji];
                const count = userList.length;
                const reactedClass = userList.includes(miNombre) ? 'reacted' : '';
                reactionsHtml += `<div class="reaction ${reactedClass}" data-emoji="${emoji}">${emoji} ${count}</div>`;
            }
        }
        reactionsHtml += '</div>';

        const emojiPickerHtml = `<div class="emoji-picker"><span data-emoji="üëç">üëç</span><span data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</span><span data-emoji="üòÇ">üòÇ</span><span data-emoji="üòÆ">üòÆ</span><span data-emoji="üò¢">üò¢</span><span data-emoji="ü§î">ü§î</span></div>`;

        return `<div class="message-body">${replyHtml}<div class="message-content"><span class="message-text"><strong>${escapeHtml(data.nombre)}:</strong> ${escapeHtml(data.texto)}</span><span class="hora">${hora}${data.edited ? ' (editado)' : ''}</span></div>${reactionsHtml}${emojiPickerHtml}</div>`;
    }

    function assignMessageClasses(li, data, miNombre) {
        const playerRankIndex = rankedPlayers.findIndex(p => p.name === data.nombre);
        const rankClasses = { 0: 'rank-gold', 1: 'rank-silver', 2: 'rank-bronze' };
        li.className = ''; // Limpiar clases antiguas
        if (data.nombre.toLowerCase() === 'ceo') li.classList.add('rank-diamond');
        else if (playerRankIndex !== -1 && rankClasses[playerRankIndex]) li.classList.add(rankClasses[playerRankIndex]);
        else li.classList.add(data.nombre === miNombre ? 'mio' : 'otro');
    }

    // Borrar mensajes viejos para mantener la base de datos limpia
    const borrarMensajeViejo = async () => {
      const snapshot = await get(chatRef);
      const total = snapshot.size;
      if (total > 50) { // Mantener los √∫ltimos 50 mensajes
        const primeroSnap = await get(query(chatRef, limitToFirst(total - 50)));
        primeroSnap.forEach((child) => remove(ref(db, "chat/" + child.key)));
      }
    };

    // Enviar mensaje
    const enviarMensaje = async () => {
      const texto = chatInput.value.trim();
      if (!texto) return;
      
      const miNombre = playerNameInput.value || localPlayerId;
      
      const messageData = {
        nombre: miNombre,
        texto: texto,
        hora: Date.now(),
        reactions: {}
      };

      if (replyingTo) {
        messageData.replyTo = replyingTo;
      }

      await push(chatRef, messageData);
      chatInput.value = "";
      replyingTo = null;
      renderReplyingTo();
      borrarMensajeViejo();
    };

    const toggleReaction = async (messageId, emoji) => {
      const miNombre = playerNameInput.value || localPlayerId;
      const reactionRef = ref(db, `chat/${messageId}/reactions/${emoji}`);
      const snapshot = await get(reactionRef);
      let users = snapshot.val() || [];

      const updates = {};
      if (users.includes(miNombre)) {
        users = users.filter(user => user !== miNombre);
      } else {
        users.push(miNombre);
      }

      updates[`/chat/${messageId}/reactions/${emoji}`] = users.length > 0 ? users : null;
      await update(ref(db), updates);
    };

    const editMessage = (messageId, liElement) => {
      const messageTextSpan = liElement.querySelector('.message-text');
      if (!messageTextSpan) return;

      const currentText = messageTextSpan.innerText.split(': ')[1];
      const input = document.createElement('input');
      input.type = 'text';
      input.value = currentText;
      input.style.width = '100%';

      messageTextSpan.style.display = 'none';
      messageTextSpan.parentElement.insertBefore(input, messageTextSpan);
      input.focus();

      const saveEdit = async () => {
        const newText = input.value.trim();
        if (newText && newText !== currentText) {
          await update(ref(db, `chat/${messageId}`), {
            texto: newText,
            edited: true
          });
        }
        // La UI se actualizar√° sola por el listener `onChildAdded` (que tambi√©n se dispara en `update`)
        // pero para evitar duplicados, borramos el elemento viejo y dejamos que Firebase lo re-renderice.
        liElement.remove();
      };

      input.addEventListener('blur', saveEdit);
      input.addEventListener('keydown', (e) => { if (e.key === 'Enter') saveEdit(); });
    };

    function renderReplyingTo() {
        if (replyingTo) {
            replyingToContainer.innerHTML = `
                <p>Respondiendo a <strong>${escapeHtml(replyingTo.nombre)}</strong></p>
                <span>${escapeHtml(replyingTo.texto)}</span>
                <div id="cancelReply" title="Cancelar respuesta">&times;</div>
            `;
            replyingToContainer.classList.remove('hidden');
            document.getElementById('cancelReply').onclick = () => { replyingTo = null; renderReplyingTo(); };
        } else {
            replyingToContainer.innerHTML = '';
            replyingToContainer.classList.add('hidden');
        }
    }

    chatEnviarBtn.addEventListener('click', enviarMensaje);
    chatInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            enviarMensaje();
        }
    });
  })();

</script>

    </div>

    <!-- Foso de fondo -->
    <div class="vaperWrap" id="vaperWrap" title="Haz click en cualquier parte del foso para generar Œ£C" data-lang-title="foso_tooltip">
        <div id="smokeLayer"></div>
            <svg id="centralFoso" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 260" role="img" aria-label="Foso central" style="filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4));">
              <rect x="20" y="20" width="60" height="220" rx="12" ry="12" fill="url(#gActive)" stroke="#0b0c2a" stroke-width="3"/>
              <rect x="20" y="0" width="60" height="20" rx="10" ry="10" fill="url(#mouthActive)"/>
<!-- Pantalla central -->
<rect x="34" y="99" width="32" height="52" rx="5" ry="5" fill="#111" stroke="#333" stroke-width="1"/>
<!-- PANTALLA CENTRAL (dentro del svg centralFoso) -->
<rect x="35" y="100" width="30" height="50" rx="4" ry="4" fill="#000" id="centralScreen"/>
<text id="batteryText" x="50" y="125" font-size="10" fill="#0f0" text-anchor="middle">0%</text>


  <!-- niveles: vamos a usar m√°scaras para "llenar" o simplemente cambiar color/opacity -->
  <!-- para simplicidad controlamos solo el color/opacity del path seg√∫n drops -->


<!-- Texto de porcentaje -->




              <defs>
                <linearGradient id="gActive" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#f1c40f"/>
                  <stop offset="50%" stop-color="#2ecc71"/>
                  <stop offset="100%" stop-color="#1e3799"/>
                </linearGradient>
                <linearGradient id="mouthActive" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#2c2c54"/>
                  <stop offset="100%" stop-color="#000"/>
                </linearGradient>
                <linearGradient id="batteryGrad" x1="0" y1="0" x2="1" y2="0"> 
                  <stop offset="0%" stop-color="#00ff99"/>
                  <stop offset="100%" stop-color="#00a86b"/>
                </linearGradient>
              </defs>
            </svg>
        <div id="autoClickPointer"></div> 
    </div>

    <!-- Right Menu -->
    <button id="menuToggle" class="mata-btn right-menu-toggle">
        <svg class="icon" viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
        <span id="dotMenu" class="notify-dot hidden"></span>
    </button>
    <div id="rightMenu" class="right-menu">
        <button id="btnPower" class="mata-btn" style="background:#0ea5b7">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2v8"/><path d="M5.2 5.2a9 9 0 1 0 12.7 0"/></svg>
            <span data-lang="power">Power</span>
        </button>
        <button id="btnChargeToggle" class="mata-btn" style="background:#00cfff">
            <svg class="icon" viewBox="0 0 24 24"><path d="M13 2 L4 14h6l-1 8 10-12h-7z" fill="currentColor"/></svg>
            <span id="chargeLabel" data-lang="charge">Cargar</span>
        </button>
        <button id="btnMata" class="mata-btn" style="background:#ef4444">
            <svg class="icon" viewBox="0 0 24 24"><path d="M7 7l10 10M17 7L7 17"/><circle cx="12" cy="12" r="9"/></svg>
            <span id="mataLabel" data-lang="mata_foso">Mata Foso</span>
        </button>
        <button id="btnMaintenance" class="mata-btn" style="background:#f39c12">
            <svg class="icon" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg>
            <span data-lang="maintenance">Mantenimiento</span>
        </button>
        <hr style="border-color: rgba(100, 116, 139, 0.3); width: 100%; margin: 5px 0;">
        <button id="btnShop" class="mata-btn" style="background:#facc15">
            <svg class="icon" viewBox="0 0 24 24"><path d="M3 4h2l2 10h11l2-7H6"/></svg>
            <span data-lang="shop">Tienda</span>
        </button>
        <button id="btnUpgrades" class="mata-btn" style="background:#8b5cf6">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 20V10"/><path d="M18 20V4"/><path d="M6 20v-4"/></svg>
            <span data-lang="upgrades">Mejoras</span>
        </button>
        <button id="btnRebirth" class="mata-btn" style="background:#a78bfa">
            <svg class="icon" viewBox="0 0 24 24"><path d="M3 10v4h4"/><path d="M21 14v-4h-4"/><path d="M21 10a8 8 0 0 0-13.66-5.66L7 6"/><path d="M3 14a8 8 0 0 0 13.66 5.66L17 18"/></svg>
            <span data-lang="rebirth">Rebirth</span>
        </button>
        <button id="btnPrestige" class="mata-btn hidden" style="background:linear-gradient(45deg, #f59e0b, #f39c12, #e58e26); color:black;">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
            <span data-lang="prestige">Prestigio</span>
        </button>
        <hr style="border-color: rgba(100, 116, 139, 0.3); width: 100%; margin: 5px 0;">
        <button id="btnDaily" class="mata-btn">
            <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="5" width="18" height="16" rx="2"/><path d="M16 3v4M8 3v4M3 11h18"/></svg>
            <span data-lang="daily_gift">Regalo Diario</span><span id="dotDaily" class="notify-dot hidden"></span>
        </button>
        <button id="btnWheel" class="mata-btn" style="background:#ff6b6b">
            <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg>
            <span id="wheelBtnLabel" data-lang="wheel">Ruleta</span>
            <span id="dotWheel" class="notify-dot hidden"></span>
        </button>
        <button id="btnMissions" class="mata-btn" style="background:#3498db">
            <svg class="icon" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="9 17 4 12 9 7"></polyline><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="15 7 20 12 15 17"></polyline></svg>
            <span id="missionsBtnLabel" data-lang="missions">Misiones</span><span id="dotMissions" class="notify-dot hidden"></span>
        </button>
        <button id="btnChests" class="mata-btn" style="background:#f39c12">
            <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
            <span data-lang="chests">Cofres</span><span id="dotChests" class="notify-dot hidden"></span>
        </button>
        <hr style="border-color: rgba(100, 116, 139, 0.3); width: 100%; margin: 5px 0;">
        <button id="btnAFK" class="mata-btn" style="background:#8e44ad">
            <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 3"/></svg>
            <span data-lang="afk_upgrades">Mejoras AFK</span>
            <span id="dotAFK" class="notify-dot hidden"></span>
        </button>
        <button id="btnPets" class="mata-btn" style="background:#6366f1">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0L12 2.69z"></path><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
            <span data-lang="pets">Mascotas</span><span id="dotPets" class="notify-dot hidden"></span>
        </button>
        <button id="btnCrafting" class="mata-btn" style="background:#20c997">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
            <span data-lang="crafting">Laboratorio</span>
            <span id="dotCrafting" class="notify-dot hidden"></span>
        </button>
        <button id="btnPromo" class="mata-btn" style="background:#2ecc71">
            <svg class="icon" viewBox="0 0 24 24"><path d="M21.4 11.6l-9-9a2 2 0 0 0-2.8 0l-9 9a2 2 0 0 0 0 2.8l9 9a2 2 0 0 0 2.8 0l9-9a2 2 0 0 0 0-2.8z"></path><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
            <span data-lang="promo_code_button">C√≥digo Promocional</span>
            <span id="dotPromo" class="notify-dot hidden"></span>
        </button>
        <hr style="border-color: rgba(100, 116, 139, 0.3); width: 100%; margin: 5px 0;">
        <button id="btnAchievements" class="mata-btn" style="background:#f59e0b">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>
            <span data-lang="achievements">Logros</span>
            <span id="dotAchievements" class="notify-dot hidden"></span>
        </button>
        <button id="btnConfig" class="mata-btn" style="background:#c084fc">
            <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V22a2 2 0 1 1-4 0v-.11a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H2a2 2 0 1 1 0-4h.11a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 6.06 3.3l.06.06a1.65 1.65 0 0 0 1.82.33H8a1.65 1.65 0 0 0 1-1.51V2a2 2 0 1 1 4 0v.11a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06A2 2 0 1 1 20.7 6.06l-.06.06a1.65 1.65 0 0 0-.33 1.82V8c0 .64.39 1.22 1 1.51.35.17.73.49.73.49"/></svg>
            <span data-lang="settings">Configuraci√≥n</span>
        </button>
    </div>

<!-- Modal Logros -->
<div id="achievementsModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title" data-lang="achievements_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg> Logros</div>
      <button class="close-btn" data-close>&times;</button>
    </div>
    <div class="modal-body" id="achievementsGrid">
      <!-- Los logros se generar√°n aqu√≠ -->
    </div>
  </div>
</div>

<!-- Modal Mejoras -->
<div id="upgradesModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title" data-lang="upgrades_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M12 20V10"/><path d="M18 20V4"/><path d="M6 20v-4"/></svg> Mejoras Permanentes</div>
      <button class="close-btn" data-close>&times;</button>
    </div>
    <div class="modal-body">
        <p class="hint" data-lang="upgrades_desc">Compra mejoras con Œ£C para potenciar tus ganancias y eficiencia de forma permanente.</p>
        <div id="upgradesGrid" class="powers-grid">
            <!-- Las mejoras se generar√°n aqu√≠ -->
        </div>
    </div>
  </div>
</div>
<!-- Modal Rebirth -->
<div id="rebirthModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title" data-lang="rebirth_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M3 10v4h4"/><path d="M21 14v-4h-4"/><path d="M21 10a8 8 0 0 0-13.66-5.66L7 6"/><path d="M3 14a8 8 0 0 0 13.66 5.66L17 18"/></svg> Rebirth</div>
      <button class="close-btn" data-close>&times;</button>
    </div>
    <div class="modal-body">
      <p data-lang="rebirth_desc">Hacer un Rebirth reiniciar√° tu progreso (Œ£C, fosos, mejoras) a cambio de una bonificaci√≥n permanente en tus ganancias por clic.</p>
      <div id="rebirthInfo" style="background: var(--panel); padding: 12px; border-radius: 8px; margin: 12px 0;">
        <!-- Contenido din√°mico aqu√≠ -->
      </div>
      <button id="btnConfirmRebirth" class="mata-btn" style="width: 100%; background: #a78bfa; justify-content: center;" data-lang="confirm_rebirth">
        Confirmar Rebirth
      </button>
    </div>
  </div>
</div>

<!-- Modal Crafteo -->
<div id="craftingModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="crafting_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Laboratorio de Sabores</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body">
            <p class="hint" data-lang="crafting_desc">Arrastra l√≠quidos de tu inventario a las ranuras para combinarlos y crear sabores temporales con bonus.</p>
            
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-top: 15px;">
                <div>
                    <h4 data-lang="liquid_inventory">Inventario de L√≠quidos</h4>
                    <div id="liquidInventoryGrid" class="shopGrid" style="grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); max-height: 250px;">
                        <!-- L√≠quidos del jugador aqu√≠ -->
                    </div>
                </div>
                <div>
                    <h4 data-lang="crafting_area">√Årea de Crafteo</h4>
                    <div id="craftingSlots" style="display: flex; gap: 10px; justify-content: center; background: var(--bg); padding: 15px; border-radius: 8px; min-height: 100px; align-items: center;">
                        <div class="crafting-slot" data-slot="0"></div>
                        <span style="font-size: 24px;">+</span>
                        <div class="crafting-slot" data-slot="1"></div>
                    </div>
                    <button id="btnCombine" class="mata-btn" style="width: 100%; justify-content: center; margin-top: 10px;" data-lang="combine">Combinar</button>
                    <div id="activeFlavorInfo" style="margin-top: 15px; background: var(--bg); padding: 10px; border-radius: 8px;">
                        <h5 data-lang="active_flavor">Sabor Activo</h5>
                        <div id="activeFlavorDetails">
                            <p class="metaTiny" data-lang="no_active_flavor">Ninguno</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Prestigio -->
<div id="prestigeModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title" data-lang="prestige_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Prestigio</div>
      <button class="close-btn" data-close>&times;</button>
    </div>
    <div class="modal-body">
      <p data-lang="prestige_desc">¬°Felicidades! Has llegado al final del camino... por ahora. Hacer Prestigio reiniciar√° tu progreso (como un Rebirth) pero te otorgar√° Puntos de Prestigio (PP) para desbloquear mejoras permanentes incre√≠blemente poderosas.</p>
      <div id="prestigeInfo" style="background: var(--panel); padding: 12px; border-radius: 8px; margin: 12px 0;">
        <!-- Contenido din√°mico aqu√≠ -->
      </div>
      <div id="prestigeUpgradesGrid" class="shopGrid" style="grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); max-height: 300px; margin-bottom: 15px;"></div>
      <button id="btnConfirmPrestige" class="mata-btn" style="width: 100%; background: #f59e0b; justify-content: center;" data-lang="confirm_prestige">
        Confirmar Prestigio
      </button>
    </div>
  </div>
</div>

<style>
    .liquid-item { text-align: center; cursor: grab; user-select: none; }
    .liquid-item:active { cursor: grabbing; }
    .liquid-icon { font-size: 32px; }
    .liquid-name { font-size: 12px; }
    .liquid-count { font-size: 11px; background: rgba(0,0,0,0.5); padding: 2px 4px; border-radius: 4px; }

    .crafting-slot {
        width: 60px; height: 60px; background: rgba(0,0,0,0.2); border: 2px dashed var(--muted);
        border-radius: 8px; display: flex; align-items: center; justify-content: center;
        font-size: 24px; transition: background 0.2s;
    }
    .crafting-slot.over {
        background: rgba(34, 211, 238, 0.2);
        border-color: var(--accent);
    }
</style>
<div id="shopModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title" style="display:flex;align-items:center;gap:8px">
        <svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M3 4h2l2 10h11l2-7H6"/></svg>
        <span data-lang="shop_title">Tienda ‚Äî Fositos</span>
      </div>
      <button class="close-btn" data-close>&times;</button>
      <div id="marketStatus" class="metaTiny" style="text-align: right; padding-right: 10px;"></div>
    </div>
    <div class="modal-body">

    <!-- Aqu√≠ metemos la tienda -->
    <aside class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="display:flex;align-items:center;gap:8px">
          <p class="hint" data-lang="shop_hint">Clic para equipar/comprar. El foso central cambia seg√∫n lo equipado.</p>
        </div>
        <div>
          <div class="metaTiny" style="text-align: right;">Œ£C: <span id="shopSigma">0</span></div>
          <div class="metaTiny" style="text-align: right;">üíé: <span id="shopGems">0</span></div>
        </div>
      </div>

      <div class="shopGrid" id="shopGrid">

      

 
        <div class="shopCard" data-index="0" title="Foso 1: Mango Ice ü•≠‚ùÑÔ∏è (0 Œ£C)">
  <div class="metaTiny" style="font-weight:800">Foso 1: Mango Ice ü•≠‚ùÑÔ∏è</div>
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g1_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth1_shop)"/>
    <defs>
      <linearGradient id="g1_shop" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#f1c40f"/><stop offset="50%" stop-color="#2ecc71"/><stop offset="100%" stop-color="#1e3799"/>
      </linearGradient>
      <linearGradient id="mouth1_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_0_name">Foso 1: Mango Ice ü•≠‚ùÑÔ∏è</div>
  <div class="priceTag" data-cost="0">0 Œ£C</div>
</div>

<!-- 2 -->
<div class="shopCard" data-index="1" title="Foso 2: Strawberry Kiwi üçìü•ù (200 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g2_shop)" stroke="#4a0e0e" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth2_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g2_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ff7675"/><stop offset="100%" stop-color="#fd7e14"/></linearGradient>
      <linearGradient id="mouth2_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_1_name">Foso 2: Strawberry Kiwi üçìü•ù</div>
  <div class="priceTag" data-cost="200">200 Œ£C</div>
</div>

<!-- 3 -->
<div class="shopCard" data-index="2" title="Foso 3: Blue Razz ü´êüíô (600 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g3_shop)" stroke="#003a75" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth3_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g3_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00c6ff"/><stop offset="100%" stop-color="#0072ff"/></linearGradient>
      <linearGradient id="mouth3_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_2_name">Foso 3: Blue Razz ü´êüíô</div>
  <div class="priceTag" data-cost="600">600 Œ£C</div>
</div>

<!-- 4 -->
<div class="shopCard" data-index="3" title="Foso 4: Watermelon Ice üçâ‚ùÑÔ∏è (2 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g4_shop)" stroke="#475569" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth4_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g4_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ecf0f1"/><stop offset="100%" stop-color="#95a5a6"/></linearGradient>
      <linearGradient id="mouth4_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_3_name">Foso 4: Watermelon Ice üçâ‚ùÑÔ∏è</div>
  <div class="priceTag" data-cost="2000">2 000 Œ£C</div>
</div>

<!-- 5 -->
<div class="shopCard" data-index="4" title="Foso 5: Pineapple Coconut üççü•• (6 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g5_shop)" stroke="#b38600" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth5_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g5_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ffd700"/><stop offset="100%" stop-color="#ffb400"/></linearGradient>
      <linearGradient id="mouth5_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_4_name">Foso 5: Pineapple Coconut üççü••</div>
  <div class="priceTag" data-cost="6000">6 000 Œ£C</div>
</div>

<!-- 6 -->
<div class="shopCard" data-index="5" title="Foso 6: Grape Ice üçá‚ùÑÔ∏è (20 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g6_shop)" stroke="#1e002b" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth6_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g6_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#9b59b6"/><stop offset="100%" stop-color="#2c003e"/></linearGradient>
      <linearGradient id="mouth6_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_5_name">Foso 6: Grape Ice üçá‚ùÑÔ∏è</div>
  <div class="priceTag" data-cost="20000">20 000 Œ£C</div>
</div>

<!-- 7 -->
<div class="shopCard" data-index="6" title="Foso 7: Peach Mango üçëü•≠ (60 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g7_shop)" stroke="#000" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth7_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs><linearGradient id="g7_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ff0000"/><stop offset="100%" stop-color="#000"/></linearGradient>
    <linearGradient id="mouth7_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_6_name">Foso 7: Peach Mango üçëü•≠</div>
  <div class="priceTag" data-cost="60000">60 000 Œ£C</div>
</div>

<!-- 8 -->
<div class="shopCard" data-index="7" title="Foso 8: Cola Ice ü•§‚ùÑÔ∏è (200 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g8_shop)" stroke="#005580" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth8_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs><linearGradient id="g8_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ffffff"/><stop offset="100%" stop-color="#00aaff"/></linearGradient>
    <linearGradient id="mouth8_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_7_name">Foso 8: Cola Ice ü•§‚ùÑÔ∏è</div>
  <div class="priceTag" data-cost="200000">200 000 Œ£C</div>
</div>

<!-- 9 -->
<div class="shopCard" data-index="8" title="Foso 9: Lychee Rose üå∏üçí (600 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g9_shop)" stroke="#0a2e18" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth9_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs><linearGradient id="g9_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2ecc71"/><stop offset="100%" stop-color="#145a32"/></linearGradient>
    <linearGradient id="mouth9_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_8_name">Foso 9: Lychee Rose üå∏üçí</div>
  <div class="priceTag" data-cost="600000">600 000 Œ£C</div>
</div>

<!-- 10 -->
<div class="shopCard" data-index="9" title="Foso 10: Apple Mint üçèüåø (2 000 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g10_shop)" stroke="#48061f" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth10_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs><linearGradient id="g10_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ff5733"/><stop offset="100%" stop-color="#900c3f"/></linearGradient>
    <linearGradient id="mouth10_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_9_name">Foso 10: Apple Mint üçèüåø</div>
  <div class="priceTag" data-cost="2000000">2 000 000 Œ£C</div>
</div>

<!-- 11 -->
<div class="shopCard" data-index="10" title="Foso 11: Banana Ice Cream üçåüç¶ (6 000 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g11_shop)" stroke="#008080" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth11_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs><linearGradient id="g11_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#39ff14"/><stop offset="100%" stop-color="#0ff"/></linearGradient>
    <linearGradient id="mouth11_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_10_name">Foso 11: Banana Ice Cream üçåüç¶</div>
  <div class="priceTag" data-cost="6000000">6 000 000 Œ£C</div>
</div>

<!-- 12 -->
<div class="shopCard" data-index="11" title="Foso 12: Lemon Tart üçãü•ß (20 000 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g12_shop)" stroke="#400080" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth12_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs><linearGradient id="g12_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00f5ff"/><stop offset="50%" stop-color="#7f00ff"/><stop offset="100%" stop-color="#00ff88"/></linearGradient>
    <linearGradient id="mouth12_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_11_name">Foso 12: Lemon Tart üçãü•ß</div>
  <div class="priceTag" data-cost="20000000">20 000 000 Œ£C</div>
</div>

<!-- 13 -->
<div class="shopCard" data-index="12" title="Foso 13: Cherry Cola üçíü•§ (60 000 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g13_shop)" stroke="#371600" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth13_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g13_shop" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#cd7f32"/><stop offset="100%" stop-color="#6e2c00"/>
      </linearGradient>
      <linearGradient id="mouth13_shop" x1="0" y1="0" x2="0" y2="1"> 
        <stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/>
      </linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_12_name">Foso 13: Cherry Cola üçíü•§</div>
  <div class="priceTag" data-cost="60000000">60 000 000 Œ£C</div>
</div>

<!-- 14 -->
<div class="shopCard" data-index="13" title="Foso 14: Cotton Candy üç≠ (200 000 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g14_shop)" stroke="#426173" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth14_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g14_shop" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#ffffff"/><stop offset="100%" stop-color="#85c1e9"/>
      </linearGradient>
      <linearGradient id="mouth14_shop" x1="0" y1="0" x2="0" y2="1"> 
        <stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/>
      </linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_13_name">Foso 14: Cotton Candy üç≠</div>
  <div class="priceTag" data-cost="200000000">200 000 000 Œ£C</div>
</div>

<!-- 15 (especial: cuerpo cambia rojo->azul->verde con animate) -->
<div class="shopCard" data-index="14" title="Foso 15: Black Diamond Reserve üíéüî• (600 000 000 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g15_shop)" stroke="#222" stroke-width="1.5"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth15_shop)"/>
    <rect x="35" y="110" width="30" height="20" rx="4" fill="#111"/>
    <defs>
      <linearGradient id="g15_shop" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="red">
          <animate attributeName="stop-color" values="red;blue;green;red" dur="3s" repeatCount="indefinite"/>
        </stop>
        <stop offset="100%" stop-color="red">
          <animate attributeName="stop-color" values="red;blue;green;red" dur="3s" repeatCount="indefinite"/>
        </stop>
      </linearGradient>
      <linearGradient id="mouth15_shop" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/>
      </linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_14_name">Foso 15: Black Diamond Reserve üíéüî•</div>
  <div class="priceTag" data-cost="600000000">600 000 000 Œ£C</div>
</div>

<!-- 16 -->
<div class="shopCard" data-index="15" title="Foso 16: Cosmic Swirl üåå (2B Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g16_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth16_shop)"/>
    <defs>
      <linearGradient id="g16_shop" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#434343"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth16_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#333"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_15_name">Foso 16: Cosmic Swirl üåå</div>
  <div class="priceTag" data-cost="2000000000">2B Œ£C</div>
</div>

<!-- 17 -->
<div class="shopCard" data-index="16" title="Foso 17: Golden Dragon üêâ (6B Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-16">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g17_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth17_shop)"/>
    <defs>
      <linearGradient id="g17_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#B8860B"/></linearGradient>
      <linearGradient id="mouth17_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#4a2c00"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_16_name">Foso 17: Golden Dragon üêâ</div>
  <div class="priceTag" data-cost="6000000000">6B Œ£C</div>
</div>

<!-- 18 -->
<div class="shopCard" data-index="17" title="Foso 18: Ocean Breeze üåä (20B Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-17">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g18_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth18_shop)"/>
    <defs>
      <linearGradient id="g18_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#87CEEB"/><stop offset="100%" stop-color="#00BFFF"/></linearGradient>
      <linearGradient id="mouth18_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#eee"/><stop offset="100%" stop-color="#ccc"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_17_name">Foso 18: Ocean Breeze üåä</div>
  <div class="priceTag" data-cost="20000000000">20B Œ£C</div>
</div>

<!-- 19 -->
<div class="shopCard" data-index="18" title="Foso 19: Ruby Red ‚ù§Ô∏è (60B Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-18">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g19_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth19_shop)"/>
    <defs>
      <linearGradient id="g19_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#DC143C"/><stop offset="100%" stop-color="#8B0000"/></linearGradient>
      <linearGradient id="mouth19_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_18_name">Foso 19: Ruby Red ‚ù§Ô∏è</div>
  <div class="priceTag" data-cost="60000000000">60B Œ£C</div>
</div>

<!-- 20 -->
<div class="shopCard" data-index="19" title="Foso 20: Emerald Green üíö (200B Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-19">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g20_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth20_shop)"/>
    <defs>
      <linearGradient id="g20_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#32CD32"/><stop offset="100%" stop-color="#006400"/></linearGradient>
      <linearGradient id="mouth20_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_19_name">Foso 20: Emerald Green üíö</div>
  <div class="priceTag" data-cost="200000000000">200B Œ£C</div>
</div>

<!-- 21 -->
<div class="shopCard" data-index="20" title="Foso 21: Sapphire Blue üíô (600B Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-20">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g21_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth21_shop)"/>
    <defs>
      <linearGradient id="g21_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#4169E1"/><stop offset="100%" stop-color="#00008B"/></linearGradient>
      <linearGradient id="mouth21_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_20_name">Foso 21: Sapphire Blue üíô</div>
  <div class="priceTag" data-cost="600000000000">600B Œ£C</div>
</div>

<!-- 22 -->
<div class="shopCard" data-index="21" title="Foso 22: Amethyst Purple üíú (2T Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-21">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g22_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth22_shop)"/>
    <defs>
      <linearGradient id="g22_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#9370DB"/><stop offset="100%" stop-color="#4B0082"/></linearGradient>
      <linearGradient id="mouth22_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_21_name">Foso 22: Amethyst Purple üíú</div>
  <div class="priceTag" data-cost="2000000000000">2T Œ£C</div>
</div>

<!-- 23 -->
<div class="shopCard" data-index="22" title="Foso 23: Topaz Yellow üíõ (6T Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-22">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g23_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth23_shop)"/>
    <defs>
      <linearGradient id="g23_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#FFA500"/></linearGradient>
      <linearGradient id="mouth23_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_22_name">Foso 23: Topaz Yellow üíõ</div>
  <div class="priceTag" data-cost="6000000000000">6T Œ£C</div>
</div>

<!-- 24 -->
<div class="shopCard" data-index="23" title="Foso 24: Onyx Black üñ§ (20T Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-23">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g24_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth24_shop)"/>
    <defs>
      <linearGradient id="g24_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2F4F4F"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth24_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_23_name">Foso 24: Onyx Black üñ§</div>
  <div class="priceTag" data-cost="20000000000000">20T Œ£C</div>
</div>

<!-- 25 -->
<div class="shopCard" data-index="24" title="Foso 25: Pearl White ü§ç (60T Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-24">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g25_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth25_shop)"/>
    <defs>
      <linearGradient id="g25_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F5F5DC"/><stop offset="100%" stop-color="#D3D3D3"/></linearGradient>
      <linearGradient id="mouth25_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_24_name">Foso 25: Pearl White ü§ç</div>
  <div class="priceTag" data-cost="60000000000000">60T Œ£C</div>
</div>

<!-- 26 -->
<div class="shopCard" data-index="25" title="Foso 26: Lava Flow üåã (200T Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-25">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g26_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth26_shop)"/>
    <defs>
      <linearGradient id="g26_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF4500"/><stop offset="100%" stop-color="#FF8C00"/></linearGradient>
      <linearGradient id="mouth26_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_25_name">Foso 26: Lava Flow üåã</div>
  <div class="priceTag" data-cost="200000000000000">200T Œ£C</div>
</div>

<!-- 27 -->
<div class="shopCard" data-index="26" title="Foso 27: Arctic Chill üßä (600T Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-26">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g27_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth27_shop)"/>
    <defs>
      <linearGradient id="g27_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ADD8E6"/><stop offset="100%" stop-color="#F0FFFF"/></linearGradient>
      <linearGradient id="mouth27_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_26_name">Foso 27: Arctic Chill üßä</div>
  <div class="priceTag" data-cost="600000000000000">600T Œ£C</div>
</div>

<!-- 28 -->
<div class="shopCard" data-index="27" title="Foso 28: Jungle Vine üåø (2Qa Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-27">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g28_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth28_shop)"/>
    <defs>
      <linearGradient id="g28_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#228B22"/><stop offset="100%" stop-color="#006400"/></linearGradient>
      <linearGradient id="mouth28_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_27_name">Foso 28: Jungle Vine üåø</div>
  <div class="priceTag" data-cost="2000000000000000">2Qa Œ£C</div>
</div>

<!-- 29 -->
<div class="shopCard" data-index="28" title="Foso 29: Desert Mirage üèúÔ∏è (6Qa Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-28">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g29_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth29_shop)"/>
    <defs>
      <linearGradient id="g29_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F4A460"/><stop offset="100%" stop-color="#D2691E"/></linearGradient>
      <linearGradient id="mouth29_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_28_name">Foso 29: Desert Mirage üèúÔ∏è</div>
  <div class="priceTag" data-cost="6000000000000000">6Qa Œ£C</div>
</div>

<!-- 30 -->
<div class="shopCard" data-index="29" title="Foso 30: Cyber Punk ü§ñ (20Qa Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-29">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g30_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth30_shop)"/>
    <defs>
      <linearGradient id="g30_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00FFFF"/><stop offset="100%" stop-color="#FF00FF"/></linearGradient>
      <linearGradient id="mouth30_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_29_name">Foso 30: Cyber Punk ü§ñ</div>
  <div class="priceTag" data-cost="20000000000000000">20Qa Œ£C</div>
</div>

<!-- 31 -->
<div class="shopCard" data-index="30" title="Foso 31: Steampunk ‚öôÔ∏è (60Qa Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-30">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g31_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth31_shop)"/>
    <defs>
      <linearGradient id="g31_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#CD853F"/><stop offset="100%" stop-color="#8B4513"/></linearGradient>
      <linearGradient id="mouth31_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_30_name">Foso 31: Steampunk ‚öôÔ∏è</div>
  <div class="priceTag" data-cost="60000000000000000">60Qa Œ£C</div>
</div>

<!-- 32 -->
<div class="shopCard" data-index="31" title="Foso 32: Galaxy Quest üå† (200Qa Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-31">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g32_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth32_shop)"/>
    <defs>
      <linearGradient id="g32_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#483D8B"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth32_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_31_name">Foso 32: Galaxy Quest üå†</div>
  <div class="priceTag" data-cost="200000000000000000">200Qa Œ£C</div>
</div>

<!-- 33 -->
<div class="shopCard" data-index="32" title="Foso 33: Void üï≥Ô∏è (600Qa Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-32">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g33_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth33_shop)"/>
    <defs>
      <linearGradient id="g33_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#1C1C1C"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth33_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_32_name">Foso 33: Void üï≥Ô∏è</div>
  <div class="priceTag" data-cost="600000000000000000">600Qa Œ£C</div>
</div>

<!-- 34 -->
<div class="shopCard" data-index="33" title="Foso 34: Aether ‚ú® (2Qi Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-33">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g34_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth34_shop)"/>
    <defs>
      <linearGradient id="g34_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#E6E6FA"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient>
      <linearGradient id="mouth34_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_33_name">Foso 34: Aether ‚ú®</div>
  <div class="priceTag" data-cost="2000000000000000000">2Qi Œ£C</div>
</div>

<!-- 35 -->
<div class="shopCard" data-index="34" title="Foso 35: Inferno üî• (6Qi Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-34">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g35_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth35_shop)"/>
    <defs>
      <linearGradient id="g35_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF4500"/><stop offset="100%" stop-color="#DC143C"/></linearGradient>
      <linearGradient id="mouth35_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_34_name">Foso 35: Inferno üî•</div>
  <div class="priceTag" data-cost="6000000000000000000">6Qi Œ£C</div>
</div>

<!-- 36 -->
<div class="shopCard" data-index="35" title="Foso 36: Tsunami üåä (20Qi Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-35">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g36_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth36_shop)"/>
    <defs>
      <linearGradient id="g36_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00BFFF"/><stop offset="100%" stop-color="#191970"/></linearGradient>
      <linearGradient id="mouth36_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_35_name">Foso 36: Tsunami üåä</div>
  <div class="priceTag" data-cost="20000000000000000000">20Qi Œ£C</div>
</div>

<!-- 37 -->
<div class="shopCard" data-index="36" title="Foso 37: Earthquake üåç (60Qi Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-36">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g37_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth37_shop)"/>
    <defs>
      <linearGradient id="g37_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#A0522D"/><stop offset="100%" stop-color="#8B4513"/></linearGradient>
      <linearGradient id="mouth37_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_36_name">Foso 37: Earthquake üåç</div>
  <div class="priceTag" data-cost="60000000000000000000">60Qi Œ£C</div>
</div>

<!-- 38 -->
<div class="shopCard" data-index="37" title="Foso 38: Hurricane üå™Ô∏è (200Qi Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-37">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g38_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth38_shop)"/>
    <defs>
      <linearGradient id="g38_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#778899"/><stop offset="100%" stop-color="#2F4F4F"/></linearGradient>
      <linearGradient id="mouth38_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_37_name">Foso 38: Hurricane üå™Ô∏è</div>
  <div class="priceTag" data-cost="200000000000000000000">200Qi Œ£C</div>
</div>

<!-- 39 -->
<div class="shopCard" data-index="38" title="Foso 39: Supernova üåü (600Qi Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-38">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g39_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth39_shop)"/>
    <defs>
      <linearGradient id="g39_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFFF00"/><stop offset="100%" stop-color="#FFD700"/></linearGradient>
      <linearGradient id="mouth39_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_38_name">Foso 39: Supernova üåü</div>
  <div class="priceTag" data-cost="600000000000000000000">600Qi Œ£C</div>
</div>

<!-- 40 -->
<div class="shopCard" data-index="39" title="Foso 40: Black Hole ‚ö´ (2Sx Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-39">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g40_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth40_shop)"/>
    <defs>
      <linearGradient id="g40_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#1C1C1C"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth40_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_39_name">Foso 40: Black Hole ‚ö´</div>
  <div class="priceTag" data-cost="2000000000000000000000">2Sx Œ£C</div>
</div>

<!-- 41 -->
<div class="shopCard" data-index="40" title="Foso 41: Nebula ‚òÅÔ∏è (6Sx Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-40">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g41_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth41_shop)"/>
    <defs>
      <linearGradient id="g41_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#4B0082"/><stop offset="100%" stop-color="#8A2BE2"/></linearGradient>
      <linearGradient id="mouth41_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_40_name">Foso 41: Nebula ‚òÅÔ∏è</div>
  <div class="priceTag" data-cost="6000000000000000000000">6Sx Œ£C</div>
</div>

<!-- 42 -->
<div class="shopCard" data-index="41" title="Foso 42: Quasar üí´ (20Sx Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-41">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g42_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth42_shop)"/>
    <defs>
      <linearGradient id="g42_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00FFFF"/><stop offset="100%" stop-color="#00BFFF"/></linearGradient>
      <linearGradient id="mouth42_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_41_name">Foso 42: Quasar üí´</div>
  <div class="priceTag" data-cost="20000000000000000000000">20Sx Œ£C</div>
</div>

<!-- 43 -->
<div class="shopCard" data-index="42" title="Foso 43: Pulsar üéá (60Sx Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-42">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g43_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth43_shop)"/>
    <defs>
      <linearGradient id="g43_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFB6C1"/><stop offset="100%" stop-color="#FF69B4"/></linearGradient>
      <linearGradient id="mouth43_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_42_name">Foso 43: Pulsar üéá</div>
  <div class="priceTag" data-cost="60000000000000000000000">60Sx Œ£C</div>
</div>

<!-- 44 -->
<div class="shopCard" data-index="43" title="Foso 44: Magnetar üß≤ (200Sx Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-43">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g44_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth44_shop)"/>
    <defs>
      <linearGradient id="g44_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF00FF"/><stop offset="100%" stop-color="#800080"/></linearGradient>
      <linearGradient id="mouth44_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_43_name">Foso 44: Magnetar üß≤</div>
  <div class="priceTag" data-cost="200000000000000000000000">200Sx Œ£C</div>
</div>

<!-- 45 -->
<div class="shopCard" data-index="44" title="Foso 45: The Singularity ‚ú® (600Sx Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-44">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g45_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth45_shop)"/>
    <defs>
      <linearGradient id="g45_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth45_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_44_name">Foso 45: The Singularity ‚ú®</div>
  <div class="priceTag" data-cost="600000000000000000000000">600Sx Œ£C</div>
</div>

<!-- Foso Pollo (Exclusivo Ruleta) -->
<div class="shopCard" data-index="45" title="Foso Pollo üçó (Exclusivo de la Ruleta)" style="display: none;">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-45">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g46_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth46_shop)"/>
    <defs>
      <linearGradient id="g46_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ADFF2F"/><stop offset="100%" stop-color="#006400"/></linearGradient>
      <linearGradient id="mouth46_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_45_name">Foso Pollo üçó</div>
  <div class="priceTag" data-cost="Infinity">Ruleta</div>
</div>

<!-- Foso Yousef (Exclusivo Ruleta) -->
<div class="shopCard" data-index="46" title="Foso Yousef üëë (Exclusivo de la Ruleta)" style="display: none;">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-46">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g47_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth47_shop)"/>
    <defs>
      <linearGradient id="g47_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ffd700"/><stop offset="100%" stop-color="#f0a500"/></linearGradient>
      <linearGradient id="mouth47_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#4a2c00"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_46_name">Foso Yousef üëë</div>
  <div class="priceTag" data-cost="Infinity">Ruleta</div>
</div>
<!-- 47 -->
<div class="shopCard" data-index="47" title="Foso 48: Chronos Key ‚è≥ (2Sp Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-47">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g48_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth48_shop)"/>
    <defs>
      <linearGradient id="g48_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#DAA520"/><stop offset="100%" stop-color="#B8860B"/></linearGradient>
      <linearGradient id="mouth48_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_47_name">Foso 48: Chronos Key ‚è≥</div>
  <div class="priceTag" data-cost="2e24">2Sp Œ£C</div>
</div>
<!-- 48 -->
<div class="shopCard" data-index="48" title="Foso 49: Quantum Foam üî¨ (6Sp Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-48">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g49_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth49_shop)"/>
    <defs>
      <linearGradient id="g49_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#48D1CC"/><stop offset="100%" stop-color="#20B2AA"/></linearGradient>
      <linearGradient id="mouth49_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_48_name">Foso 49: Quantum Foam üî¨</div>
  <div class="priceTag" data-cost="6e24">6Sp Œ£C</div>
</div>
<!-- 49 -->
<div class="shopCard" data-index="49" title="Foso 50: Solar Flare ‚òÄÔ∏è (20Sp Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-49">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g50_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth50_shop)"/>
    <defs>
      <linearGradient id="g50_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF4500"/><stop offset="100%" stop-color="#FFD700"/></linearGradient>
      <linearGradient id="mouth50_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_49_name">Foso 50: Solar Flare ‚òÄÔ∏è</div>
  <div class="priceTag" data-cost="2e25">20Sp Œ£C</div>
</div>
<!-- 50 -->
<div class="shopCard" data-index="50" title="Foso 51: Dark Matter ‚¨õ (60Sp Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-50">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g51_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth51_shop)"/>
    <defs>
      <linearGradient id="g51_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2F4F4F"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth51_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_50_name">Foso 51: Dark Matter ‚¨õ</div>
  <div class="priceTag" data-cost="6e25">60Sp Œ£C</div>
</div>
<!-- 51 -->
<div class="shopCard" data-index="51" title="Foso 52: Plasma Core ‚ö° (200Sp Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-51">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g52_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth52_shop)"/>
    <defs>
      <linearGradient id="g52_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF00FF"/><stop offset="100%" stop-color="#00FFFF"/></linearGradient>
      <linearGradient id="mouth52_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_51_name">Foso 52: Plasma Core ‚ö°</div>
  <div class="priceTag" data-cost="2e26">200Sp Œ£C</div>
</div>
<!-- 52 -->
<div class="shopCard" data-index="52" title="Foso 53: Neutron Star üåü (600Sp Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-52">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g53_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth53_shop)"/>
    <defs>
      <linearGradient id="g53_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#E6E6FA"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient>
      <linearGradient id="mouth53_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_52_name">Foso 53: Neutron Star üåü</div>
  <div class="priceTag" data-cost="6e26">600Sp Œ£C</div>
</div>
<!-- 53 -->
<div class="shopCard" data-index="53" title="Foso 54: White Hole ‚ö™ (2Oc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-53">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g54_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth54_shop)"/>
    <defs>
      <linearGradient id="g54_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#F0F8FF"/></linearGradient>
      <linearGradient id="mouth54_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_53_name">Foso 54: White Hole ‚ö™</div>
  <div class="priceTag" data-cost="2e27">2Oc Œ£C</div>
</div>
<!-- 54 -->
<div class="shopCard" data-index="54" title="Foso 55: Wormhole üåÄ (6Oc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-54">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g55_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth55_shop)"/>
    <defs>
      <linearGradient id="g55_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#8A2BE2"/><stop offset="100%" stop-color="#4B0082"/></linearGradient>
      <linearGradient id="mouth55_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_54_name">Foso 55: Wormhole üåÄ</div>
  <div class="priceTag" data-cost="6e27">6Oc Œ£C</div>
</div>
<!-- 55 -->
<div class="shopCard" data-index="55" title="Foso 56: Multiverse üåå (20Oc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-55">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g56_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth56_shop)"/>
    <defs>
      <linearGradient id="g56_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00008B"/><stop offset="100%" stop-color="#191970"/></linearGradient>
      <linearGradient id="mouth56_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_55_name">Foso 56: Multiverse üåå</div>
  <div class="priceTag" data-cost="2e28">20Oc Œ£C</div>
</div>
<!-- 56 -->
<div class="shopCard" data-index="56" title="Foso 57: Hyperdrive üöÄ (60Oc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-56">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g57_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth57_shop)"/>
    <defs>
      <linearGradient id="g57_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#C0C0C0"/><stop offset="100%" stop-color="#808080"/></linearGradient>
      <linearGradient id="mouth57_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_56_name">Foso 57: Hyperdrive üöÄ</div>
  <div class="priceTag" data-cost="6e28">60Oc Œ£C</div>
</div>
<!-- 57 -->
<div class="shopCard" data-index="57" title="Foso 58: Dyson Sphere ‚òÄÔ∏è (200Oc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-57">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g58_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth58_shop)"/>
    <defs>
      <linearGradient id="g58_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#FFA500"/></linearGradient>
      <linearGradient id="mouth58_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_57_name">Foso 58: Dyson Sphere ‚òÄÔ∏è</div>
  <div class="priceTag" data-cost="2e29">200Oc Œ£C</div>
</div>
<!-- 58 -->
<div class="shopCard" data-index="58" title="Foso 59: Galactic Core üåå (600Oc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-58">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g59_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth59_shop)"/>
    <defs>
      <linearGradient id="g59_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#4B0082"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth59_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_58_name">Foso 59: Galactic Core üåå</div>
  <div class="priceTag" data-cost="6e29">600Oc Œ£C</div>
</div>
<!-- 59 -->
<div class="shopCard" data-index="59" title="Foso 60: The Big Bang üí• (2No Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-59">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g60_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth60_shop)"/>
    <defs>
      <linearGradient id="g60_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF4500"/><stop offset="100%" stop-color="#FFFF00"/></linearGradient>
      <linearGradient id="mouth60_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_59_name">Foso 60: The Big Bang üí•</div>
  <div class="priceTag" data-cost="2e30">2No Œ£C</div>
</div>
<!-- 60 -->
<div class="shopCard" data-index="60" title="Foso 61: Genesis Block üß± (6No Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-60">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g61_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth61_shop)"/>
    <defs>
      <linearGradient id="g61_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#A9A9A9"/><stop offset="100%" stop-color="#696969"/></linearGradient>
      <linearGradient id="mouth61_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_60_name">Foso 61: Genesis Block üß±</div>
  <div class="priceTag" data-cost="6e30">6No Œ£C</div>
</div>
<!-- 61 -->
<div class="shopCard" data-index="61" title="Foso 62: Alpha Centauri ‚≠ê (20No Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-61">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g62_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth62_shop)"/>
    <defs>
      <linearGradient id="g62_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#FFA500"/></linearGradient>
      <linearGradient id="mouth62_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_61_name">Foso 62: Alpha Centauri ‚≠ê</div>
  <div class="priceTag" data-cost="2e31">20No Œ£C</div>
</div>
<!-- 62 -->
<div class="shopCard" data-index="62" title="Foso 63: Andromeda üåå (60No Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-62">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g63_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth63_shop)"/>
    <defs>
      <linearGradient id="g63_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#483D8B"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth63_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_62_name">Foso 63: Andromeda üåå</div>
  <div class="priceTag" data-cost="6e31">60No Œ£C</div>
</div>
<!-- 63 -->
<div class="shopCard" data-index="63" title="Foso 64: Orion Nebula üî≠ (200No Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-63">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g64_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth64_shop)"/>
    <defs>
      <linearGradient id="g64_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#DA70D6"/><stop offset="100%" stop-color="#8A2BE2"/></linearGradient>
      <linearGradient id="mouth64_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_63_name">Foso 64: Orion Nebula üî≠</div>
  <div class="priceTag" data-cost="2e32">200No Œ£C</div>
</div>
<!-- 64 -->
<div class="shopCard" data-index="64" title="Foso 65: Pillars of Creation üèõÔ∏è (600No Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-64">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g65_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth65_shop)"/>
    <defs>
      <linearGradient id="g65_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#D2B48C"/><stop offset="100%" stop-color="#8B4513"/></linearGradient>
      <linearGradient id="mouth65_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_64_name">Foso 65: Pillars of Creation üèõÔ∏è</div>
  <div class="priceTag" data-cost="6e32">600No Œ£C</div>
</div>
<!-- 65 -->
<div class="shopCard" data-index="65" title="Foso 66: Event Horizon üåÄ (2Dc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-65">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g66_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth66_shop)"/>
    <defs>
      <linearGradient id="g66_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#000000"/><stop offset="100%" stop-color="#4B0082"/></linearGradient>
      <linearGradient id="mouth66_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_65_name">Foso 66: Event Horizon üåÄ</div>
  <div class="priceTag" data-cost="2e33">2Dc Œ£C</div>
</div>
<!-- 66 -->
<div class="shopCard" data-index="66" title="Foso 67: God Particle ‚ú® (6Dc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-66">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g67_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth67_shop)"/>
    <defs>
      <linearGradient id="g67_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient>
      <linearGradient id="mouth67_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_66_name">Foso 67: God Particle ‚ú®</div>
  <div class="priceTag" data-cost="6e33">6Dc Œ£C</div>
</div>
<!-- 67 -->
<div class="shopCard" data-index="67" title="Foso 68: String Theory üéª (20Dc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-67">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g68_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth68_shop)"/>
    <defs>
      <linearGradient id="g68_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#C0C0C0"/><stop offset="100%" stop-color="#808080"/></linearGradient>
      <linearGradient id="mouth68_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_67_name">Foso 68: String Theory üéª</div>
  <div class="priceTag" data-cost="2e34">20Dc Œ£C</div>
</div>
<!-- 68 -->
<div class="shopCard" data-index="68" title="Foso 69: M-Theory üß† (60Dc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-68">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g69_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth69_shop)"/>
    <defs>
      <linearGradient id="g69_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00008B"/><stop offset="100%" stop-color="#0000CD"/></linearGradient>
      <linearGradient id="mouth69_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_68_name">Foso 69: M-Theory üß†</div>
  <div class="priceTag" data-cost="6e34">60Dc Œ£C</div>
</div>
<!-- 69 -->
<div class="shopCard" data-index="69" title="Foso 70: The Matrix üü© (200Dc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-69">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g70_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth70_shop)"/>
    <defs>
      <linearGradient id="g70_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00FF00"/><stop offset="100%" stop-color="#006400"/></linearGradient>
      <linearGradient id="mouth70_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_69_name">Foso 70: The Matrix üü©</div>
  <div class="priceTag" data-cost="2e35">200Dc Œ£C</div>
</div>
<!-- 70 -->
<div class="shopCard" data-index="70" title="Foso 71: The Architect üìê (600Dc Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-70">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g71_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth71_shop)"/>
    <defs>
      <linearGradient id="g71_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F5F5F5"/><stop offset="100%" stop-color="#A9A9A9"/></linearGradient>
      <linearGradient id="mouth71_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_70_name">Foso 71: The Architect üìê</div>
  <div class="priceTag" data-cost="6e35">600Dc Œ£C</div>
</div>
<!-- 72 -->
<div class="shopCard" data-index="71" title="Foso 72: The Oracle üîÆ (2e36 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-71">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g72_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth72_shop)"/>
    <defs>
      <linearGradient id="g72_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#9400D3"/><stop offset="100%" stop-color="#4B0082"/></linearGradient>
      <linearGradient id="mouth72_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_71_name">Foso 72: The Oracle üîÆ</div>
  <div class="priceTag" data-cost="2e36">2e36 Œ£C</div>
</div>
<!-- 73 -->
<div class="shopCard" data-index="72" title="Foso 73: The One  Neo üï∂Ô∏è (6e36 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-72">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g73_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth73_shop)"/>
    <defs>
      <linearGradient id="g73_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#000000"/><stop offset="100%" stop-color="#006400"/></linearGradient>
      <linearGradient id="mouth73_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_72_name">Foso 73: The One üï∂Ô∏è</div>
  <div class="priceTag" data-cost="6e36">6e36 Œ£C</div>
</div>
<!-- 74 -->
<div class="shopCard" data-index="73" title="Foso 74: The Source üíª (2e37 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-73">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g74_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth74_shop)"/>
    <defs>
      <linearGradient id="g74_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00BFFF"/><stop offset="100%" stop-color="#1E90FF"/></linearGradient>
      <linearGradient id="mouth74_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_73_name">Foso 74: The Source üíª</div>
  <div class="priceTag" data-cost="2e37">2e37 Œ£C</div>
</div>
<!-- 75 -->
<div class="shopCard" data-index="74" title="Foso 75: The Glitch üêû (6e37 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-74">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g75_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth75_shop)"/>
    <defs>
      <linearGradient id="g75_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF0000"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth75_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_74_name">Foso 75: The Glitch üêû</div>
  <div class="priceTag" data-cost="6e37">6e37 Œ£C</div>
</div>
<!-- 76 -->
<div class="shopCard" data-index="75" title="Foso 76: The Anomaly ‚ùì (2e38 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-75">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g76_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth76_shop)"/>
    <defs>
      <linearGradient id="g76_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#800080"/><stop offset="100%" stop-color="#FF00FF"/></linearGradient>
      <linearGradient id="mouth76_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_75_name">Foso 76: The Anomaly ‚ùì</div>
  <div class="priceTag" data-cost="2e38">2e38 Œ£C</div>
</div>
<!-- 77 -->
<div class="shopCard" data-index="76" title="Foso 77: The Prophecy üìú (6e38 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-76">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g77_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth77_shop)"/>
    <defs>
      <linearGradient id="g77_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F5DEB3"/><stop offset="100%" stop-color="#D2B48C"/></linearGradient>
      <linearGradient id="mouth77_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_76_name">Foso 77: The Prophecy üìú</div>
  <div class="priceTag" data-cost="6e38">6e38 Œ£C</div>
</div>
<!-- 78 -->
<div class="shopCard" data-index="77" title="Foso 78: The Chosen One üëë (2e39 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-77">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g78_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth78_shop)"/>
    <defs>
      <linearGradient id="g78_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#B8860B"/></linearGradient>
      <linearGradient id="mouth78_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_77_name">Foso 78: The Chosen One üëë</div>
  <div class="priceTag" data-cost="2e39">2e39 Œ£C</div>
</div>
<!-- 79 -->
<div class="shopCard" data-index="78" title="Foso 79: The Resistance ‚úä (6e39 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-78">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g79_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth79_shop)"/>
    <defs>
      <linearGradient id="g79_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#B22222"/><stop offset="100%" stop-color="#800000"/></linearGradient>
      <linearGradient id="mouth79_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_78_name">Foso 79: The Resistance ‚úä</div>
  <div class="priceTag" data-cost="6e39">6e39 Œ£C</div>
</div>
<!-- 80 -->
<div class="shopCard" data-index="79" title="Foso 80: The Revolution üí• (2e40 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-79">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g80_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth80_shop)"/>
    <defs>
      <linearGradient id="g80_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF4500"/><stop offset="100%" stop-color="#FF0000"/></linearGradient>
      <linearGradient id="mouth80_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_79_name">Foso 80: The Revolution üí•</div>
  <div class="priceTag" data-cost="2e40">2e40 Œ£C</div>
</div>
<!-- 81 -->
<div class="shopCard" data-index="80" title="Foso 81: The Aftermath Ïûø (6e40 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-80">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g81_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth81_shop)"/>
    <defs>
      <linearGradient id="g81_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#808080"/><stop offset="100%" stop-color="#2F4F4F"/></linearGradient>
      <linearGradient id="mouth81_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_80_name">Foso 81: The Aftermath Ïûø</div>
  <div class="priceTag" data-cost="6e40">6e40 Œ£C</div>
</div>
<!-- 82 -->
<div class="shopCard" data-index="81" title="Foso 82: The New Beginning üå± (2e41 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-81">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g82_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth82_shop)"/>
    <defs>
      <linearGradient id="g82_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#98FB98"/><stop offset="100%" stop-color="#3CB371"/></linearGradient>
      <linearGradient id="mouth82_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_81_name">Foso 82: The New Beginning üå±</div>
  <div class="priceTag" data-cost="2e41">2e41 Œ£C</div>
</div>
<!-- 83 -->
<div class="shopCard" data-index="82" title="Foso 83: The Utopia üèûÔ∏è (6e41 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-82">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g83_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth83_shop)"/>
    <defs>
      <linearGradient id="g83_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#87CEEB"/><stop offset="100%" stop-color="#00BFFF"/></linearGradient>
      <linearGradient id="mouth83_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_82_name">Foso 83: The Utopia üèûÔ∏è</div>
  <div class="priceTag" data-cost="6e41">6e41 Œ£C</div>
</div>
<!-- 84 -->
<div class="shopCard" data-index="83" title="Foso 84: The Dystopia üèôÔ∏è (2e42 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-83">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g84_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth84_shop)"/>
    <defs>
      <linearGradient id="g84_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#708090"/><stop offset="100%" stop-color="#2F4F4F"/></linearGradient>
      <linearGradient id="mouth84_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_83_name">Foso 84: The Dystopia üèôÔ∏è</div>
  <div class="priceTag" data-cost="2e42">2e42 Œ£C</div>
</div>
<!-- 85 -->
<div class="shopCard" data-index="84" title="Foso 85: The Simulation üíª (6e42 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-84">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g85_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth85_shop)"/>
    <defs>
      <linearGradient id="g85_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#00FF7F"/><stop offset="100%" stop-color="#008080"/></linearGradient>
      <linearGradient id="mouth85_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_84_name">Foso 85: The Simulation üíª</div>
  <div class="priceTag" data-cost="6e42">6e42 Œ£C</div>
</div>
<!-- 86 -->
<div class="shopCard" data-index="85" title="Foso 86: The Dream üò¥ (2e43 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-85">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g86_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth86_shop)"/>
    <defs>
      <linearGradient id="g86_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#E6E6FA"/><stop offset="100%" stop-color="#D8BFD8"/></linearGradient>
      <linearGradient id="mouth86_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_85_name">Foso 86: The Dream üò¥</div>
  <div class="priceTag" data-cost="2e43">2e43 Œ£C</div>
</div>
<!-- 87 -->
<div class="shopCard" data-index="86" title="Foso 87: The Nightmare üëπ (6e43 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-86">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g87_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth87_shop)"/>
    <defs>
      <linearGradient id="g87_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#8B0000"/><stop offset="100%" stop-color="#000000"/></linearGradient>
      <linearGradient id="mouth87_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_86_name">Foso 87: The Nightmare üëπ</div>
  <div class="priceTag" data-cost="6e43">6e43 Œ£C</div>
</div>
<!-- 88 -->
<div class="shopCard" data-index="87" title="Foso 88: The Awakening üåÖ (2e44 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-87">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g88_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth88_shop)"/>
    <defs>
      <linearGradient id="g88_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFDAB9"/><stop offset="100%" stop-color="#FFA07A"/></linearGradient>
      <linearGradient id="mouth88_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_87_name">Foso 88: The Awakening üåÖ</div>
  <div class="priceTag" data-cost="2e44">2e44 Œ£C</div>
</div>
<!-- 89 -->
<div class="shopCard" data-index="88" title="Foso 89: The Enlightenment üí° (6e44 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-88">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g89_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth89_shop)"/>
    <defs>
      <linearGradient id="g89_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFFFE0"/><stop offset="100%" stop-color="#FFD700"/></linearGradient>
      <linearGradient id="mouth89_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_88_name">Foso 89: The Enlightenment üí°</div>
  <div class="priceTag" data-cost="6e44">6e44 Œ£C</div>
</div>
<!-- 90 -->
<div class="shopCard" data-index="89" title="Foso 90: The Ascension üöÄ (2e45 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-89">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g90_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth90_shop)"/>
    <defs>
      <linearGradient id="g90_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ADD8E6"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient>
      <linearGradient id="mouth90_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_89_name">Foso 90: The Ascension üöÄ</div>
  <div class="priceTag" data-cost="2e45">2e45 Œ£C</div>
</div>
<!-- 91 -->
<div class="shopCard" data-index="90" title="Foso 91: The Godhood ‚ú® (6e45 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-90">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g91_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth91_shop)"/>
    <defs>
      <linearGradient id="g91_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient>
      <linearGradient id="mouth91_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_90_name">Foso 91: The Godhood ‚ú®</div>
  <div class="priceTag" data-cost="6e45">6e45 Œ£C</div>
</div>
<!-- 92 -->
<div class="shopCard" data-index="91" title="Foso 92: The Beyond üåå (2e46 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-91">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g92_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth92_shop)"/>
    <defs>
      <linearGradient id="g92_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#000000"/><stop offset="100%" stop-color="#4B0082"/></linearGradient>
      <linearGradient id="mouth92_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_91_name">Foso 92: The Beyond üåå</div>
  <div class="priceTag" data-cost="2e46">2e46 Œ£C</div>
</div>
<!-- 93 -->
<div class="shopCard" data-index="92" title="Foso 93: The Omega Point üéØ (6e46 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-92">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g93_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth93_shop)"/>
    <defs>
      <linearGradient id="g93_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FF4500"/><stop offset="100%" stop-color="#DC143C"/></linearGradient>
      <linearGradient id="mouth93_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_92_name">Foso 93: The Omega Point üéØ</div>
  <div class="priceTag" data-cost="6e46">6e46 Œ£C</div>
</div>
<!-- 94 -->
<div class="shopCard" data-index="93" title="Foso 94: The Final Foso üèÅ (2e47 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-93">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g94_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth94_shop)"/>
    <defs>
      <linearGradient id="g94_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#C0C0C0"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient>
      <linearGradient id="mouth94_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_93_name">Foso 94: The Final Foso üèÅ</div>
  <div class="priceTag" data-cost="2e47">2e47 Œ£C</div>
</div>
<!-- 95 -->
<div class="shopCard" data-index="94" title="Foso 95: The Post-Game üéÆ (6e47 Œ£C)">
  <svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-94">
    <rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g95_shop)"/>
    <rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth95_shop)"/>
    <defs>
      <linearGradient id="g95_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#0000CD"/><stop offset="100%" stop-color="#000080"/></linearGradient>
      <linearGradient id="mouth95_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient>
    </defs>
  </svg>
  <div style="font-weight:700" data-lang="foso_94_name">Foso 95: The Post-Game üéÆ</div>
  <div class="priceTag" data-cost="6e47">6e47 Œ£C</div>
</div>
<!-- 96 -->
<div class="shopCard" data-index="95" title="Foso 96: The Credits üìú (2e48 Œ£C)"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-95"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g96_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth96_shop)"/><defs><linearGradient id="g96_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2F4F4F"/><stop offset="100%" stop-color="#000000"/></linearGradient><linearGradient id="mouth96_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700" data-lang="foso_95_name">Foso 96: The Credits üìú</div><div class="priceTag" data-cost="2e48">2e48 Œ£C</div></div>

<!-- --- SECCION: Fosos de Gema --- -->
<div style="grid-column:1/-1; font-weight:800; margin-top:10px; padding-top:8px; border-top:1px solid rgba(245, 158, 11, 0.3)" data-lang="gem_fosos">
  <svg class="icon" style="width:16px; height:16px;" viewBox="0 0 24 24"><path fill="#f1c40f" d="M12 2l-2.5 5.5L4 9l4.5 4.5L7 19l5-3.5 5 3.5-1.5-5.5L20 9l-5.5-1.5z"/></svg>
  Fosos de Gema (+5% Ganancias c/u)
</div>

      </div>
      
      <!-- --- SECCION: Fosos Exclusivos --- -->
      <div style="grid-column:1/-1; font-weight:800; margin-top:20px; padding-top:8px; border-top:1px solid rgba(239, 68, 68, 0.4)" data-lang="exclusive_fosos">
        <svg class="icon" style="width:16px; height:16px; color: #ef4444;" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
        Fosos Exclusivos
      </div>
      <div class="shopGrid" id="exclusiveShopGrid">
        <!-- Foso Pollo (Exclusivo Ruleta) -->
        <div class="shopCard" data-index="45" title="Foso Pollo üçó (Exclusivo de la Ruleta)" style="display: none;"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-45"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g46_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth46_shop)"/><defs><linearGradient id="g46_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ADFF2F"/><stop offset="100%" stop-color="#006400"/></linearGradient><linearGradient id="mouth46_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#444"/><stop offset="100%" stop-color="#111"/></linearGradient></defs></svg><div style="font-weight:700" data-lang="foso_45_name">Foso Pollo üçó</div><div class="priceTag" data-cost="Infinity">Ruleta</div></div>
        <!-- Foso Yousef (Exclusivo Ruleta) -->
        <div class="shopCard" data-index="46" title="Foso Yousef üëë (Exclusivo de la Ruleta)" style="display: none;"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-46"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g47_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth47_shop)"/><defs><linearGradient id="g47_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ffd700"/><stop offset="100%" stop-color="#f0a500"/></linearGradient><linearGradient id="mouth47_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#4a2c00"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700" data-lang="foso_46_name">Foso Yousef üëë</div><div class="priceTag" data-cost="Infinity">Ruleta</div></div>
        <!-- Foso Dyland -->
        <div class="shopCard" data-index="96" title="Foso Dyland üëæ"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-96"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g97_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth97_shop)"/><defs><linearGradient id="g97_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#8e44ad"/><stop offset="100%" stop-color="#341f97"/></linearGradient><linearGradient id="mouth97_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso Dyland üëæ</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
        <!-- Foso Aziz -->
        <div class="shopCard" data-index="97" title="Foso Aziz üëì"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-97"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g98_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth98_shop)"/><defs><linearGradient id="g98_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#c0392b"/><stop offset="100%" stop-color="#e74c3c"/></linearGradient><linearGradient id="mouth98_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso Aziz üëì</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
        <!-- Foso Ali -->
        <div class="shopCard" data-index="98" title="Foso Ali ‚ùÑÔ∏è"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-98"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g99_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth99_shop)"/><defs><linearGradient id="g99_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ecf0f1"/><stop offset="100%" stop-color="#bdc3c7"/></linearGradient><linearGradient id="mouth99_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso Ali ‚ùÑÔ∏è</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
        <!-- Estuche David Calls -->
        <div class="shopCard" data-index="99" title="Foso David Calls üì±"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-99"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g100_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth100_shop)"/><defs><linearGradient id="g100_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#3498db"/><stop offset="100%" stop-color="#2980b9"/></linearGradient><linearGradient id="mouth100_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso David Calls üì±</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
        <!-- Foso Esteva -->
        <div class="shopCard" data-index="100" title="Foso Esteva ‚ö°"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-100"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g101_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth101_shop)"/><defs><linearGradient id="g101_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#f1c40f"/><stop offset="100%" stop-color="#f39c12"/></linearGradient><linearGradient id="mouth101_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso Esteva ‚ö°</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
        <!-- Foso Calfa -->
        <div class="shopCard" data-index="101" title="Foso Calfa üí∏"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-101"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g102_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth102_shop)"/><defs><linearGradient id="g102_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#27ae60"/><stop offset="100%" stop-color="#2ecc71"/></linearGradient><linearGradient id="mouth102_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso Calfa üí∏</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
        <!-- Foso Discord -->
        <div class="shopCard" data-index="102" title="Foso Discord üí¨"><svg viewBox="0 0 100 260" xmlns="http://www.w3.org/2000/svg" id="foso-svg-102"><rect x="20" y="20" width="60" height="220" rx="12" fill="url(#g103_shop)"/><rect x="20" y="0" width="60" height="20" rx="10" fill="url(#mouth103_shop)"/><defs><linearGradient id="g103_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#5865F2"/><stop offset="100%" stop-color="#4e5bf0"/></linearGradient><linearGradient id="mouth103_shop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#2c2c54"/><stop offset="100%" stop-color="#000"/></linearGradient></defs></svg><div style="font-weight:700">Foso Discord üí¨</div><div class="priceTag gem-price" data-cost="3000">3k üëë</div></div>
      </div>

      <!-- --- SECCION: Sabores Especiales (Consumibles) --- -->
      <div style="grid-column:1/-1; font-weight:800; margin-top:10px; padding-top:8px; border-top:1px solid rgba(46, 204, 113, 0.3)" data-lang="special_flavors">
        <svg class="icon" style="width:16px; height:16px;" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
        Sabores Especiales (Consumibles)
      </div>
      <div class="shopGrid" id="consumablesShopGrid">
        <div class="shopCard" data-flavor-id="mint_burst" title="Aumenta la probabilidad de cr√≠tico en +5% durante 2 minutos.">
          <div style="font-size: 32px;">üåøüí•</div>
          <div style="font-weight:700">R√°faga de Menta</div>
          <div class="priceTag" data-cost="500000">500K Œ£C</div>
        </div>
        <div class="shopCard" data-flavor-id="strawberry_boost" title="Aumenta las ganancias de Œ£C en +50% durante 5 minutos."><svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #e74c3c;"><path d="M12 2C8.686 2 6 4.686 6 8c0 4 6 12 6 12s6-8 6-12c0-3.314-2.686-6-6-6zm0 8c-1.105 0-2-.895-2-2s.895-2 2-2 2 .895 2 2-.895 2-2 2z"/></svg><div style="font-weight:700">Impulso de Fresa</div><div class="priceTag" data-cost="2000000">2M Œ£C</div></div>
        <div class="shopCard" data-flavor-id="gem_essence" title="Aumenta la probabilidad de encontrar gemas en +1% durante 10 minutos.">
          <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #3498db;"><path d="M12 2l-2.5 5.5L4 9l4.5 4.5L7 19l5-3.5 5 3.5-1.5-5.5L20 9l-5.5-1.5z"/></svg>
          <div style="font-weight:700">Esencia de Gema</div>
          <div class="priceTag gem-price" data-cost="50">50 üíé</div>
        </div>
        <div class="shopCard" data-flavor-id="tycoon_elixir" title="Aumenta TODAS las ganancias de Œ£C en +100% durante 15 minutos.">
          <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #f1c40f;"><path d="M5 16L3 5l5.5 5L12 3l3.5 7L21 5l-2 11H5zm14 3H5a1 1 0 0 0 0 2h14a1 1 0 0 0 0-2z"/></svg>
          <div style="font-weight:700">Elixir del Magnate</div>
          <div class="priceTag gem-price" data-cost="150">150 üíé</div>
        </div>
        <div class="shopCard" data-flavor-id="battery_chew" title="Reduce el consumo de bater√≠a en un 50% durante 10 minutos.">
          <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #2ecc71;"><path d="M17 4h-3V2h-4v2H7c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14h-2v-6h2v6z"/></svg>
          <div style="font-weight:700">Chicle de Bater√≠a</div>
          <div class="priceTag" data-cost="10000000">10M Œ£C</div>
        </div>
        <div class="shopCard" data-flavor-id="repair_tonic" title="Repara instant√°neamente el 25% de la condici√≥n de tu foso actual.">
          <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #95a5a6;"><path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.4-2.4c.4-.4.4-1 0-1.4z"/></svg>
          <div style="font-weight:700">T√≥nico de Reparaci√≥n</div>
          <div class="priceTag" data-cost="25000000">25M Œ£C</div>
        </div>
        <div class="shopCard" data-flavor-id="chest_magnet" title="Aumenta la probabilidad de encontrar cofres en +5% durante 10 minutos.">
          <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #e67e22;"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 13H8v-2h4v2zm0-3H8v-2h4v2zm0-3H8V9h4v2zm4 6h-2v-2h2v2zm0-3h-2v-2h2v2zm0-3h-2V9h2v2z"/></svg>
          <div style="font-weight:700">Im√°n de Cofres</div>
          <div class="priceTag gem-price" data-cost="75">75 üíé</div>
        </div>
        <div class="shopCard" data-flavor-id="time_potion" title="Otorga instant√°neamente 1 hora de ganancias AFK.">
          <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill: #8e44ad;"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.5 14H11v-6h2v4h1.5v2z"/></svg>
          <div style="font-weight:700">Poci√≥n del Tiempo</div>
          <div class="priceTag gem-price" data-cost="200">200 üíé</div>
        </div>
      </div>

      </div>
    </aside>

    </div>
  </div>
</div>
  
    <footer>
      <div style="display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap">
        <span class="metaTiny" data-lang="follow_us">S√≠guenos:</span>
        <a href="https://instagram.com/sigmacompanyoficial" target="_blank" rel="noopener" class="metaTiny">@sigmacompanyoficial</a>
        <span>‚Ä¢</span>
        <a href="https://tiktok.com/@sigmacompanyoficial" target="_blank" rel="noopener" class="metaTiny">@sigmacompanyoficial</a>
        <span>‚Ä¢</span>
        <a href="https://x.com/sigmacompanyoficial" target="_blank" rel="noopener" class="metaTiny">@sigmacompanyoficial</a>
        <span>‚Ä¢</span>
        <a href="https://facebook.com/sigmacompanyoficial" target="_blank" rel="noopener" class="metaTiny">@sigmacompanyoficial</a>
        <span>‚Ä¢</span>
        <a href="https://youtube.com/@sigmacompanyoficial" target="_blank" rel="noopener" class="metaTiny">@sigmacompanyoficial</a>
      </div>
      <div class="metaTiny" style="margin-top:6px" data-lang="footer_credits">Maqueta funcional ‚Äî HTML/CSS/JS puro. Guardado autom√°tico en localStorage.</div>
    </footer>
  </div>
   
  <!-- Modal Poderes -->
<div id="powersModal" class="modal hidden">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h2 data-lang="powers">Poderes</h2>
    <div id="powersGrid" class="powers-grid"></div>
  </div>
</div>

<!-- Modal Configuraci√≥n -->
<div id="configModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
        <div class="modal-title" data-lang="settings_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V22a2 2 0 1 1-4 0v-.11a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H2a2 2 0 1 1 0-4h.11a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 6.06 3.3l.06.06a1.65 1.65 0 0 0 1.82.33H8a1.65 1.65 0 0 0 1-1.51V2a2 2 0 1 1 4 0v.11a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06A2 2 0 1 1 20.7 6.06l-.06.06a1.65 1.65 0 0 0-.33 1.82V8c0 .64.39 1.22 1 1.51.35.17.73.49.73.49"/></svg> Configuraci√≥n</div>
        <button class="close-btn" data-close>&times;</button>
    </div>
    <div class="modal-body">
        <div class="config-grid">
            <div class="config-item">
                <label for="langSelect" data-lang="language_label">Idioma üåê</label>
                <select id="langSelect" class="mata-btn" style="padding: 10px 16px;">
                    <option value="es">Espa√±ol</option>
                    <option value="en">English</option>
                </select>
            </div>
            <div class="config-item">
                <label for="chkSmoke" data-lang="smoke_animation_label">Animaci√≥n de Humo üí®</label>
                <label class="switch">
                    <input type="checkbox" id="chkSmoke" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="config-item">
                <label for="chkClickNumbers" data-lang="click_numbers_label">N√∫meros al Clicar ‚ú®</label>
                <label class="switch">
                    <input type="checkbox" id="chkClickNumbers" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="config-item">
                <label data-lang="manual_save_label">Guardado Manual üíæ</label>
                <button id="btnManualSave" class="mata-btn" data-lang="manual_save_button">Guardar Ahora</button>
            </div>
            <div class="config-item">
                <label data-lang="reset_progress_label">Borrar Progreso üí£</label>
                <button id="btnReset" class="mata-btn" style="background:#c11e3c;" data-lang="reset_progress_button">Borrar Todo</button>
            </div>
            <div class="config-item">
                <label data-lang="repeat_tutorial_label">Repetir Tutorial üéì</label>
                <button id="btnRepeatTutorial" class="mata-btn" data-lang="repeat_tutorial_button">Reiniciar Tutorial</button>
            </div>
            <div class="config-item">
                <label for="musicVolume" data-lang="music_volume_label">Volumen de M√∫sica üéµ</label>
                <input type="range" id="musicVolume" min="0" max="1" step="0.05" class="slider-input">
            </div>
            <div class="config-item">
                <label for="sfxVolume" data-lang="sfx_volume_label">Volumen de Efectos üîä</label>
                <input type="range" id="sfxVolume" min="0" max="1" step="0.05" class="slider-input">
            </div>
        </div>
    </div>
  </div>
</div>


<!-- Modal Recompensas Diarias -->
<div id="dailyModal" class="hidden" style="
  position: fixed; top:0; left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.8); display:flex;
  align-items:center; justify-content:center;
  z-index:1000;">

  <div style="background:#111; padding:20px; border-radius:12px;
              max-width:600px; width:90%; text-align:center; color:#fff; position:relative; animation: modalIn 0.3s cubic-bezier(0.25, 1, 0.5, 1);">

    <span id="closeDaily" style="position:absolute; top:10px; right:15px; cursor:pointer; font-size:28px;">&times;</span>
    <h2 data-lang="daily_rewards_title">üéÅ Recompensas Diarias</h2>

    <div id="carousel" style="display:flex; overflow-x:auto; gap:15px; padding:10px;">
      <!-- Tarjetas generadas por JS -->
    </div>

    <button id="btnClaimDaily" class="mata-btn" style="margin-top:15px;" data-lang="claim_today">
      Reclamar de hoy
    </button>
  </div>
</div>

<!-- Modal Ruleta -->
<div id="wheelModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="wheel_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg> Ruleta de la Fortuna</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body" style="align-items: center; text-align: center;">
            <div class="wheel-container">
                <div class="wheel-pointer"></div>
                <div class="wheel"></div>
            </div>
            <button id="btnSpinWheel" class="mata-btn" style="margin-top: 20px; background: var(--accent);" data-lang="spin">Girar</button>
            <p id="wheelCooldownText" class="metaTiny" style="margin-top: 10px;"></p>
        </div>
    </div>
</div>

<!-- Modal Misiones -->
<div id="missionsModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="missions_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="9 17 4 12 9 7"></polyline><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="15 7 20 12 15 17"></polyline></svg> Misiones Diarias</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body" id="missionsGrid">
            <!-- Las misiones se generar√°n aqu√≠ -->
        </div>
    </div>
</div>

<!-- Modal Cofres -->
<div id="chestsModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="chests_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg> Cofres Sorpresa</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body">
            <p id="chestsInfo" class="hint" data-lang="chests_desc">¬°Has encontrado cofres! Haz clic en uno para abrirlo y ver qu√© contiene.</p>
            <div id="chestsGrid" style="display:flex; flex-wrap:wrap; gap:15px; justify-content:center; margin-top:15px;">
                <!-- Los cofres se generar√°n aqu√≠ -->
            </div>
        </div>
    </div>
</div>

<!-- Modal Mantenimiento -->
<div id="maintenanceModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="maintenance_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg> Mantenimiento de Foso</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body" style="text-align: center;">
            <p id="maintenanceInstructions" data-lang="maintenance_instructions">¬°El foso necesita limpieza! Haz clic en los puntos en orden num√©rico para repararlo.</p>
            <div id="maintenanceGameArea">
                <!-- Puntos de mantenimiento generados por JS -->
            </div>
            <p id="maintenanceRewardText" class="metaTiny"></p>
        </div>
    </div>
</div>

<!-- Modal Mascotas -->
<div id="petsModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="pets_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0L12 2.69z"></path><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg> Tienda de Mascotas</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <p class="hint" data-lang="pets_desc">Compra mascotas con gemas para obtener bonus permanentes.</p>
                <div class="priceTag" style="background-color: #8e44ad;">üíé <span id="petsGems">0</span></div>
            </div>
            <div id="petsGrid" class="shopGrid" style="grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); max-height: 60vh;">
                <!-- Las mascotas se generar√°n aqu√≠ -->
            </div>
        </div>
    </div>
</div>

<!-- Modal Mercado Negro -->
<div id="blackMarketModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="black_market_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V22a2 2 0 1 1-4 0v-.11a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H2a2 2 0 1 1 0-4h.11a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 6.06 3.3l.06.06a1.65 1.65 0 0 0 1.82.33H8a1.65 1.65 0 0 0 1-1.51V2a2 2 0 1 1 4 0v.11a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V8c0 .64.39 1.22 1 1.51.35.17.73.49.73.49"></path></svg> Mercado Negro</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body">
            <p class="hint" data-lang="black_market_desc">Un vendedor misterioso te ofrece estos tratos... ¬°Solo por tiempo limitado!</p>
            <div id="blackMarketGrid" class="shopGrid" style="grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));"></div>
        </div>
    </div>
</div>

<!-- Modal C√≥digo Promocional -->
<div id="promoModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="promo_code_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M21.4 11.6l-9-9a2 2 0 0 0-2.8 0l-9 9a2 2 0 0 0 0 2.8l9 9a2 2 0 0 0 2.8 0l9-9a2 2 0 0 0 0-2.8z"></path><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg> C√≥digo Promocional</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body" style="text-align: center;">
            <p class="hint" data-lang="promo_code_desc">Introduce un c√≥digo para recibir recompensas especiales.</p>
            <div style="display:flex; gap:8px; margin-top: 15px;">
                <input id="promoInput" type="text" placeholder="Introduce un c√≥digo" data-lang-placeholder="promo_code_placeholder" style="flex:1; padding:10px; border-radius:8px; border:1px solid rgba(100, 116, 139, 0.2); background:rgba(0,0,0,0.12); color:inherit; text-align: center;">
                <button id="promoBtn" class="mata-btn" data-lang="redeem" style="justify-content: center;">
                    Canjear
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Intercambio -->
<div id="exchangeModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-lang="exchange_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><path d="M16 3.54a2.5 2.5 0 0 1 0 4.92M8 15.54a2.5 2.5 0 0 1 0 4.92m5-13.52L6.5 14.06m11-6.04L9.5 19.56" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg> Intercambio de Moneda</div>
            <button class="close-btn" data-close>&times;</button>
        </div>
        <div class="modal-body" style="text-align: center;">
            <p class="hint" data-lang="exchange_desc">Intercambia 30 Sigmacoins (Œ£C) por 1 Gema (üíé).</p>
            <div style="display:flex; flex-direction: column; gap:10px; margin-top: 15px; align-items: center;">
                <input id="exchangeInput" type="number" placeholder="Cantidad de gemas a comprar" data-lang-placeholder="exchange_placeholder" style="padding:10px; border-radius:8px; border:1px solid rgba(100, 116, 139, 0.2); background:rgba(0,0,0,0.12); color:inherit; text-align: center; max-width: 250px;">
                <p id="exchangeCost" class="metaTiny">Costo: 0 Œ£C</p>
                <button id="exchangeBtn" class="mata-btn" data-lang="exchange_button" style="justify-content: center;">
                    Intercambiar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div id="toastContainer"></div>

<!-- Modal AFK -->
<div id="afkModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
        <div class="modal-title" data-lang="afk_upgrades_title"><svg class="icon" style="width:20px; height:20px;" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 3"/></svg> Mejoras AFK</div>
        <button class="close-btn" data-close>&times;</button>
    </div>
    <div class="modal-body" style="text-align: center;">
        <p id="afkInfo" style="margin-bottom: 15px;"></p>
        <div style="display:flex;gap:12px;justify-content:center;">
            <button id="btnUpgradeAFK" class="mata-btn" data-lang="upgrade">
                <svg class="icon" viewBox="0 0 24 24"><path d="M12 5v14m-7-7h14"/></svg>
                Mejorar
            </button>
            <button id="btnClaimAFK" class="mata-btn" style="background: var(--accent);" data-lang="claim"><svg class="icon" viewBox="0 0 24 24"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg> Reclamar</button>
        </div>
    </div>
  </div>
</div>

<script>
    // Bloquear scroll y ocultar advertencia tras 3s
    document.documentElement.style.overflow = 'hidden';

  // Intro animation
  const introAnimation = document.getElementById('intro-animation');
  const introText1 = document.getElementById('intro-text1');
  const introText2 = document.getElementById('intro-text2');
  const advertencia = document.getElementById('advertencia');

  setTimeout(() => {
      introText1.classList.add('active');
  }, 500);

  setTimeout(() => {
      introText1.classList.remove('active');
  }, 2500);

  setTimeout(() => {
      introText1.style.display = 'none';
      introText2.style.display = 'flex';
      introText2.classList.add('active');
  }, 3500);

  setTimeout(() => {
      introText2.classList.remove('active');
  }, 5500);

  setTimeout(() => {
    introAnimation.style.opacity = 0; // Oculta la animaci√≥n de logos
    advertencia.style.opacity = 1; // Muestra la advertencia
    setTimeout(() => introAnimation.style.display = 'none', 1000);
  }, 6500);

  setTimeout(() => {
      advertencia.style.opacity = 0;
      setTimeout(() => {
          advertencia.style.display = 'none';
          document.documentElement.style.overflow = '';
      }, 1000);
  }, 8000);


    (function() {
        const LANGUAGES = {
            es: {
                sigmacoin: "Sigmacoin",
                per_click: "Por clic",
                exclusive_currency: "Moneda Exclusiva",
                total_clicks: "Clicks Totales",
                ranking: "Ranking",
                streak: "Racha",
                days: "d√≠as",
                streak_hint: "Vuelve cada d√≠a para aumentar tu racha",
                foso_tooltip: "Haz click en cualquier parte del foso para generar Œ£C",
                power: "Poderes",
                charge: "Cargar",
                charging: "Cargando...",
                mata_foso: "Mata Foso",
                cooldown: "Cooldown",
                shop: "Tienda",
                upgrades: "Mejoras Permanentes",
                upgrades_title: "Mejoras Permanentes",
                upgrades_desc: "Compra mejoras con Œ£C para potenciar tus ganancias y eficiencia de forma permanente.",
                rebirth: "Rebirth",
                daily_gift: "Regalo Diario",
                wheel: "Ruleta",
                prestige: "Prestigio",
                prestige_title: "üåü Prestigio",
                prestige_desc: "¬°Felicidades! Has llegado al final del camino... por ahora. Hacer Prestigio reiniciar√° tu progreso (como un Rebirth) pero te otorgar√° Puntos de Prestigio (PP) para desbloquear mejoras permanentes incre√≠blemente poderosas.",
                exchange: "Intercambio",
                exchange_title: "Intercambio de Moneda",
                exchange_desc: "Intercambia 30 Sigmacoins (Œ£C) por 1 Gema (üíé).",
                confirm_prestige: "Confirmar Prestigio",
                prestige_points: "Puntos de Prestigio",
                crafting: "Laboratorio",
                crafting_title: "üß™ Laboratorio de Sabores",
                crafting_desc: "Arrastra l√≠quidos de tu inventario a las ranuras para combinarlos y crear sabores temporales con bonus.",
                liquid_inventory: "Inventario de L√≠quidos",
                crafting_area: "√Årea de Crafteo",
                combine: "Combinar",
                active_flavor: "Sabor Activo",
                no_active_flavor: "Ninguno", 
                gem_fosos: "Fosos de Gema (+5% Ganancias c/u)",
                special_flavors: "Sabores Especiales (Consumibles)",
                pets: "Mascotas",
                afk_upgrades: "Mejoras AFK",
                missions: "Misiones",
                redeem: "Canjear",
                maintenance: "Mantenimiento",
                foso_condition: "Condici√≥n del Foso",
                maintenance_title: "üîß Mantenimiento de Foso",
                maintenance_instructions: "¬°El foso necesita limpieza! Haz clic en los puntos en orden num√©rico para repararlo.",
                maintenance_reward: "Recompensa por mantenimiento: {amount} Œ£C",
                time_left: "Tiempo restante",
                event_frenzy: "üî• ¬°Fiebre del Clic! (x5 Ganancias)",
                event_gem_rain: "üíé ¬°Lluvia de Gemas! (+10% prob. de gema por clic)",
                event_free_repair: "üîß ¬°Reparaci√≥n Gratuita! (Foso reparado al 100%)",
                event_combo_madness: "‚ö° ¬°Combo Infinito! (El combo no se reinicia)",
                event_infinite_battery: "üîã ¬°Bater√≠a Infinita! (No se gasta bater√≠a)",
                event_black_market: "üïµÔ∏è ¬°Mercado Negro Abierto!",
                black_market_title: "üïµÔ∏è Mercado Negro",
                exchange_placeholder: "Cantidad de gemas a comprar",
                exchange_button: "Intercambiar",
                black_market_desc: "Un vendedor misterioso te ofrece estos tratos... ¬°Solo por tiempo limitado!",
                promo_code_button: "C√≥digo Promocional",
                promo_code_title: "üéÅ C√≥digo Promocional",
                chests_title: "üéÅ Cofres Sorpresa",
                chests_desc: "¬°Has encontrado cofres! Haz clic en uno para abrirlo y ver qu√© contiene.",
                combo_meter: "Combo x{value}",
                promo_code_placeholder: "C√≥digo promo",
                achievements: "Logros",
                settings: "Configuraci√≥n", 
                achievements_title: "Logros",
                rebirth_title: "Rebirth",
                rebirth_desc: "Hacer un Rebirth reiniciar√° tu progreso (Œ£C, fosos, mejoras) a cambio de una bonificaci√≥n permanente en tus ganancias por clic.",
                confirm_rebirth: "Confirmar Rebirth", 
                shop_hint: "Tienda: clic en la miniatura para equipar/comprar.",
                shop_title: "Tienda ‚Äî Fositos",
                upgrade_battery: "Capacidad Bater√≠a",
                upgrade_autoclicker: "Autoclicker",
                upgrade_critical: "Clics Cr√≠ticos",
                upgrade_efficiency: "Eficiencia de Clic",
                upgrade_combo: "Combo Extendido",
                upgrade_liquid_luck: "Suerte de L√≠quido",
                upgrade_autorecharge: "Auto-Recarga",
                upgrade_passive_recharge: "Recarga Pasiva",
                follow_us: "S√≠guenos:",
                footer_credits: "Maqueta funcional ‚Äî HTML/CSS/JS puro. Guardado autom√°tico en localStorage.",
                settings_title: "Configuraci√≥n",
                language_label: "Idioma üåê",
                smoke_animation_label: "Animaci√≥n de Humo üí®",
                click_numbers_label: "N√∫meros al Clicar ‚ú®",
                manual_save_label: "Guardado Manual üíæ",
                manual_save_button: "Guardar Ahora",
                reset_progress_label: "Borrar Progreso üí£",
                reset_progress_button: "Borrar Todo",
                daily_rewards_title: "Recompensas Diarias",
                claim_today: "Reclamar de hoy",
                afk_upgrades_title: "Mejoras AFK",
                upgrade: "Mejorar",
                claim: "üí∞ Reclamar",
                wheel_title: "üé° Ruleta de la Fortuna",
                spin: "Girar",
                next_spin: "Pr√≥ximo giro en:",
                missions_title: "üéØ Misiones Diarias",
                owned: "Adquirido",
                max_level: "MAX",
                tutorial_1: "¬°Bienvenido a Foso Tycoon! Haz clic en el foso para ganar tus primeros Sigmacoins.",
                tutorial_2: "¬°Genial! Cada clic consume un poco de bater√≠a. Puedes verla en la pantalla del foso.",
                tutorial_3: "Para recargar la bater√≠a, pulsa el bot√≥n 'Cargar'. No podr√°s clicar mientras se carga.",
                tutorial_4: "¬°Bien hecho! Ahora, vamos a comprar un foso mejor. Abre la Tienda desde el men√∫ lateral.",
                tutorial_5: "Ahorra 200 Œ£C y haz clic en el 'Foso 2: Strawberry Kiwi' para aumentar tus ganancias.",
                tutorial_6: "¬°Buena compra! En el men√∫ tambi√©n encontrar√°s 'Mejoras Permanentes', que son muy √∫tiles para progresar.",
                tutorial_7: "¬°Ya casi terminamos! Revisa tu 'Regalo Diario', la 'Ruleta' y las 'Misiones' para acelerar tu progreso. Est√°n en el men√∫ lateral.",
                tutorial_8: "¬°Tutorial completado! Ahora explora todas las funciones y convi√©rtete en un Magnate del Foso.",
                rank_0: "Novato",
                rank_1: "Aprendiz de Foso",
                rank_2: "Clickeador Casual",
                rank_3: "Maestro del Foso",
                rank_4: "Magnate del Vapor",
                rank_5: "Leyenda Sigma",
                repeat_tutorial_label: "Repetir Tutorial üéì",
                repeat_tutorial_button: "Reiniciar Tutorial",
                music_volume_label: "Volumen de M√∫sica üéµ",
                sfx_volume_label: "Volumen de Efectos üîä",
                next: "Siguiente",
                got_it: "¬°Entendido!",
                foso_broken_toast: "¬°Foso roto! Rep√°ralo desde el men√∫ de Mantenimiento.",
                foso_repaired_toast: "¬°Foso reparado! Has ganado {amount} Œ£C.",
            },
            en: {
                game_title: "Foso Tycoon",
                sigmacoin: "Sigmacoin",
                exclusive_currency: "Exclusive Currency",
                per_click: "Per Click",
                total_clicks: "Total Clicks",
                ranking: "Ranking",
                streak: "Streak",
                days: "days",
                streak_hint: "Come back every day to increase your streak",
                foso_tooltip: "Click anywhere on the foso to generate Œ£C",
                power: "Power",
                charge: "Charge",
                charging: "Charging‚Ä¶",
                mata_foso: "Kill Foso",
                cooldown: "Cooldown",
                shop: "Shop",
                upgrades: "Permanent Upgrades",
                upgrades_title: "Permanent Upgrades",
                upgrades_desc: "Buy upgrades with Œ£C to permanently boost your earnings and efficiency.",
                rebirth: "Rebirth",
                daily_gift: "Daily Gift",
                wheel: "Wheel",
                afk_upgrades: "AFK Upgrades",
                missions: "Missions",
                redeem: "Redeem",
                maintenance: "Maintenance",
                foso_condition: "Foso Condition",
                maintenance_title: "üîß Foso Maintenance",
                maintenance_instructions: "The foso needs cleaning! Click the points in numerical order to repair it.",
                maintenance_reward: "Maintenance reward: {amount} Œ£C",
                time_left: "Time left",
                event_frenzy: "üî• Click Frenzy! (x5 Earnings)",
                event_gem_rain: "üíé Gem Rain! (+10% gem chance per click)",
                event_free_repair: "üîß Free Repair! (Foso repaired to 100%)",
                event_combo_madness: "‚ö° Infinite Combo! (Combo doesn't reset)",
                event_infinite_battery: "üîã Infinite Battery! (No battery drain)",
                event_black_market: "üïµÔ∏è Black Market Open!",
                black_market_title: "üïµÔ∏è Black Market",
                exchange_desc: "Exchange 30 Sigmacoins (Œ£C) for 1 Gem (üíé).",
                exchange_placeholder: "Amount of gems to buy",
                exchange_button: "Exchange",
                black_market_desc: "A mysterious vendor offers you these deals... For a limited time only!",
                promo_code_button: "Promo Code",
                promo_code_title: "üéÅ Promo Code",
                chests_title: "üéÅ Surprise Chests",
                chests_desc: "You've found chests! Click one to open it and see what's inside.",
                combo_meter: "Combo x{value}",
                promo_code_placeholder: "Promo code",
                achievements: "Achievements",
                settings: "Settings",
                achievements_title: "üèÜ Achievements",
                rebirth_title: "üîÑ Rebirth",
                rebirth_desc: "Rebirthing will reset your progress (Œ£C, fosos, upgrades) in exchange for a permanent bonus to your earnings per click.",
                confirm_rebirth: "Confirm Rebirth",
                shop_hint: "Shop: click on a thumbnail to equip/buy.",
                shop_title: "Shop ‚Äî Fositos",
                upgrade_battery: "Battery Capacity",
                upgrade_autoclicker: "Autoclicker",
                upgrade_critical: "Critical Clicks",
                upgrade_efficiency: "Click Efficiency",
                upgrade_combo: "Combo Extension",
                upgrade_liquid_luck: "Liquid Luck",
                upgrade_autorecharge: "Auto-Recharge",
                upgrade_passive_recharge: "Passive Recharge",
                follow_us: "Follow us:",
                footer_credits: "Functional prototype ‚Äî Pure HTML/CSS/JS. Autosave to localStorage.",
                settings_title: "‚öôÔ∏è Settings",
                language_label: "Language üåê",
                smoke_animation_label: "Smoke Animation üí®",
                click_numbers_label: "Click Numbers ‚ú®",
                manual_save_label: "Manual Save üíæ",
                manual_save_button: "Save Now",
                reset_progress_label: "Reset Progress üí£",
                reset_progress_button: "Reset All",
                daily_rewards_title: "üéÅ Daily Rewards",
                claim_today: "Claim Today's",
                afk_upgrades_title: "‚è∞ AFK Upgrades",
                upgrade: "‚¨ÜÔ∏è Upgrade",
                claim: "üí∞ Claim",
                wheel_title: "üé° Wheel of Fortune",
                spin: "Spin",
                next_spin: "Next spin in:",
                missions_title: "üéØ Daily Missions",
                owned: "Owned",
                max_level: "MAX",
                tutorial_1: "Welcome to Foso Tycoon! Click the foso to earn your first Sigmacoins.",
                tutorial_2: "Great! Each click consumes a bit of battery. You can see it on the foso's screen.",
                tutorial_3: "To recharge the battery, press the 'Charge' button. You can't click while it's charging.",
                tutorial_4: "Well done! Now, let's buy a better foso. Open the Shop from the side menu.",
                tutorial_5: "Save up 200 Œ£C and click on 'Foso 2: Strawberry Kiwi' to increase your earnings.",
                tutorial_6: "Good purchase! In the menu, you'll also find 'Permanent Upgrades', which are very useful for progressing.",
                tutorial_7: "We're almost done! Check your 'Daily Gift', the 'Wheel', and 'Missions' to speed up your progress. They are in the side menu.",
                tutorial_8: "Tutorial complete! Now explore all the features and become a Foso Tycoon.",
                rank_0: "Newbie",
                rank_1: "Foso Apprentice",
                rank_2: "Casual Clicker",
                rank_3: "Foso Master",
                rank_4: "Vape Tycoon",
                rank_5: "Sigma Legend",
                repeat_tutorial_label: "Repeat Tutorial üéì",
                repeat_tutorial_button: "Restart Tutorial",
                music_volume_label: "Music Volume üéµ",
                sfx_volume_label: "SFX Volume üîä",
                next: "Next",
                got_it: "Got it!",
                foso_broken_toast: "Foso is broken! Repair it from the Maintenance menu.",
                foso_repaired_toast: "Foso repaired! You earned {amount} Œ£C.",
            }
        };

        const FOSOS = [{
            id: 1,
            name: 'Foso 1',
            cost: 0, background: 'radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%)',
            perClick: 1
        }, {
            id: 2,
            name: 'Foso 2',
            cost: 250, background: 'radial-gradient(ellipse at bottom, #3d0b0b 0%, #1a0505 100%)',
            perClick: 2
        }, {
            id: 3,
            name: 'Foso 3',
            cost: 1000, background: 'radial-gradient(ellipse at bottom, #002240 0%, #000c1a 100%)',
            perClick: 5
        }, {
            id: 4,
            name: 'Foso 4',
            cost: 4000, background: 'radial-gradient(ellipse at bottom, #2c3e50 0%, #0e1318 100%)',
            perClick: 15
        }, {
            id: 5,
            name: 'Foso 5',
            cost: 15000, background: 'radial-gradient(ellipse at bottom, #5d4900 0%, #292000 100%)',
            perClick: 50
        }, {
            id: 6,
            name: 'Foso 6',
            cost: 50000, background: 'radial-gradient(ellipse at bottom, #3b1f4a 0%, #180c1e 100%)',
            perClick: 100
        }, {
            id: 7,
            name: 'Foso 7: Peach Mango üçëü•≠',
            cost: 200000, background: 'radial-gradient(ellipse at bottom, #5c0000 0%, #240000 100%)',
            perClick: 150
        }, {
            id: 8,
            name: 'Foso 8',
            cost: 750000, background: 'radial-gradient(ellipse at bottom, #004d66 0%, #00202b 100%)',
            perClick: 350
        }, {
            id: 9,
            name: 'Foso 9',
            cost: 3000000, background: 'radial-gradient(ellipse at bottom, #0f3d24 0%, #06180e 100%)',
            perClick: 500
        }, {
            id: 10,
            name: 'Foso 10',
            cost: 1.2e7, background: 'radial-gradient(ellipse at bottom, #5e0828 0%, #290311 100%)',
            perClick: 1000
        }, {
            id: 11,
            name: 'Foso 11',
            cost: 5e7, background: 'radial-gradient(ellipse at bottom, #005252 0%, #002424 100%)',
            perClick: 1500
        }, {
            id: 12,
            name: 'Foso 12',
            cost: 2e8, background: 'radial-gradient(ellipse at bottom, #2a0054 0%, #110022 100%)',
            perClick: 3000
        }, {
            id: 13,
            name: 'Foso 13',
            cost: 8e8, background: 'radial-gradient(ellipse at bottom, #4a1c00 0%, #1f0c00 100%)',
            perClick: 3500
        
        }, {
            id: 14,
            name: 'Foso 14: Cotton Candy üç≠',
            cost: 3e9, background: 'radial-gradient(ellipse at bottom, #2b404d 0%, #11191f 100%)',
            perClick: 5000
        }, {
            id: 15,
            name: 'Foso 15: Black Diamond Reserve üíéüî•',
            cost: 1e10, background: 'radial-gradient(ellipse at bottom, #000 0%, #222 100%)',
            perClick: 10000
        }, {
            id: 16,
            name: 'Foso 16',
            cost: 4e10, background: 'radial-gradient(ellipse at bottom, #1a1a1a 0%, #000 100%)',
            perClick: 20000
        }, {
            id: 17,
            name: 'Foso 17',
            cost: 1.2e11, background: 'radial-gradient(ellipse at bottom, #6b4f00 0%, #332600 100%)',
            perClick: 35000
        }, {
            id: 18,
            name: 'Foso 18',
            cost: 5e11, background: 'radial-gradient(ellipse at bottom, #004d66 0%, #00202b 100%)',
            perClick: 50000
        }, {
            id: 19,
            name: 'Foso 19',
            cost: 1.8e12, background: 'radial-gradient(ellipse at bottom, #6b0b08 0%, #330504 100%)',
            perClick: 100000
        }, {
            id: 20,
            name: 'Foso 20',
            cost: 7e12, background: 'radial-gradient(ellipse at bottom, #005c30 0%, #002915 100%)',
            perClick: 125000
        }, {
            id: 21,
            name: 'Foso 21',
            cost: 2.5e13, background: 'radial-gradient(ellipse at bottom, #07285c 0%, #031129 100%)',
            perClick: 150000
        }, {
            id: 22,
            name: 'Foso 22',
            cost: 9e13, background: 'radial-gradient(ellipse at bottom, #4d3366 0%, #21152b 100%)',
            perClick: 200000
        }, {
            id: 23,
            name: 'Foso 23',
            cost: 3.5e14, background: 'radial-gradient(ellipse at bottom, #80643d 0%, #332818 100%)',
            perClick: 350000
        }, {
            id: 24,
            name: 'Foso 24',
            cost: 1.2e15, background: 'radial-gradient(ellipse at bottom, #1a1a1a 0%, #000 100%)',
            perClick: 500000
        }, {
            id: 25,
            name: 'Foso 25',
            cost: 5e15, background: 'radial-gradient(ellipse at bottom, #757575 0%, #e0e0e0 100%)',
            perClick: 750000
        }, {
            id: 26,
            name: 'Foso 26',
            cost: 1.8e16, background: 'radial-gradient(ellipse at bottom, #802700 0%, #ff4e00 100%)',
            perClick: 1000000
        }, {
            id: 27,
            name: 'Foso 27',
            cost: 7e16, background: 'radial-gradient(ellipse at bottom, #687680 0%, #cfdef3 100%)',
            perClick: 1250000
        }, {
            id: 28,
            name: 'Foso 28',
            cost: 2.5e17, background: 'radial-gradient(ellipse at bottom, #566b00 0%, #add100 100%)',
            perClick: 1500000
        }, {
            id: 29,
            name: 'Foso 29',
            cost: 9e17, background: 'radial-gradient(ellipse at bottom, #754802 0%, #ed8f03 100%)',
            perClick: 2000000
        }, {
            id: 30,
            name: 'Foso 30',
            cost: 3.5e18, background: 'radial-gradient(ellipse at bottom, #00656b 0%, #00f2ff 100%)',
            perClick: 3000000
        }, {
            id: 31,
            name: 'Foso 31',
            cost: 1.2e19, background: 'radial-gradient(ellipse at bottom, #3d2e1e 0%, #7a5c3c 100%)',
            perClick: 4000000
        }, {
            id: 32,
            name: 'Foso 32',
            cost: 5e19, background: 'radial-gradient(ellipse at bottom, #161f28 0%, #fd746c 100%)',
            perClick: 5000000
        }, {
            id: 33,
            name: 'Foso 33',
            cost: 1.8e20, background: 'radial-gradient(ellipse at bottom, #000000 0%, #222222 100%)',
            perClick: 6000000
        }, {
            id: 34,
            name: 'Foso 34',
            cost: 7e20, background: 'radial-gradient(ellipse at bottom, #606060 0%, #ffffff 100%)',
            perClick: 7000000
        }, {
            id: 35,
            name: 'Foso 35',
            cost: 2.5e21, background: 'radial-gradient(ellipse at bottom, #802136 0%, #ff4b2b 100%)',
            perClick: 8000000
        }, {
            id: 36,
            name: 'Foso 36',
            cost: 9e21, background: 'radial-gradient(ellipse at bottom, #000023 0%, #1cb5e0 100%)',
            perClick: 9000000
        }, {
            id: 37,
            name: 'Foso 37',
            cost: 3.5e22, background: 'radial-gradient(ellipse at bottom, #2d1c0b 0%, #5a3815 100%)',
            perClick: 10000000
        }, {
            id: 38,
            name: 'Foso 38',
            cost: 1.2e23, background: 'radial-gradient(ellipse at bottom, #161f28 0%, #bdc3c7 100%)',
            perClick: 12500000
        }, {
            id: 39,
            name: 'Foso 39',
            cost: 5e23, background: 'radial-gradient(ellipse at bottom, #807e00 0%, #fffc00 100%)',
            perClick: 15000000
        }, {
            id: 40,
            name: 'Foso 40',
            cost: 1.8e24, background: 'radial-gradient(ellipse at bottom, #000000 0%, #000000 100%)',
            perClick: 20000000
        }, {
            id: 41,
            name: 'Foso 41',
            cost: 7e24, background: 'radial-gradient(ellipse at bottom, #451136 0%, #da4453 100%)',
            perClick: 30000000
        }, {
            id: 42,
            name: 'Foso 42',
            cost: 2.5e25, background: 'radial-gradient(ellipse at bottom, #096a7d 0%, #12d8fa 100%)',
            perClick: 40000000
        }, {
            id: 43,
            name: 'Foso 43',
            cost: 9e25, background: 'radial-gradient(ellipse at bottom, #80545b 0%, #ffa8b6 100%)',
            perClick: 50000000
        }, {
            id: 44,
            name: 'Foso 44',
            cost: 3.5e26, background: 'radial-gradient(ellipse at bottom, #1a1a4d 0%, #ff00cc 100%)',
            perClick: 60000000
        }, {
            id: 45,
            name: 'Foso 45',
            cost: 9e26, background: 'radial-gradient(ellipse at bottom, #000000 0%, #ffffff 100%)',
            perClick: 70000000
        }, {
            id: 46, // Corregido el id para que sea 46
            name: 'Foso Pollo üçó',
            cost: Infinity,
            background: 'radial-gradient(ellipse at bottom, #228b22 0%, #006400 100%)',
            perClick: 75000000,
            exclusive: true
        }, {
            id: 47, // Nuevo Foso Yousef
            name: 'Foso Yousef üëë',
            cost: Infinity,
            background: 'radial-gradient(ellipse at bottom, #ffd700 0%, #f0a500 100%)',
            perClick: 100000000,
            exclusive: true
        }, {
            id: 48, name: 'Foso 48: Chronos Key ‚è≥', cost: 2e24, background: 'radial-gradient(ellipse at bottom, #DAA520 0%, #B8860B 100%)', perClick: 8e7
        }, {
            id: 49, name: 'Foso 49: Quantum Foam üî¨', cost: 6e24, background: 'radial-gradient(ellipse at bottom, #48D1CC 0%, #20B2AA 100%)', perClick: 9e7
        }, {
            id: 50, name: 'Foso 50: Solar Flare ‚òÄÔ∏è', cost: 2e25, background: 'radial-gradient(ellipse at bottom, #FF4500 0%, #FFD700 100%)', perClick: 1e8
        }, {
            id: 51, name: 'Foso 51: Dark Matter ‚¨õ', cost: 6e25, background: 'radial-gradient(ellipse at bottom, #2F4F4F 0%, #000000 100%)', perClick: 1.2e8
        }, {
            id: 52, name: 'Foso 52: Plasma Core ‚ö°', cost: 2e26, background: 'radial-gradient(ellipse at bottom, #FF00FF 0%, #00FFFF 100%)', perClick: 1.5e8
        }, {
            id: 53, name: 'Foso 53: Neutron Star üåü', cost: 6e26, background: 'radial-gradient(ellipse at bottom, #E6E6FA 0%, #FFFFFF 100%)', perClick: 1.8e8
        }, {
            id: 54, name: 'Foso 54: White Hole ‚ö™', cost: 2e27, background: 'radial-gradient(ellipse at bottom, #FFFFFF 0%, #F0F8FF 100%)', perClick: 2.2e8
        }, {
            id: 55, name: 'Foso 55: Wormhole üåÄ', cost: 6e27, background: 'radial-gradient(ellipse at bottom, #8A2BE2 0%, #4B0082 100%)', perClick: 2.6e8
        }, {
            id: 56, name: 'Foso 56: Multiverse üåå', cost: 2e28, background: 'radial-gradient(ellipse at bottom, #00008B 0%, #191970 100%)', perClick: 3e8
        }, {
            id: 57, name: 'Foso 57: Hyperdrive üöÄ', cost: 6e28, background: 'radial-gradient(ellipse at bottom, #C0C0C0 0%, #808080 100%)', perClick: 3.5e8
        }, {
            id: 58, name: 'Foso 58: Dyson Sphere ‚òÄÔ∏è', cost: 2e29, background: 'radial-gradient(ellipse at bottom, #FFD700 0%, #FFA500 100%)', perClick: 4e8
        }, {
            id: 59, name: 'Foso 59: Galactic Core üåå', cost: 6e29, background: 'radial-gradient(ellipse at bottom, #4B0082 0%, #000000 100%)', perClick: 4.5e8
        }, {
            id: 60, name: 'Foso 60: The Big Bang üí•', cost: 2e30, background: 'radial-gradient(ellipse at bottom, #FF4500 0%, #FFFF00 100%)', perClick: 5e8
        }, {
            id: 61, name: 'Foso 61: Genesis Block üß±', cost: 6e30, background: 'radial-gradient(ellipse at bottom, #A9A9A9 0%, #696969 100%)', perClick: 6e8
        }, {
            id: 62, name: 'Foso 62: Alpha Centauri ‚≠ê', cost: 2e31, background: 'radial-gradient(ellipse at bottom, #FFD700 0%, #FFA500 100%)', perClick: 7e8
        }, {
            id: 63, name: 'Foso 63: Andromeda üåå', cost: 6e31, background: 'radial-gradient(ellipse at bottom, #483D8B 0%, #000000 100%)', perClick: 8e8
        }, {
            id: 64, name: 'Foso 64: Orion Nebula üî≠', cost: 2e32, background: 'radial-gradient(ellipse at bottom, #DA70D6 0%, #8A2BE2 100%)', perClick: 9e8
        }, {
            id: 65, name: 'Foso 65: Pillars of Creation üèõÔ∏è', cost: 6e32, background: 'radial-gradient(ellipse at bottom, #D2B48C 0%, #8B4513 100%)', perClick: 1e9
        }, {
            id: 66, name: 'Foso 66: Event Horizon üåÄ', cost: 2e33, background: 'radial-gradient(ellipse at bottom, #000000 0%, #4B0082 100%)', perClick: 1.2e9
        }, {
            id: 67, name: 'Foso 67: God Particle ‚ú®', cost: 6e33, background: 'radial-gradient(ellipse at bottom, #FFD700 0%, #FFFFFF 100%)', perClick: 1.5e9
        }, {
            id: 68, name: 'Foso 68: String Theory üéª', cost: 2e34, background: 'radial-gradient(ellipse at bottom, #C0C0C0 0%, #808080 100%)', perClick: 1.8e9
        }, {
            id: 69, name: 'Foso 69: M-Theory üß†', cost: 6e34, background: 'radial-gradient(ellipse at bottom, #00008B 0%, #0000CD 100%)', perClick: 2.2e9
        }, {
            id: 70, name: 'Foso 70: The Matrix üü©', cost: 2e35, background: 'radial-gradient(ellipse at bottom, #00FF00 0%, #006400 100%)', perClick: 2.6e9
        }, {
            id: 71, name: 'Foso 71: The Architect üìê', cost: 6e35, background: 'radial-gradient(ellipse at bottom, #F5F5F5 0%, #A9A9A9 100%)', perClick: 3e9
        }, {
            id: 72, name: 'Foso 72: The Oracle üîÆ', cost: 2e36, background: 'radial-gradient(ellipse at bottom, #9400D3 0%, #4B0082 100%)', perClick: 3.5e9
        }, {
            id: 73, name: 'Foso 73: The One üï∂Ô∏è', cost: 6e36, background: 'radial-gradient(ellipse at bottom, #000000 0%, #006400 100%)', perClick: 4e9
        }, {
            id: 74, name: 'Foso 74: The Source üíª', cost: 2e37, background: 'radial-gradient(ellipse at bottom, #00BFFF 0%, #1E90FF 100%)', perClick: 4.5e9
        }, {
            id: 75, name: 'Foso 75: The Glitch üêû', cost: 6e37, background: 'radial-gradient(ellipse at bottom, #FF0000 0%, #000000 100%)', perClick: 5e9
        }, {
            id: 76, name: 'Foso 76: The Anomaly ‚ùì', cost: 2e38, background: 'radial-gradient(ellipse at bottom, #800080 0%, #FF00FF 100%)', perClick: 6e9
        }, {
            id: 77, name: 'Foso 77: The Prophecy üìú', cost: 6e38, background: 'radial-gradient(ellipse at bottom, #F5DEB3 0%, #D2B48C 100%)', perClick: 7e9
        }, {
            id: 78, name: 'Foso 78: The Chosen One üëë', cost: 2e39, background: 'radial-gradient(ellipse at bottom, #FFD700 0%, #B8860B 100%)', perClick: 8e9
        }, {
            id: 79, name: 'Foso 79: The Resistance ‚úä', cost: 6e39, background: 'radial-gradient(ellipse at bottom, #B22222 0%, #800000 100%)', perClick: 9e9
        }, {
            id: 80, name: 'Foso 80: The Revolution üí•', cost: 2e40, background: 'radial-gradient(ellipse at bottom, #FF4500 0%, #FF0000 100%)', perClick: 1e10
        }, {
            id: 81, name: 'Foso 81: The Aftermath Ïûø', cost: 6e40, background: 'radial-gradient(ellipse at bottom, #808080 0%, #2F4F4F 100%)', perClick: 1.2e10
        }, {
            id: 82, name: 'Foso 82: The New Beginning üå±', cost: 2e41, background: 'radial-gradient(ellipse at bottom, #98FB98 0%, #3CB371 100%)', perClick: 1.5e10
        }, {
            id: 83, name: 'Foso 83: The Utopia üèûÔ∏è', cost: 6e41, background: 'radial-gradient(ellipse at bottom, #87CEEB 0%, #00BFFF 100%)', perClick: 1.8e10
        }, {
            id: 84, name: 'Foso 84: The Dystopia üèôÔ∏è', cost: 2e42, background: 'radial-gradient(ellipse at bottom, #708090 0%, #2F4F4F 100%)', perClick: 2.2e10
        }, {
            id: 85, name: 'Foso 85: The Simulation üíª', cost: 6e42, background: 'radial-gradient(ellipse at bottom, #00FF7F 0%, #008080 100%)', perClick: 2.6e10
        }, {
            id: 86, name: 'Foso 86: The Dream üò¥', cost: 2e43, background: 'radial-gradient(ellipse at bottom, #E6E6FA 0%, #D8BFD8 100%)', perClick: 3e10
        }, {
            id: 87, name: 'Foso 87: The Nightmare üëπ', cost: 6e43, background: 'radial-gradient(ellipse at bottom, #8B0000 0%, #000000 100%)', perClick: 3.5e10
        }, {
            id: 88, name: 'Foso 88: The Awakening üåÖ', cost: 2e44, background: 'radial-gradient(ellipse at bottom, #FFDAB9 0%, #FFA07A 100%)', perClick: 4e10
        }, {
            id: 89, name: 'Foso 89: The Enlightenment üí°', cost: 6e44, background: 'radial-gradient(ellipse at bottom, #FFFFE0 0%, #FFD700 100%)', perClick: 4.5e10
        }, {
            id: 90, name: 'Foso 90: The Ascension üöÄ', cost: 2e45, background: 'radial-gradient(ellipse at bottom, #ADD8E6 0%, #FFFFFF 100%)', perClick: 5e10
        }, {
            id: 91, name: 'Foso 91: The Godhood ‚ú®', cost: 6e45, background: 'radial-gradient(ellipse at bottom, #FFD700 0%, #FFFFFF 100%)', perClick: 6e10
        }, {
            id: 92, name: 'Foso 92: The Beyond üåå', cost: 2e46, background: 'radial-gradient(ellipse at bottom, #000000 0%, #4B0082 100%)', perClick: 7e10
        }, {
            id: 93, name: 'Foso 93: The Omega Point üéØ', cost: 6e46, background: 'radial-gradient(ellipse at bottom, #FF4500 0%, #DC143C 100%)', perClick: 8e10
        }, {
            id: 94, name: 'Foso 94: The Final Foso üèÅ', cost: 2e47, background: 'radial-gradient(ellipse at bottom, #C0C0C0 0%, #FFFFFF 100%)', perClick: 9e10
        }, {
            id: 95, name: 'Foso 95: The Post-Game üéÆ', cost: 6e47, background: 'radial-gradient(ellipse at bottom, #0000CD 0%, #000080 100%)', perClick: 1e11
        }, {
            id: 96, name: 'Foso 96: The Credits üìú', cost: 2e48, background: 'radial-gradient(ellipse at bottom, #2F4F4F 0%, #000000 100%)', perClick: 1.2e11
        }, {
            id: 97, name: 'Foso Dyland üëæ', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #8e44ad 0%, #341f97 100%)', perClick: 1.5e11, exclusive: true
        }, {
            id: 98, name: 'Foso Aziz üëì', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #c0392b 0%, #e74c3c 100%)', perClick: 1.5e11, exclusive: true
        }, {
            id: 99, name: 'Foso Ali ‚ùÑÔ∏è', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #ecf0f1 0%, #bdc3c7 100%)', perClick: 1.5e11, exclusive: true
        }, {
            id: 100, name: 'Foso David Calls üì±', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #3498db 0%, #2980b9 100%)', perClick: 1.5e11, exclusive: true
        }, {
            id: 101, name: 'Foso Esteva ‚ö°', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #f1c40f 0%, #f39c12 100%)', perClick: 1.5e11, exclusive: true
        }, {
            id: 102, name: 'Foso Calfa üí∏', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #27ae60 0%, #2ecc71 100%)', perClick: 1.5e11, exclusive: true
        }, {
            id: 103, name: 'Foso Discord üí¨', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #5865F2 0%, #4e5bf0 100%)', perClick: 10000, exclusive: true
        }
    ];
    // CORREGIDO: El foso 100 se movi√≥ aqu√≠ para evitar conflicto de ID
    // FOSOS.push({ id: 100, name: 'Foso David Calls üì±', cost: Infinity, background: 'radial-gradient(ellipse at bottom, #3498db 0%, #2980b9 100%)', perClick: 1.5e11, exclusive: true });

        const GEM_FOSOS = Array.from({ length: 30 }, (_, i) => ({
            id: i + 1,
            cost: 100 + i * (i > 15 ? 100 : 20) + (i > 25 ? 500 : 0), // Coste incremental en gemas
            bonus: 0.05 // +5% de bonus a las ganancias por cada uno
        }));

        const PRESTIGE_UPGRADES = {
            all_earnings: { name: "Ganancias Totales", icon: "üí∞", cost: 1, maxLevel: 20, bonus: 0.1, description: "Aumenta todas las ganancias de Œ£C en un 10% por nivel." },
            afk_earnings: { name: "Ganancias AFK", icon: "‚è∞", cost: 1, maxLevel: 10, bonus: 0.2, description: "Aumenta las ganancias AFK en un 20% por nivel." },
            crit_chance: { name: "Prob. Cr√≠tico", icon: "üí•", cost: 2, maxLevel: 10, bonus: 0.005, description: "Aumenta la probabilidad de cr√≠tico en 0.5% por nivel." },
            gem_chance: { name: "Suerte de Gema", icon: "üíé", cost: 3, maxLevel: 5, bonus: 0.001, description: "Aumenta la probabilidad de encontrar gemas en 0.1% por nivel." },
        };

        const BASE_LIQUIDS = {
            'glycerin': { name: 'Glicerina', icon: 'üíß' },
            'strawberry': { name: 'Aroma Fresa', icon: 'üçì' },
            'mint': { name: 'Aroma Menta', icon: 'üåø' },
            'banana': { name: 'Aroma Pl√°tano', icon: 'üçå' },
        };

        const CRAFTING_RECIPES = [
            { ingredients: ['strawberry', 'mint'].sort(), result: { id: 'fresamint', name: 'Fosolado de Fresa', bonus: { type: 'multiplier', value: 1.25 }, duration: 300 } }, // +25% sig for 5 mins
            { ingredients: ['strawberry', 'banana'].sort(), result: { id: 'fresabanana', name: 'Batido Tropical', bonus: { type: 'multiplier', value: 1.5 }, duration: 180 } }, // +50% sig for 3 mins
            { ingredients: ['mint', 'mint'].sort(), result: { id: 'doblementa', name: 'Explosi√≥n Glacial', bonus: { type: 'crit_chance', value: 0.10 }, duration: 120 } }, // +10% crit chance for 2 mins
            { ingredients: ['banana', 'banana'].sort(), result: { id: 'potassium_power', name: 'Doble Potasio', bonus: { type: 'afk_multiplier', value: 1.5 }, duration: 600 } }, // +50% AFK earnings for 10 mins
            { ingredients: ['strawberry', 'strawberry'].sort(), result: { id: 'berry_blast', name: 'Explosi√≥n de Bayas', bonus: { type: 'chest_chance', value: 0.05 }, duration: 300 } }, // +5% chest find chance for 5 mins
            { ingredients: ['glycerin', 'glycerin'].sort(), result: { id: 'nube', name: 'Nube Densa', bonus: { type: 'no_battery_drain' }, duration: 60 } }, // No battery drain for 1 min
            { ingredients: ['glycerin', 'strawberry'].sort(), result: { id: 'sweet_cloud', name: 'Nube Dulce', bonus: { type: 'multiplier', value: 1.1 }, duration: 900 } }, // +10% sig for 15 mins
            { ingredients: ['glycerin', 'mint'].sort(), result: { id: 'cool_cloud', name: 'Nube Fresca', bonus: { type: 'crit_chance', value: 0.02 }, duration: 900 } }, // +2% crit chance for 15 mins
            { ingredients: ['glycerin', 'banana'].sort(), result: { id: 'mellow_cloud', name: 'Nube de Ensue√±o', bonus: { type: 'afk_multiplier', value: 1.1 }, duration: 1800 } }, // +10% AFK for 30 mins
        ];

        const SHOP_FLAVORS = {
            'mint_burst': { name: 'R√°faga de Menta', cost: 500000, currency: 'sig', bonus: { type: 'crit_chance', value: 0.05 }, duration: 120 },
            'strawberry_boost': { name: 'Impulso de Fresa', cost: 2000000, currency: 'sig', bonus: { type: 'multiplier', value: 1.5 }, duration: 300 },
            'gem_essence': { name: 'Esencia de Gema', cost: 50, currency: 'gems', bonus: { type: 'gem_chance', value: 0.01 }, duration: 600 },
            'tycoon_elixir': { name: 'Elixir del Magnate', cost: 150, currency: 'gems', bonus: { type: 'multiplier', value: 2.0 }, duration: 900 },
            'battery_chew': { name: 'Chicle de Bater√≠a', cost: 10000000, currency: 'sig', bonus: { type: 'battery_saver', value: 0.5 }, duration: 600 }, // 50% less drain
            'repair_tonic': { name: 'T√≥nico de Reparaci√≥n', cost: 25000000, currency: 'sig', bonus: { type: 'instant_repair', value: 25 }, duration: 0 }, // Instant effect
            'chest_magnet': { name: 'Im√°n de Cofres', cost: 75, currency: 'gems', bonus: { type: 'chest_chance', value: 0.05 }, duration: 600 }, // +5% chest chance
            'time_potion': { name: 'Poci√≥n del Tiempo', cost: 200, currency: 'gems', bonus: { type: 'instant_afk', value: 3600 }, duration: 0 }, // 1 hour of AFK
        };


        const REBIRTH_LEVELS = [
            { cost: 1000, requiredFosos: 3, bonus: 0.05 }, // +5%
            { cost: 50000, requiredFosos: 6, bonus: 0.10 }, // +10%
            { cost: 1e6, requiredFosos: 9, bonus: 0.15 }, // +15%
            { cost: 2.5e7, requiredFosos: 12, bonus: 0.20 },
            { cost: 5e8, requiredFosos: 15, bonus: 0.25 },
            { cost: 1e10, requiredFosos: 20, bonus: 0.30 },
            { cost: 5e11, requiredFosos: 25, bonus: 0.35 },
            { cost: 1e13, requiredFosos: 30, bonus: 0.40 },
            { cost: 5e14, requiredFosos: 35, bonus: 0.45 },
            { cost: 1e16, requiredFosos: 40, bonus: 0.50 },
        ];

        const DAILY_REWARDS = [
            { type: 'sig', value: 100, label: '100 Œ£C' },
            { type: 'sig', value: 250, label: '250 Œ£C' },
            { type: 'sig', value: 500, label: '500 Œ£C' },
            { type: 'multiplier', value: 2, duration: 300, label: 'x2 Clics (5 min)' },
            { type: 'sig', value: 1000, label: '1000 Œ£C' },
            { type: 'sig', value: 2000, label: '2000 Œ£C' },
            { type: 'combo', value: { sig: 5000, multiplier: 2, duration: 600 }, label: '5000 Œ£C + x2 Clics (10 min)' }
        ];

        const AUTOCLICKER_UPGRADES = [
            { cost: 500, cps: 1 },
            { cost: 2000, cps: 2 },
            { cost: 10000, cps: 5 },
            { cost: 50000, cps: 10 },
            { cost: 250000, cps: 25 },
        ];

        const BATTERY_UPGRADES = [
            { cost: 200, capacity: 120 },
            { cost: 800, capacity: 150 },
            { cost: 3000, capacity: 200 },
            { cost: 15000, capacity: 250 },
            { cost: 75000, capacity: 300 },
        ];

        const CRITICAL_UPGRADES = [
            { cost: 25000, chance: 0.01, multiplier: 10 }, // 1% chance for x10
            { cost: 100000, chance: 0.02, multiplier: 12 }, // 2% chance for x12
            { cost: 500000, chance: 0.03, multiplier: 15 }, // 3% chance for x15
            { cost: 2500000, chance: 0.04, multiplier: 20 }, // 4% chance for x20
            { cost: 10000000, chance: 0.05, multiplier: 25 }, // 5% chance for x25
        ];

        const EFFICIENCY_UPGRADES = [
            { cost: 1000, reduction: 0.05 }, // 5% less drain
            { cost: 5000, reduction: 0.10 },
            { cost: 20000, reduction: 0.15 },
            { cost: 100000, reduction: 0.20 },
            { cost: 500000, reduction: 0.25 },
        ];

        const PASSIVE_RECHARGE_UPGRADES = [
            { cost: 10000, amount: 0.1 }, // 0.1 por segundo (muy lento)
            { cost: 50000, amount: 0.2 },
            { cost: 250000, amount: 0.4 },
            { cost: 1000000, amount: 0.8 },
        ];

        const COMBO_UPGRADES = [
            { cost: 25000, time: 500 }, // +0.5s
            { cost: 125000, time: 1000 }, // +1s
            { cost: 600000, time: 1500 }, // +1.5s
            { cost: 3000000, time: 2000 }, // +2s
        ];

        const LIQUID_LUCK_UPGRADES = [
            { cost: 100000, chance: 0.01 }, // +1%
            { cost: 500000, chance: 0.02 },
            { cost: 2500000, chance: 0.03 },
        ];

        const AFK_UPGRADES = [
            { cost: 1000, sph: 100 },
            { cost: 5000, sph: 500 },
            { cost: 25000, sph: 2500 },
            { cost: 100000, sph: 10000 },
            { cost: 500000, sph: 50000 },
        ];

        const CONFIG = {
            storageKey: 'foso_tycoon_state_v2', // Version bump for new features
            autosaveMs: 10000,
            uiTickMs: 100,
            baseBatteryDrainPerClick: 1,
            overheatCps: 15,
            mataReward: 50,
            chestDropChance: 0.01, // 1% chance to drop a chest on click
            eventChance: 0.2, // 20% chance per check
            healthDegradationPerClick: 0.05, // How much health is lost per click
            comboTimeout: 2000, // 2 seconds to continue combo
            comboMax: 10, // Max combo multiplier
            marketUpdateInterval: 5 * 60 * 1000, // 5 minutes
            mataCooldownSec: 300,
            onEquipRefill: 20,
            rechargeBaseSec: 60,
            eventInterval: 2 * 60 * 1000, // Check for event every 2 minutes
        };
        CONFIG.overheatCps = 13; // L√≠mite de clics por segundo

        const ACHIEVEMENTS = {
            CLICK_1: { id: 'CLICK_1', name: "Iniciado", description: "Haz 1 clic.", icon: "üëÜ", reward: "+1% por clic (permanente)" },
            CLICK_100: { id: 'CLICK_100', name: "Clickeador", description: "Haz 100 clics.", icon: "üñ±Ô∏è", reward: "+2% por clic (permanente)" },
            CLICK_1K: { id: 'CLICK_1K', name: "Dedos √Ågiles", description: "Haz 1,000 clics.", icon: "ü§å", reward: "+3% por clic (permanente)" },
            CLICK_10K: { id: 'CLICK_10K', name: "Profesional del Clic", description: "Haz 10,000 clics.", icon: "üèÜ", reward: "+5% por clic (permanente)" },
            CLICK_100K: { id: 'CLICK_100K', name: "Deidad del Clic", description: "Haz 100,000 clics.", icon: "üôè", reward: "+10% por clic (permanente)" },

            SIG_1K: { id: 'SIG_1K', name: "Ahorrador", description: "Acumula 1,000 Œ£C en total.", icon: "üí∞", reward: "Gana 500 Œ£C extra" },
            SIG_10K: { id: 'SIG_10K', name: "Peque√±o Inversor", description: "Acumula 10,000 Œ£C en total.", icon: "üí∏", reward: "Gana 2,500 Œ£C extra" },
            SIG_100K: { id: 'SIG_100K', name: "Pudiente", description: "Acumula 100,000 Œ£C en total.", icon: "üíµ", reward: "Gana 5,000 Œ£C extra" },
            SIG_1M: { id: 'SIG_1M', name: "Millonario", description: "Acumula 1,000,000 Œ£C en total.", icon: "üíé", reward: "+5% a las ganancias por clic" },
            SIG_1B: { id: 'SIG_1B', name: "Billonario", description: "Acumula 1,000,000,000 Œ£C en total.", icon: "üåå", reward: "+10% a las ganancias por clic" },

            FOSO_5: { id: 'FOSO_5', name: "Coleccionista", description: "Posee 5 fosos diferentes.", icon: "üìö", reward: "+10% por clic (permanente)" },
            FOSO_10: { id: 'FOSO_10', name: "Entusiasta", description: "Posee 10 fosos diferentes.", icon: "üìñ", reward: "+15% por clic (permanente)" },
            FOSO_15: { id: 'FOSO_15', name: "Magnate de Fosos", description: "Posee los 15 fosos.", icon: "üëë", reward: "+20% por clic (permanente)" },
            FOSO_ALL: { id: 'FOSO_ALL', name: "Leyenda del Foso", description: "Posee todos los fosos de Œ£C.", icon: "üèÜ", reward: "+50% por clic (permanente)" },

            REBIRTH_1: { id: 'REBIRTH_1', name: "Renacido", description: "Realiza tu primer Rebirth.", icon: "üîÑ", reward: "Bonus de Rebirth +10% extra" },
            REBIRTH_3: { id: 'REBIRTH_3', name: "Iluminado", description: "Alcanza 3 Rebirths.", icon: "‚ú®", reward: "Bonus de Rebirth +20% extra" },
            REBIRTH_5: { id: 'REBIRTH_5', name: "Ascendido", description: "Alcanza 5 Rebirths.", icon: "üåü", reward: "Bonus de Rebirth +30% extra" },

            WHEEL_1: { id: 'WHEEL_1', name: "Afortunado", description: "Gira la ruleta por primera vez.", icon: "üçÄ", reward: "1 Giro Gratis" },
            WHEEL_10: { id: 'WHEEL_10', name: "Lud√≥pata", description: "Gira la ruleta 10 veces.", icon: "üé°", reward: "Las recompensas de la ruleta son un 10% mejores" },

            MATA_1: { id: 'MATA_1', name: "Impaciente", description: "Usa Mata Foso por primera vez.", icon: "üí•", reward: "Mata Foso da 100 Œ£C extra" },
            MATA_10: { id: 'MATA_10', name: "Destructor", description: "Usa Mata Foso 10 veces.", icon: "üí£", reward: "El cooldown de Mata Foso se reduce en 1 minuto" },

            AFK_1: { id: 'AFK_1', name: "Ingresos Pasivos", description: "Mejora el AFK al nivel 1.", icon: "üí§", reward: "+5% de ganancias AFK" },
            AFK_MAX: { id: 'AFK_MAX', name: "Magnate Durmiente", description: "Lleva las mejoras de AFK al m√°ximo.", icon: "üò¥", reward: "+25% de ganancias AFK" },

            MAINTAIN_1: { id: 'MAINTAIN_1', name: "Manitas", description: "Realiza un mantenimiento con √©xito.", icon: "üîß", reward: "El mantenimiento da un 10% m√°s de Œ£C." },
            CRAFT_1: { id: 'CRAFT_1', name: "Alquimista", description: "Crea tu primer sabor.", icon: "üß™", reward: "Los sabores crafteados duran un 10% m√°s." },
            EVENT_1: { id: 'EVENT_1', name: "Afortunado", description: "Participa en un evento aleatorio.", icon: "üéâ", reward: "Los eventos aleatorios son un 5% m√°s frecuentes." },
            
            CLICK_1M: { id: 'CLICK_1M', name: "Clicker Divino", description: "Haz 1,000,000 de clics.", icon: "üòá", reward: "+15% por clic (permanente)" },
            SIG_1T: { id: 'SIG_1T', name: "Trillonario", description: "Acumula 1T (1,000,000,000,000) Œ£C en total.", icon: "ü™ê", reward: "+15% a las ganancias por clic" },
            PET_OWNER: { id: 'PET_OWNER', name: "Amigo Animal", description: "Adopta tu primera mascota.", icon: "üêæ", reward: "Las mascotas son un 5% m√°s efectivas." },
            MISSION_MASTER: { id: 'MISSION_MASTER', name: "Misionero", description: "Completa 10 misiones diarias.", icon: "üìú", reward: "Las recompensas de misi√≥n son un 10% mejores." },
            CHEST_HUNTER: { id: 'CHEST_HUNTER', name: "Cazatesoros", description: "Abre 5 cofres.", icon: "üì¶", reward: "Aumenta la probabilidad de encontrar cofres." },
        };

        const ACHIEVEMENT_LOGIC = {
            CLICK_1: { condition: s => s.totalClicks >= 1, apply: s => s.perClickMult *= 1.01 },
            CLICK_100: { condition: s => s.totalClicks >= 100, apply: s => s.perClickMult *= 1.02 },
            CLICK_1K: { condition: s => s.totalClicks >= 1000, apply: s => s.perClickMult *= 1.03 },
            CLICK_10K: { condition: s => s.totalClicks >= 10000, apply: s => s.perClickMult *= 1.05 },
            CLICK_100K: { condition: s => s.totalClicks >= 100000, apply: s => s.perClickMult *= 1.10 },
            SIG_1K: { condition: s => s.totalSigEarned >= 1000, apply: s => { s.sig += 500; showToast("+500 Œ£C!", "success"); } },SIG_10K: { condition: s => s.totalSigEarned >= 10000, apply: s => { s.sig += 2500; showToast("+2,500 Œ£C!", "success"); } },
            SIG_100K: { condition: s => s.totalSigEarned >= 100000, apply: s => s.sig += 5000 },
            SIG_1M: { condition: s => s.totalSigEarned >= 1000000, apply: s => s.perClickMult *= 1.05 },
            SIG_1B: { condition: s => s.totalSigEarned >= 1000000000, apply: s => s.perClickMult *= 1.10 },
            FOSO_5: { condition: s => s.fososOwned.length >= 5, apply: s => s.perClickMult *= 1.10 },
            FOSO_10: { condition: s => s.fososOwned.length >= 10, apply: s => s.perClickMult *= 1.15 },
            FOSO_15: { condition: s => s.fososOwned.length >= 15, apply: s => s.perClickMult *= 1.20 },
            FOSO_ALL: { condition: s => s.fososOwned.length >= FOSOS.length, apply: s => s.perClickMult *= 1.50 },
            REBIRTH_1: { condition: s => s.rebirths >= 1, apply: s => s.rebirthBonus += 0.1 },
            REBIRTH_3: { condition: s => s.rebirths >= 3, apply: s => s.rebirthBonus += 0.2 },
            REBIRTH_5: { condition: s => s.rebirths >= 5, apply: s => s.rebirthBonus += 0.3 },
            WHEEL_1: { condition: s => s.wheelSpins >= 1, apply: s => s.wheelLastSpin = 0 },
            WHEEL_10: { condition: s => s.wheelSpins >= 10, apply: s => s.wheelRewardMultiplier = 1.1 },
            MATA_1: { condition: s => s.mataUses >= 1, apply: s => CONFIG.mataReward += 100 },
            MATA_10: { condition: s => s.mataUses >= 10, apply: s => CONFIG.mataCooldownSec -= 60 },
            AFK_1: { condition: s => (s.upgradeLevels.afk || 0) >= 1, apply: s => s.afkMultiplier = 1.05 },
            AFK_MAX: { condition: s => (s.upgradeLevels.afk || 0) >= AFK_UPGRADES.length, apply: s => s.afkMultiplier = 1.25 },
            MAINTAIN_1: { condition: s => (s.maintenancesDone || 0) >= 1, apply: s => s.maintenanceRewardBonus = 1.1 },
            CRAFT_1: { condition: s => (s.craftsDone || 0) >= 1, apply: s => s.craftedFlavorDurationBonus = 1.1 },
            EVENT_1: { condition: s => (s.eventsParticipated || 0) >= 1, apply: s => CONFIG.eventChance *= 1.05 },
            CLICK_1M: { condition: s => s.totalClicks >= 1000000, apply: s => s.perClickMult *= 1.15 },
            SIG_1T: { condition: s => s.totalSigEarned >= 1e12, apply: s => s.perClickMult *= 1.15 },
            PET_OWNER: { condition: s => s.unlockedPets.length > 0, apply: s => s.petBonusMultiplier = 1.05 },
            MISSION_MASTER: { condition: s => (s.missionsCompleted || 0) >= 10, apply: s => s.missionRewardBonus = 1.1 },
            CHEST_HUNTER: { condition: s => (s.chestsOpened || 0) >= 5, apply: s => CONFIG.chestDropChance *= 1.2 },
        };

        const MISSION_TYPES = [
            { id: 'click', description: (target) => `Haz ${target} clics.`, reward: (target) => target * 10, unit: 'clics' },
            { id: 'earn', description: (target) => `Gana ${formatNum(target)} Œ£C.`, reward: (target) => target / 2, unit: 'Œ£C' },
            { id: 'spin', description: (target) => `Gira la ruleta ${target} veces.`, reward: (target) => target * 5000, unit: 'giros' },
            { id: 'buy_foso', description: (target) => `Compra ${target} fosos.`, reward: (target) => target * 10000, unit: 'fosos' },
        ];

        const WHEEL_REWARDS = [
            { label: "1K Œ£C", reward: (s) => { const amount = 1000 * (s.wheelRewardMultiplier || 1); s.sig += amount; showToast(`+${formatNum(amount)} Œ£C!`, "success"); } },
            { label: "5K Œ£C", reward: (s) => { const amount = 5000 * (s.wheelRewardMultiplier || 1); s.sig += amount; showToast(`+${formatNum(amount)} Œ£C!`, "success"); } },
            { label: "x2 Clics (1min)", reward: (s) => {
                s.perClickMult *= 2;
                showToast("x2 Clics por 1 minuto!", "success");
                setTimeout(() => {
                    s.perClickMult /= 2;
                    showToast("x2 Clics ha terminado.", "info");
                }, 60000);
            }},
            { label: "Bater√≠a Max", reward: (s) => { s.battery = s.maxBattery; showToast("Bater√≠a Recargada!", "success"); } },
            { label: "10K Œ£C", reward: (s) => { const amount = 10000 * (s.wheelRewardMultiplier || 1); s.sig += amount; showToast(`+${formatNum(amount)} Œ£C!`, "success"); } },
            { label: "Nada", reward: (s) => { showToast("¬°M√°s suerte la pr√≥xima vez!", "info"); } },
            { label: "25K Œ£C", reward: (s) => { const amount = 25000 * (s.wheelRewardMultiplier || 1); s.sig += amount; showToast(`+${formatNum(amount)} Œ£C!`, "success"); } },
            { label: "x3 Clics (30s)", reward: (s) => {
                s.perClickMult *= 3;
                showToast("x3 Clics por 30 segundos!", "success");
                setTimeout(() => { // CORREGIDO: Usar s.perClickMult
                    s.perClickMult /= 3;
                    showToast("x3 Clics ha terminado.", "info");
                }, 30000);
            }},
            { label: "Foso Yousef üëë", reward: (s) => { // CORREGIDO: El √≠ndice era incorrecto
                const fosoIndex = 46; // El √≠ndice del Foso Yousef
                if (s.fososOwned.includes(fosoIndex)) {
                    const consolationPrize = 500000;
                    s.sig += consolationPrize;
                    showToast(`Ya tienes el Foso Yousef. ¬°Toma ${formatNum(consolationPrize)} Œ£C en su lugar!`, "info");
                } else {
                    s.fososOwned.push(fosoIndex);
                    showToast("¬°Has ganado el exclusivo Foso Yousef üëë!", "success", 5000);
                }
                render(); // Actualizar la tienda para mostrarlo
            }},
        ];

        const RANKS = [
            { clicks: 0, key: 'rank_0' },
            { clicks: 100, key: 'rank_1' },
            { clicks: 1000, key: 'rank_2' },
            { clicks: 10000, key: 'rank_3' },
            { clicks: 100000, key: 'rank_4' },
            { clicks: 1000000, key: 'rank_5' },
        ];

        const RANDOM_EVENTS = [
            { id: 'frenzy', name_key: 'event_frenzy', duration: 30000 },
            { id: 'infinite_battery', name_key: 'event_infinite_battery', duration: 45000 },
            { id: 'black_market', name_key: 'event_black_market', duration: 60000, onStart: () => openBlackMarket(), onEnd: () => blackMarketModal.classList.add('hidden') },
            { id: 'gem_rain', name_key: 'event_gem_rain', duration: 20000 },
            { id: 'free_repair', name_key: 'event_free_repair', duration: 1000, onStart: (s) => { s.fosoConditions[s.activeFosoIndex] = 100; showToast(LANGUAGES[s.lang || 'es']['event_free_repair'], 'success'); } },
            { id: 'combo_madness', name_key: 'event_combo_madness', duration: 30000 },
        ];

        const PETS = {
            dog: {
                id: 'dog', name: 'Perro Leal', description: 'Multiplica las ganancias por clic x2.',
                cost: 5000, multiplier: 2, icon: 'üê∂'
            },
            cat: {
                id: 'cat', name: 'Gato C√≥smico', description: 'Multiplica las ganancias por clic x3.',
                cost: 25000, multiplier: 3, icon: 'üê±'
            }
        };


        let state = {
            sig: 0,
            totalClicks: 0,
            totalSigEarned: 0,
            activeFosoIndex: 0,
            fososOwned: [0],
            gemFososOwned: [],
            fosoConditions: {},
            exclusiveMoney: 0,
            achievements: {},
            gems: 0,
            unlockedPets: [],
            equippedPet: null,
            chests: [],
            wheelLastSpin: 0,
            dailyMissions: [],
            lastMissionCheck: 0,
            wheelSpins: 0,
            mataUses: 0,
            wheelRewardMultiplier: 1,
            afkMultiplier: 1,
            battery: 100,
            maxBattery: 100,
            burned: false,
            powerOn: true,
            mataCooldownUntil: 0,
            autoClickerLevel: 0,
            autoClickExpiresAt: 0,
            dailyDay: 0,
            rebirths: 0,
            rebirthBonus: 0, // Bonificaci√≥n porcentual aditiva, 0.05 = +5%
            prestigeLevel: 0,
            prestigePoints: 0,
            prestigeUpgrades: {},
            liquidInventory: {},
            activeCraftedFlavor: null,
            liquidDropChance: 0.02, // 2% chance to drop a liquid on click
            lastDailyClaim: null,
            afkLevel: 0,
            afkLastClaim: Date.now(),
            afkEarnings: 0,
            lang: 'es',
            powersOwned: {},
            overheatBonus: 0,
            batteryEfficiencyLevel: 0,
            rechargeSpeedLevel: 0,
            perClickMult: 1,
            passivePerSec: 0,
            tutorialCompleted: true,
            tutorialStep: 0,
            upgradeLevels: {
                battery: 0,
                autoclicker: 0,
                afk: 0,
                critical: 0,
                efficiency: 0,
                combo: 0,
                liquid_luck: 0,
                passive_recharge: 0
            },
            combo: {
                count: 0,
                expires: 0,
            },
            market: {
                nextUpdate: 0,
                priceMultipliers: {}
            },
            activeEvent: null,
            blackMarketOffers: [],
            lastEventCheck: 0,
            maintenancesDone: 0,
            craftsDone: 0,
            eventsParticipated: 0,
            petBonusMultiplier: 1,
            missionsCompleted: 0,
            chestsOpened: 0,
            settings: { smokeEnabled: true, clickNumbersEnabled: true, musicVolume: 0.2, sfxVolume: 0.5 },
        };


        // Audio elements
        let bgMusic, clickSfx, buySfx, successSfx, errorSfx, chestOpenSfx;
        let musicStarted = false;

        // DOM refs
        const sigTotalEl = document.getElementById('sigTotal');
        const perClickEl = document.getElementById('perClick');
        const totalClicksEl = document.getElementById('totalClicks');
        const exclusiveMoneyTotalEl = document.getElementById('exclusiveMoneyTotal');
        const shopSigma = document.getElementById('shopSigma');
        const rankTitleEl = document.getElementById('rankTitle');
        const shopGems = document.getElementById('shopGems');
        const btnMata = document.getElementById('btnMata');
        const mataLabel = document.getElementById('mataLabel');
        const centralFoso = document.getElementById('centralFoso');
        const vaperWrap = document.getElementById('vaperWrap');
        const btnChargeToggle = document.getElementById('btnChargeToggle');
        const chargeLabel = document.getElementById('chargeLabel');
        const batteryText = document.getElementById('batteryText');
        const shopGrid = document.getElementById('shopGrid');
        const btnShop = document.getElementById('btnShop');
        const shopModal = document.getElementById('shopModal');
        const rebirthModal = document.getElementById('rebirthModal');
        const btnRebirth = document.getElementById("btnRebirth");
        const btnUpgrades = document.getElementById("btnUpgrades");
        const upgradesModal = document.getElementById("upgradesModal");
        const dotMenu = document.getElementById('dotMenu');
        const menuToggle = document.getElementById('menuToggle');
        const rightMenu = document.getElementById('rightMenu');
        const btnPrestige = document.getElementById("btnPrestige");
        const prestigeModal = document.getElementById("prestigeModal");
        const btnCrafting = document.getElementById("btnCrafting"); // No hay modal para esto
        const btnExchange = document.getElementById("btnExchange");
        const btnPromo = document.getElementById("btnPromo");
        const promoModal = document.getElementById("promoModal");
        const craftingModal = document.getElementById("craftingModal"); // No hay modal para esto
        const btnConfig = document.getElementById('btnConfig');
        const configModal = document.getElementById('configModal');
        const langSelect = document.getElementById('langSelect');
        const chkSmoke = document.getElementById('chkSmoke');
        const chkClickNumbers = document.getElementById('chkClickNumbers');
        const btnManualSave = document.getElementById('btnManualSave');
        const btnRepeatTutorial = document.getElementById('btnRepeatTutorial');
        const btnReset = document.getElementById('btnReset');
        const centralScreen = document.getElementById('centralScreen');
        const dailyStreakEl = document.getElementById('dailyStreak');
        const streakHint = document.getElementById('streakHint');
        const btnDaily = document.getElementById('btnDaily');
        const dailyModal = document.getElementById('dailyModal');
        const closeDaily = document.getElementById('closeDaily');
        const btnClaimDaily = document.getElementById('btnClaimDaily');
        const dailyCarousel = document.getElementById('carousel');
        const dotDaily = document.getElementById('dotDaily');
        const btnPowers = document.getElementById('btnPower');
        const btnAFK = document.getElementById('btnAFK');
        const afkModal = document.getElementById('afkModal');
        const btnUpgradeAFK = document.getElementById('btnUpgradeAFK');
        const btnClaimAFK = document.getElementById('btnClaimAFK');
        const afkInfo = document.getElementById('afkInfo');
        const dotAFK = document.getElementById('dotAFK');
        const btnPower = document.getElementById('btnPower');
        const btnAchievements = document.getElementById('btnAchievements');
        const achievementsModal = document.getElementById('achievementsModal');
        const achievementsGrid = document.getElementById('achievementsGrid');
        const dotAchievements = document.getElementById('dotAchievements');
        const btnWheel = document.getElementById('btnWheel');
        const wheelModal = document.getElementById('wheelModal');
        const wheel = document.querySelector('.wheel');
        const btnSpinWheel = document.getElementById('btnSpinWheel');
        const wheelCooldownText = document.getElementById('wheelCooldownText');
        const wheelBtnLabel = document.getElementById('wheelBtnLabel');
        const dotWheel = document.getElementById('dotWheel');
        const btnMissions = document.getElementById('btnMissions');
        const missionsModal = document.getElementById('missionsModal');
        const missionsGrid = document.getElementById('missionsGrid');
        const dotMissions = document.getElementById('dotMissions');
        const btnChests = document.getElementById('btnChests');
        const chestsModal = document.getElementById('chestsModal');
        const btnCustomize = document.getElementById('btnCustomize');
        const customizeModal = document.getElementById('customizeModal');
        const dotCustomize = document.getElementById('dotCustomize');
        const dotChests = document.getElementById('dotChests');
        const comboContainer = document.getElementById('comboContainer');
        const comboText = document.getElementById('comboText');
        const comboBar = document.getElementById('comboBar');
        const marketStatusEl = document.getElementById('marketStatus');
        const maintenanceBarFill = document.getElementById('maintenanceBarFill');
        const btnMaintenance = document.getElementById('btnMaintenance');
        const maintenanceModal = document.getElementById('maintenanceModal');
        const maintenanceGameArea = document.getElementById('maintenanceGameArea');
        const maintenanceInstructions = document.getElementById('maintenanceInstructions');
        const maintenanceRewardText = document.getElementById('maintenanceRewardText');
        const gemsTotalEl = document.getElementById('gemsTotal');
        const eventBanner = document.getElementById('eventBanner');
        const eventName = document.getElementById('eventName');
        const eventTimer = document.getElementById('eventTimer');
        const blackMarketModal = document.getElementById('blackMarketModal');
        const promoInput = document.getElementById('promoInput');
        const blackMarketGrid = document.getElementById('blackMarketGrid');
        const exchangeModal = document.getElementById('exchangeModal');
        const exchangeInput = document.getElementById('exchangeInput');
        const exchangeCost = document.getElementById('exchangeCost');
        const exchangeBtn = document.getElementById('exchangeBtn');
        const musicVolumeSlider = document.getElementById('musicVolume');
        const sfxVolumeSlider = document.getElementById('sfxVolume');

        let powersModal = document.getElementById('powersModal');
        let isCharging = false;
        let anyNotification = false;
        let chargeInterval = null;
        let autoClickTimer = null;
        let canClaimDaily = false;
        let passiveRechargeTimer = null;
        let nextRewardInterval = null;
        let comboDecayTimer = null;
        let marketUpdateInterval = null;
        let wheelSpinning = false;
        let maintenanceSequence = [];
        let eventInterval = null;
        let currentMaintenanceStep = 0;
        let tutorialHighlights = [];
        
        function updateMenuNotification() {
            anyNotification = !dotDaily.classList.contains('hidden') || !dotMissions.classList.contains('hidden') || !dotChests.classList.contains('hidden') || !dotAFK.classList.contains('hidden') || !dotPets.classList.contains('hidden');
            dotMenu.classList.toggle('hidden', !anyNotification);
        }

        function translateUI() {
            const lang = state.lang || 'es';
            const translations = LANGUAGES[lang];
            if (!translations) return;

            document.querySelectorAll('[data-lang]').forEach(el => {
                const key = el.dataset.lang;
                if (translations[key]) {
                    el.textContent = translations[key];
                }
            });

            document.querySelectorAll('[data-lang-placeholder]').forEach(el => {
                const key = el.dataset.langPlaceholder;
                if (translations[key]) {
                    el.placeholder = translations[key];
                }
            });

        }

        function generateDailyMissions() {
            state.dailyMissions = [];
            const availableMissions = [...MISSION_TYPES];
            for (let i = 0; i < 3; i++) {
                if (availableMissions.length === 0) break;

                const missionIndex = Math.floor(Math.random() * availableMissions.length);
                const missionType = availableMissions.splice(missionIndex, 1)[0];
                
                let target;
                if (missionType.id === 'click') target = 100 + Math.floor(Math.random() * 900); // 100-1000
                else if (missionType.id === 'earn') target = 1000 + Math.floor(Math.random() * 9000); // 1000-10000
                else if (missionType.id === 'spin') target = 1 + Math.floor(Math.random() * 2); // 1-3
                else if (missionType.id === 'buy_foso') target = 1 + Math.floor(Math.random() * 2); // 1-3

                state.dailyMissions.push({
                    id: missionType.id,
                    description: missionType.description(target),
                    target: target,
                    progress: 0,
                    reward: missionType.reward(target),
                    claimed: false
                });
            }
            state.lastMissionCheck = new Date().setHours(0, 0, 0, 0);
        }

        function checkMissionReset() {
            const today = new Date().setHours(0, 0, 0, 0);
            if (!state.lastMissionCheck || state.lastMissionCheck < today) {
                generateDailyMissions();
            }
        }

        function renderMissions() {
            missionsGrid.innerHTML = '';
            let canClaim = false;
            state.dailyMissions.forEach((mission, index) => {
                const card = document.createElement('div');
                card.className = 'mission-card';
                const progressPercent = Math.min(100, (mission.progress / mission.target) * 100);

                card.innerHTML = `
                    <div class="mission-info">
                        <h4>${mission.description}</h4>
                        <div class="mission-progress-bar">
                            <div class="mission-progress-fill" style="width: ${progressPercent}%;"></div>
                        </div>
                        <p class="metaTiny">Progreso: ${mission.progress} / ${mission.target}</p>
                        <p class="metaTiny">Recompensa: ${formatNum(mission.reward)} Œ£C</p>
                    </div>
                    <button class="mata-btn claim-mission-btn" data-lang="${mission.claimed ? 'claimed' : 'claim'}" data-index="${index}" ${mission.progress < mission.target || mission.claimed ? 'disabled' : ''}>
                        ${mission.claimed ? 'Reclamado' : 'Reclamar'}
                    </button>
                `;
                missionsGrid.appendChild(card);

                if (progressPercent >= 100 && !mission.claimed) {
                    canClaim = true;
                }
            });

            dotMissions.classList.toggle('hidden', !canClaim);
            updateMenuNotification();
            document.querySelectorAll('.claim-mission-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const missionIndex = e.target.dataset.index;
                    const mission = state.dailyMissions[missionIndex];
                    if (mission && mission.progress >= mission.target && !mission.claimed) {
                        state.sig += mission.reward;
                        if (state.missionRewardBonus) {
                            state.sig += mission.reward * (state.missionRewardBonus - 1);
                        }
                        state.missionsCompleted = (state.missionsCompleted || 0) + 1;
                        state.totalSigEarned += mission.reward;
                        mission.claimed = true;
                        showToast(`+${formatNum(mission.reward)} Œ£C! Misi√≥n completada!`, 'success');
                        saveState();
                        renderMissions();
                    }
                });
            });
        }

        function updateMissionProgress(missionId, value) {
            if (!state.dailyMissions) return;
            state.dailyMissions.forEach(mission => {
                if (mission.id === missionId && !mission.claimed) {
                    mission.progress += value;
                }
            });
        }

        function checkWheelCooldown() {
            const now = Date.now();
            const cooldown = 20 * 60 * 1000; // 20 minutes
            const timeSinceSpin = now - state.wheelLastSpin;

            if (timeSinceSpin >= cooldown) {
                if(wheelBtnLabel.dataset.lang) wheelBtnLabel.textContent = LANGUAGES[state.lang]['wheel'];
                dotWheel.classList.remove('hidden');
                if(wheelCooldownText) wheelCooldownText.textContent = LANGUAGES[state.lang]['spin'];
                if(btnSpinWheel) btnSpinWheel.disabled = wheelSpinning; updateMenuNotification();
            } else {
                const remaining = cooldown - timeSinceSpin;
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                const timeStr = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                wheelBtnLabel.textContent = `${LANGUAGES[state.lang || 'es']['wheel']} (${timeStr})`;
                dotWheel.classList.add('hidden');
                if(wheelCooldownText) wheelCooldownText.textContent = `${LANGUAGES[state.lang]['next_spin']} ${timeStr}`; updateMenuNotification();
                if(btnSpinWheel) btnSpinWheel.disabled = true;
            }
        }

        function spinWheel() {
            if (wheelSpinning) return;

            const now = Date.now();
            const cooldown = 20 * 60 * 1000;
            if (now - state.wheelLastSpin < cooldown) {
                showToast("La ruleta a√∫n est√° en cooldown.", "info");
                return;
            }

            wheelSpinning = true;
            btnSpinWheel.disabled = true;

            const segmentCount = WHEEL_REWARDS.length;
            const segmentAngle = 360 / segmentCount;
            const randomSegment = Math.floor(Math.random() * segmentCount);
            
            const spinAngle = (360 * 5) - (randomSegment * segmentAngle) - (segmentAngle / 2);

            wheel.style.transition = 'transform 5s cubic-bezier(0.2, 0.8, 0.2, 1)';
            wheel.style.transform = `rotate(${spinAngle}deg)`;

            setTimeout(() => {
                const selectedReward = WHEEL_REWARDS[randomSegment];
                selectedReward.reward(state);
                updateMissionProgress('spin', 1);
                state.wheelSpins = (state.wheelSpins || 0) + 1;
                state.wheelLastSpin = Date.now();
                wheelSpinning = false;
                checkWheelCooldown();
                saveState();
                checkAchievements();
                render();
                
            }, 5000); // Match CSS transition time
        }

        function renderWheel() {
            const wheelEl = document.querySelector('.wheel');
            wheelEl.innerHTML = '';
            const colors = ['#ff6b6b', '#f06595', '#cc5de8', '#845ef7', '#5c7cfa', '#339af0', '#22b8cf', '#20c997'];
            const segmentAngle = 45;

            WHEEL_REWARDS.forEach((reward, i) => {
                const segment = document.createElement('li');
                segment.className = 'segment';
                segment.style.transform = `rotate(${i * segmentAngle}deg) skewY(-45deg)`;

                const text = document.createElement('div');
                text.className = 'text';
                text.textContent = reward.label;
                text.style.setProperty('--color', colors[i % colors.length]);
                
                segment.appendChild(text);
                wheelEl.appendChild(segment);
            });
        }

        function checkAchievements() {
            let newAchievementUnlocked = false;
            for (const id in ACHIEVEMENT_LOGIC) {
                if (!state.achievements[id]) {
                    const logic = ACHIEVEMENT_LOGIC[id];
                    if (logic.condition(state)) {
                        state.achievements[id] = true;
                        logic.apply(state);
                        const achievementName = ACHIEVEMENTS[id].name;
                        const toastMessage = (state.lang === 'en') 
                            ? `Achievement: ${achievementName}!` 
                            : `Logro: ${achievementName}!`;
                        saveState();
                        showToast(toastMessage, 'success');
                        newAchievementUnlocked = true;
                    }
                }
            }
            if (newAchievementUnlocked) {
                dotAchievements.classList.remove('hidden');
            }
            updateMenuNotification();
        }

        function renderAchievements() {
            achievementsGrid.innerHTML = '';
            for (const id in ACHIEVEMENTS) {
                const achievement = ACHIEVEMENTS[id];
                const unlocked = state.achievements[id];

                const card = document.createElement('div');
                card.className = `achievement-card ${unlocked ? 'unlocked' : 'locked'}`;
                
                card.innerHTML = `
                    <div class="achievement-icon" style="fill: ${unlocked ? 'var(--accent)' : 'var(--muted)'};">${achievement.icon}</div>
                    <div class="achievement-info">
                        <h4>${achievement.name}</h4>
                        <p>${achievement.description}</p>
                        <p style="color: var(--muted); font-style: italic;">${(state.lang === 'en') ? 'Reward' : 'Recompensa'}: ${achievement.reward}</p>
                    </div>
                `;
                achievementsGrid.appendChild(card);
            }
        }

        function openChestsModal() {
            const chestsGrid = document.getElementById('chestsGrid');
            const chestsInfo = document.getElementById('chestsInfo');
            chestsModal.classList.remove('hidden');
            dotChests.classList.add('hidden');
            chestsGrid.innerHTML = '';
            updateMenuNotification();

            if (state.chests.length === 0) {
                chestsInfo.textContent = "No tienes cofres por ahora. ¬°Sigue clickeando!";
                return;
            }

            chestsInfo.textContent = "¬°Has encontrado cofres! Haz clic en uno para abrirlo.";
            state.chests.forEach((chest, index) => {
                const chestEl = document.createElement('div');
                chestEl.innerHTML = '<svg class="icon" style="width:48px; height:48px; stroke: #f39c12;" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>';
                chestEl.style.fontSize = '48px';
                chestEl.style.cursor = 'pointer';
                chestEl.style.transition = 'transform 0.2s';
                chestEl.addEventListener('mouseenter', () => chestEl.style.transform = 'scale(1.1)');
                chestEl.addEventListener('mouseleave', () => chestEl.style.transform = 'scale(1)');
                chestEl.addEventListener('click', () => {
                    // Deshabilitar todos los cofres para evitar doble clic
                    chestsGrid.querySelectorAll('div').forEach(c => c.style.pointerEvents = 'none');
                    // Abrir el cofre seleccionado
                    openChest(index, chestEl);
                }, { once: true });
                chestsGrid.appendChild(chestEl);
            });
        }

        function openChest(index) {
            const chestEl = document.querySelector(`#chestsGrid > div:nth-child(${index + 1})`);
            if (chestEl) {
                chestEl.style.pointerEvents = 'none';
                chestEl.style.animation = 'shake 0.5s';
            }

            setTimeout(() => {
                state.chests.splice(index, 1);
                state.chestsOpened = (state.chestsOpened || 0) + 1;

                // Recompensa de Moneda Exclusiva cada 50 cofres
                if (state.chestsOpened > 0 && state.chestsOpened % 50 === 0) {
                    state.exclusiveMoney = (state.exclusiveMoney || 0) + 100;
                    showToast(`¬°Has abierto 50 cofres! +100 Monedas Exclusivas üëë`, 'success', 5000);
                }

                playSound('chestOpenSfx');
                
                const rand = Math.random();
                // Probabilidad de 1 en 2000 para el Foso Pollo
                if (rand < 0.0005 && !state.fososOwned.includes(45)) {
                    state.fososOwned.push(45);
                    showToast("¬°¬°¬°Has encontrado el legendario Foso Pollo üçó!!!", "success", 5000);
                } else if (rand < 0.05) { // 5% de probabilidad de desgracia
                    const loss = state.sig * 0.01; // Pierde 1% de su dinero
                    state.sig -= loss;
                    showToast(`¬°Mala suerte! El cofre estaba vac√≠o y has perdido ${formatNum(loss)} Œ£C.`, "error");
                } else if (rand < 0.20) { // 15% de probabilidad de gemas (5% a 20%)
                    const gemAmount = Math.floor(Math.random() * 6) + 1; // 1 a 6 gemas
                    state.gems += gemAmount;
                    showToast(`¬°El cofre conten√≠a ${gemAmount} gemas üíé!`, "success");
                } else {
                    // Recompensa normal de Sigmacoins
                    const basePer = FOSOS[state.activeFosoIndex]?.perClick || 1;
                    const currentPerClick = basePer * state.perClickMult * (1 + state.rebirthBonus);
                    const rewardAmount = Math.floor(currentPerClick * 60 * (Math.random() * 0.5 + 0.75)); // Entre 75% y 125% de 60s de ganancias
                    state.sig += rewardAmount;
                    state.totalSigEarned += rewardAmount;
                    showToast(`¬°El cofre conten√≠a ${formatNum(rewardAmount)} Œ£C!`, 'success', 4000);
                }

                openChestsModal(); // Refresh the modal
                saveState();
                checkAchievements();
                render(); // Actualizar la UI principal
            }, 600);
        }

        function saveState() {
            state.lastPlayed = Date.now();
            try {
                localStorage.setItem(CONFIG.storageKey, JSON.stringify(state));
            } catch (e) {
                console.warn('save state err', e);
            }
        }

        function loadState() {
            try {
                const raw = localStorage.getItem(CONFIG.storageKey);
                if (!raw) return;
                const s = JSON.parse(raw);
                Object.assign(state, s);
                if (isNaN(state.battery) || state.battery === null) {
                    state.battery = 100;
                }
                // Migraci√≥n y aseguramiento de que `upgradeLevels` y sus propiedades existan
                const defaultUpgradeLevels = {
                    battery: 0,
                    autoclicker: 0,
                    afk: 0,
                    critical: 0,
                    efficiency: 0,
                    combo: 0,
                    liquid_luck: 0,
                    autorecharge: 0,
                    passive_recharge: 0
                };
                state.upgradeLevels = { ...defaultUpgradeLevels, ...(s.upgradeLevels || {}) };

                if (!state.achievements) {
                    state.achievements = {};
                }
                if (!state.wheelLastSpin) {
                    state.wheelLastSpin = 0;
                }
                if (!state.totalSigEarned) {
                    state.totalSigEarned = state.sig;
                }
                if (!state.dailyMissions) {
                    state.dailyMissions = [];
                }
                if (!state.lastMissionCheck) {
                    state.lastMissionCheck = 0;
                }
                if (!state.chests) {
                    state.chests = [];
                }
                if (!state.gems) {
                    state.gems = 0;
                }
                if (!state.unlockedPets) {
                    state.unlockedPets = [];
                }
                if (!state.equippedPet) {
                    state.equippedPet = null;
                }
                if (!state.combo) {
                    state.combo = { count: 0, expires: 0 };
                }
                if (!state.market) {
                    state.market = { nextUpdate: 0, priceMultipliers: {} };
                }
                if (!state.market.priceMultipliers) {
                    state.market.priceMultipliers = {};
                }
                if (state.settings === undefined) {
                    state.settings = {
                        smokeEnabled: true,
                        clickNumbersEnabled: true
                    };
                }
                if (state.settings.musicVolume === undefined) {
                    state.settings.musicVolume = 0.2;
                }
                if (state.settings.sfxVolume === undefined) {
                    state.settings.sfxVolume = 0.5;
                }
            } catch (e) {
                console.warn('load state err', e);
            }
        }

        function formatNum(n) {
            const suffixes = [
                { value: 1e3, symbol: "k" }, { value: 1e6, symbol: "m" },
                { value: 1e9, symbol: "b" }, { value: 1e12, symbol: "t" },
                { value: 1e15, symbol: "qa" }, { value: 1e18, symbol: "qi" },
                { value: 1e21, symbol: "sx" }, { value: 1e24, symbol: "sp" },
                { value: 1e27, symbol: "oc" }, { value: 1e30, symbol: "no" },
                { value: 1e33, symbol: "dc" }
            ];
            const item = suffixes.slice().reverse().find(item => n >= item.value);
            if (item) return (n / item.value).toFixed(2).replace(/\.00$/, '') + item.symbol;
            return Math.floor(n).toString();
        }

        function render() {
            const lang = state.lang || 'es';
            sigTotalEl.textContent = formatNum(state.sig);
            if(exclusiveMoneyTotalEl) exclusiveMoneyTotalEl.textContent = formatNum(state.exclusiveMoney);
            if(shopSigma) shopSigma.textContent = formatNum(state.sig);

            const fosoPolloCard = document.querySelector('.shopCard[data-index="45"]');
            if (fosoPolloCard) {
                fosoPolloCard.style.display = state.fososOwned.includes(45) ? 'flex' : 'none';
            }
            // Mostrar Foso Yousef si se posee
            const fosoYousefCard = document.querySelector('.shopCard[data-index="46"]');
            if (fosoYousefCard) {
                fosoYousefCard.style.display = state.fososOwned.includes(46) ? 'flex' : 'none';
            }

            if(shopGems) shopGems.textContent = formatNum(state.gems);

            // Mostrar/ocultar bot√≥n de prestigio
            btnPrestige.classList.toggle('hidden', state.fososOwned.length < FOSOS.length);
            if(gemsTotalEl) gemsTotalEl.textContent = formatNum(state.gems);
            totalClicksEl.textContent = state.totalClicks;

            const currentRank = RANKS.slice().reverse().find(r => state.totalClicks >= r.clicks) || RANKS[0];
            if (rankTitleEl) {
                rankTitleEl.innerHTML = `<span data-lang="rank_label">Rango</span>: <span data-lang="${currentRank.key}">${LANGUAGES[lang][currentRank.key]}</span>`;
            }

            let petMultiplier = 1;
            if (state.equippedPet && PETS[state.equippedPet] && state.unlockedPets.includes(state.equippedPet)) {
                petMultiplier = PETS[state.equippedPet].multiplier * (state.petBonusMultiplier || 1);
            }

            const fosoHealth = state.fosoConditions[state.activeFosoIndex] || 100;
            const isBroken = fosoHealth <= 0;
            const healthPenalty = isBroken ? 0 : (fosoHealth < 20 ? 0.5 : 1); // Penalizaci√≥n si la salud es baja

            const basePer = FOSOS[state.activeFosoIndex]?.perClick || 1; // Ganancia base del foso
            
            let craftedBonus = 1;
            if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now()) {
                const bonus = state.activeCraftedFlavor.bonus;
                if (bonus.type === 'multiplier') {
                    craftedBonus = state.activeCraftedFlavor.bonus.value;
                }
            }

            let afkPrestigeBonus = 1;
            if (state.prestigeUpgrades.afk_earnings) {
                afkPrestigeBonus = 1 + (state.prestigeUpgrades.afk_earnings || 0) * PRESTIGE_UPGRADES.afk_earnings.bonus;
            }
            const prestigeBonus = 1 + (state.prestigeUpgrades.all_earnings || 0) * PRESTIGE_UPGRADES.all_earnings.bonus;
            const gemFosoBonus = 1 + state.gemFososOwned.length * 0.05;
            const comboBonus = state.combo.count > 1 ? 1 + (state.combo.count * 0.1) : 1; // +10% por nivel de combo
            let per = basePer * state.perClickMult * (1 + state.rebirthBonus) * comboBonus * petMultiplier * prestigeBonus * gemFosoBonus * craftedBonus;



            if (isBroken) per = 0;
            perClickEl.textContent = formatNum(per);

            // Render Foso Health
            if (maintenanceBarFill) {
                maintenanceBarFill.style.width = `${fosoHealth}%`;
                // Cambia el color de la barra seg√∫n la salud
                const position = 100 - fosoHealth; // 0 = verde, 50 = amarillo, 100 = rojo
                maintenanceBarFill.style.backgroundPosition = `${position}% 0`;
            }
            // Animaci√≥n de vibraci√≥n y humo
            centralFoso.classList.remove('foso-shaking', 'foso-combo-max'); // Limpiar clases de animaci√≥n
            if (state.combo.count >= CONFIG.comboMax) {
                centralFoso.classList.add('foso-combo-max');
            } else if (state.burned) {
                centralFoso.classList.add('foso-shaking');
            } else {
                centralFoso.classList.toggle('foso-shaking', fosoHealth < 40 && !isBroken);
            }
            if (centralScreen) {
                centralScreen.setAttribute('fill', isBroken ? '#c0392b' : '#000');
            }


            if(dailyStreakEl) dailyStreakEl.textContent = state.dailyDay;

            if (batteryText) {
                const maxB = state.maxBattery || 100;
                const percent = Math.floor((Number(state.battery) / maxB) * 100);
                batteryText.textContent = percent + "%" ;
                batteryText.setAttribute("fill", percent > 20 ? "#0f0" : "#f00");
            }

            const now = Date.now();
            if (state.mataCooldownUntil && state.mataCooldownUntil > now) {
                btnMata.disabled = true;
                const sec = Math.ceil((state.mataCooldownUntil - now) / 1000);
                const mm = String(Math.floor(sec / 60)).padStart(2, '0'),
                    ss = String(sec % 60).padStart(2, '0');
                mataLabel.textContent = `${LANGUAGES[state.lang || 'es']['cooldown']} ${mm}:${ss}`;
            } else {
                btnMata.disabled = isCharging;
                if(mataLabel.dataset.lang) mataLabel.textContent = LANGUAGES[state.lang || 'es'][mataLabel.dataset.lang];
            }

            syncCentralAppearance(state.activeFosoIndex);

            if (centralScreen) {
                if (state.burned) {
                    centralScreen.setAttribute('fill', '#6b0000');
                } else {
                    if (fosoHealth > 0)
                    centralScreen.setAttribute('fill', '#000');
                }
            }

            // Update shop items
            shopModal.querySelectorAll('.shopCard[data-index]').forEach(card => {
                const index = parseInt(card.dataset.index, 10);
                const item = FOSOS[index];
                if (!item) return;

                const priceTag = card.querySelector('.priceTag');
                if (!priceTag) return;
                
                const lang = state.lang || 'es';

                if (state.fososOwned.includes(index)) {
                    card.classList.add('owned');
                    priceTag.textContent = LANGUAGES[lang]['owned'];
                    if (state.fosoConditions[index] === undefined) state.fosoConditions[index] = 100;
                    priceTag.style.color = '';
                    priceTag.style.background = '';
                } else {
                    card.classList.remove('owned');
                    priceTag.style.background = '';
                    if (item.exclusive) {
                        if (priceTag.dataset.cost === 'Infinity') {
                            priceTag.textContent = 'Ruleta';
                        } else {
                            priceTag.textContent = `${formatNum(parseInt(priceTag.dataset.cost, 10))} üëë`;
                        }
                        priceTag.style.color = '';
                    } else {
                        const baseCost = item.cost;
                        const currentCost = Math.round(baseCost * (state.market.priceMultipliers[index] || 1));
                        priceTag.textContent = `${formatNum(currentCost)} Œ£C`;
                        priceTag.style.color = currentCost < baseCost ? '#2ecc71' : (currentCost > baseCost ? '#e74c3c' : '');
                    }
                }
            });

            // Update Gem Foso items
            shopGrid.querySelectorAll('.shopCard[data-gem-foso-index]').forEach(card => {
                const index = parseInt(card.dataset.gemFosoIndex, 10);
                const priceTag = card.querySelector('.priceTag');

                if (state.gemFososOwned.includes(index)) {
                    card.classList.add('owned');
                    priceTag.textContent = LANGUAGES[lang]['owned'];
                    priceTag.style.background = '#27ae60';
                } else {
                    card.classList.remove('owned');
                    priceTag.style.background = '';
                }
            });
        }

        function renderUpgrades() {
            const upgradesGrid = document.getElementById('upgradesGrid');
            if (!upgradesGrid) return;
            upgradesGrid.innerHTML = '';

            const allUpgrades = { // CORREGIDO: A√±adidos los tipos de mejora que faltaban
                autoclicker: { name_key: 'upgrade_autoclicker', upgrades: AUTOCLICKER_UPGRADES, icon: 'üëÜ', desc: 'A√±ade clics autom√°ticos por segundo.' },
                battery: { name_key: 'upgrade_battery', upgrades: BATTERY_UPGRADES, icon: 'üîã', desc: 'Aumenta la capacidad m√°xima de la bater√≠a.' },
                efficiency: { name_key: 'upgrade_efficiency', upgrades: EFFICIENCY_UPGRADES, icon: 'üíß', desc: 'Reduce el consumo de bater√≠a por clic.' },
                critical: { name_key: 'upgrade_critical', upgrades: CRITICAL_UPGRADES, icon: 'üí•', desc: 'Aumenta la probabilidad y multiplicador de cr√≠ticos.' },
                combo: { name_key: 'upgrade_combo', upgrades: COMBO_UPGRADES, icon: '‚ö°', desc: 'Aumenta el tiempo para mantener el combo.' },
                liquid_luck: { name_key: 'upgrade_liquid_luck', upgrades: LIQUID_LUCK_UPGRADES, icon: 'üß™', desc: 'Aumenta la probabilidad de encontrar l√≠quidos.' },
                passive_recharge: { name_key: 'upgrade_passive_recharge', upgrades: PASSIVE_RECHARGE_UPGRADES, icon: '‚è≥', desc: 'Recarga la bater√≠a pasivamente con el tiempo.' }
            };

            for (const type in allUpgrades) {
                const config = allUpgrades[type];
                const currentLevel = state.upgradeLevels[type] || 0;
                const nextUpgrade = currentLevel < config.upgrades.length ? config.upgrades[currentLevel] : null;
                const card = document.createElement('div');
                card.className = 'power-card';
                card.innerHTML = `
                    <div class="power-icon">${config.icon}</div>
                    <h4 data-lang="${config.name_key}">${LANGUAGES[state.lang || 'es'][config.name_key]} (Nivel ${currentLevel})</h4>
                    <p>${config.desc}</p>
                    <button class="mata-btn" data-upgrade="${type}" ${!nextUpgrade || state.sig < nextUpgrade.cost ? 'disabled' : ''}>
                        ${nextUpgrade ? `${formatNum(nextUpgrade.cost)} Œ£C` : LANGUAGES[state.lang || 'es']['max_level']}
                    </button>
                `;
                upgradesGrid.appendChild(card);
            }
        }

        function toggleCharging() {
            if (isCharging) {
                clearInterval(chargeInterval);
                chargeInterval = null;
                isCharging = false;
                if(chargeLabel.dataset.lang) chargeLabel.textContent = LANGUAGES[state.lang || 'es'][chargeLabel.dataset.lang];
            } else {
                isCharging = true;
                chargeLabel.textContent = LANGUAGES[state.lang || 'es']['charging'] || 'Cargando...';
                chargeInterval = setInterval(() => {
                    if (Number(state.battery) < (state.maxBattery || 100)) {
                        state.battery = Math.min(state.maxBattery, (Number(state.battery) || 0) + 25);
                        render();
                    } else {
                        clearInterval(chargeInterval);
                        chargeInterval = null;
                        isCharging = false;
                        chargeLabel.textContent = LANGUAGES[state.lang || 'es']['charge'] || 'Cargar';
                    }
                }, 1000);
            }
        }

        function showClickAnimation(value, x, y, isCritical = false) {
            if (!chkClickNumbers.checked) return;
            const anim = document.createElement('div');
            anim.className = isCritical ? 'click-value critical' : 'click-value';
            anim.textContent = isCritical ? `CR√çTICO! +${formatNum(value)}` : `+${formatNum(value)}`;
            const rect = vaperWrap.getBoundingClientRect();
            anim.style.left = `${x - rect.left}px`;
            anim.style.top = `${y - rect.top - 20}px`; // Start slightly higher
            vaperWrap.appendChild(anim);            
            setTimeout(() => anim.remove(), 1000); // Coincide con la duraci√≥n de la animaci√≥n
        }

        function createClickRipple(e) {
            const ripple = document.createElement("div");
            ripple.className = "ripple";
            vaperWrap.appendChild(ripple);

            const rect = vaperWrap.getBoundingClientRect();
            ripple.style.left = `${e.clientX - rect.left}px`;
            ripple.style.top = `${e.clientY - rect.top}px`;

            setTimeout(() => ripple.remove(), 600);

        }

        function createSmokeParticle() {
            if (!state.settings.smokeEnabled) return;
            const smokeLayer = document.getElementById('smokeLayer');
            if (!smokeLayer) return;

            const smoke = document.createElement('div');
            smoke.className = 'smoke-on-click';

            // Posici√≥n X aleatoria para un efecto m√°s natural
            const randomX = (Math.random() - 0.5) * 30; // -15px a +15px
            smoke.style.transform = `translateX(calc(-50% + ${randomX}px))`;

            smokeLayer.appendChild(smoke);

            // Eliminar el elemento despu√©s de que termine la animaci√≥n
            setTimeout(() => {
                smoke.remove();
            }, 1500); // Coincide con la duraci√≥n de la animaci√≥n
        }

        function updateCombo() {
            const comboTimeExtension = state.upgradeLevels.combo > 0 ? COMBO_UPGRADES[state.upgradeLevels.combo - 1].time : 0;
            const totalComboTime = CONFIG.comboTimeout + comboTimeExtension;

            state.combo.count = Math.min(state.combo.count + 1, CONFIG.comboMax);
            state.combo.expires = Date.now() + totalComboTime;

            if (state.combo.count > 1) {
                comboContainer.classList.remove('hidden');
                comboText.textContent = LANGUAGES[state.lang || 'es']['combo_meter'].replace('{value}', (1 + (state.combo.count * 0.1)).toFixed(1));
            }

            if (comboDecayTimer) clearTimeout(comboDecayTimer);
            comboDecayTimer = setTimeout(() => {
                const tick = () => {
                    const remaining = state.combo.expires - Date.now();
                    if (remaining <= 0) {
                        state.combo.count = 0;
                        comboContainer.classList.add('hidden');
                    } else {
                        comboBar.style.width = `${(remaining / totalComboTime) * 100}%`;
                        requestAnimationFrame(tick);
                    }
                };
                tick();
            }, 100);
        }

        function handleCentralClick(e) {
            if (isCharging) {
                showToast('No puedes vapear mientras se est√° cargando.', "info");
                return;
            }
            if (!state.powerOn) return;
            if (state.burned) {
                showToast('El foso est√° quemado. Compra/selecciona otro.', "info");
                return;

            }
            if (state.battery <= 0) {
                showToast('Bater√≠a agotada.', "info");
                return;
            }

            const fosoHealth = state.fosoConditions[state.activeFosoIndex] || 100;
            if (fosoHealth <= 0) {
                showToast("¬°Foso roto! Rep√°ralo desde el men√∫ de Mantenimiento.", "error");
                openMaintenanceModal();
                return;
            }

            state.clicksThisSecond = (state.clicksThisSecond || 0) + 1;
            if (state.activeEvent?.id !== 'combo_madness') {
                updateCombo();
            }

            const basePer = FOSOS[state.activeFosoIndex]?.perClick || 1; // Ganancia base del foso
            const comboBonus = state.combo.count > 1 ? 1 + (state.combo.count * 0.1) : 1;
            let per = basePer * state.perClickMult * (1 + state.rebirthBonus) * comboBonus; // Aplicar multiplicadores y bonus de rebirth
            let isCritical = false;

            let craftedBonus = 1;
            let craftedCritBonus = 0;
            if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now()) {
                const bonus = state.activeCraftedFlavor.bonus;
                if (bonus.type === 'multiplier') craftedBonus = bonus.value;
                if (bonus.type === 'crit_chance') craftedCritBonus = bonus.value;
                if (bonus.type === 'gem_chance') state.liquidDropChance += bonus.value; // Temporarily boost gem chance
            }

            const prestigeBonus = 1 + (state.prestigeUpgrades.all_earnings || 0) * PRESTIGE_UPGRADES.all_earnings.bonus;
            const gemFosoBonus = 1 + state.gemFososOwned.length * 0.05;
            per *= prestigeBonus * gemFosoBonus * craftedBonus;

            // Apply event effects
            if (state.activeEvent?.id === 'frenzy') {
                per *= 5;
            }

            const prestigeCritBonus = (state.prestigeUpgrades.crit_chance || 0) * PRESTIGE_UPGRADES.crit_chance.bonus;
            const critLevel = state.upgradeLevels.critical || 0;
            if (critLevel > 0) {
                const critUpgrade = CRITICAL_UPGRADES[critLevel - 1];
                if (critUpgrade && Math.random() < critUpgrade.chance) {
                    per *= critUpgrade.multiplier;
                    isCritical = true;
                }
            }

            // Ganancia de gemas
            let gemChance = 0.001 + ((state.prestigeUpgrades.gem_chance || 0) * PRESTIGE_UPGRADES.gem_chance.bonus);
            if (state.activeEvent?.id === 'gem_rain') {
                gemChance += 0.10; // +10% durante el evento
            }
            if (Math.random() < gemChance) { state.gems += 1; showToast('+1 üíé!', 'success'); }

            // Ganancia de l√≠quidos
            const liquidLuckLevel = state.upgradeLevels.liquid_luck || 0;
            const liquidLuckBonus = liquidLuckLevel > 0 ? LIQUID_LUCK_UPGRADES[liquidLuckLevel - 1].chance : 0;
            if (Math.random() < (state.liquidDropChance + liquidLuckBonus)) {
                gainRandomLiquid();
            }

            // Chest drop
            let chestChance = CONFIG.chestDropChance;
            if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now() && state.activeCraftedFlavor.bonus.type === 'chest_chance') {
                chestChance += state.activeCraftedFlavor.bonus.value;
            }

            state.sig += per;
            state.totalSigEarned += per;
            state.totalClicks++;
            updateMissionProgress('click', 1);
            updateMissionProgress('earn', per);

            // Degradar salud del foso
            state.fosoConditions[state.activeFosoIndex] = Math.max(0, fosoHealth - CONFIG.healthDegradationPerClick);
            if (state.fosoConditions[state.activeFosoIndex] <= 0) {
                showToast("¬°Tu foso se ha roto! Rep√°ralo para seguir.", "error", 5000);
            }
            updateMenuNotification();

            // Chest drop
            if (Math.random() < CONFIG.chestDropChance) {
                state.chests.push({ type: 'common' });
                showToast("¬°Has encontrado un cofre!", "success");
                dotChests.classList.remove('hidden');
            }

            // Don't drain battery during event
            if (state.activeEvent?.id !== 'infinite_battery' && !(state.activeCraftedFlavor && state.activeCraftedFlavor.bonus.type === 'no_battery_drain' && state.activeCraftedFlavor.expires > Date.now())) {
                const efficiencyLevel = state.upgradeLevels.efficiency || 0;
                const efficiencyBonus = efficiencyLevel > 0 ? EFFICIENCY_UPGRADES[efficiencyLevel - 1].reduction : 0;
                let drain = CONFIG.baseBatteryDrainPerClick * (1 - efficiencyBonus);
                let finalDrain = drain;
                if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now() && state.activeCraftedFlavor.bonus.type === 'battery_saver') {
                    finalDrain *= (1 - state.activeCraftedFlavor.bonus.value); // 50% less drain means multiply by 0.5
                }
                state.battery = Math.max(0, state.battery - finalDrain);
             }


            // The click handler can be called by the autoclicker with a null event
            // We only want to show animations for manual clicks (where 'e' is a valid event object)
            // Animaci√≥n de pulso
            if (e) {
                // Animaci√≥n de pulso
                createClickRipple(e);
                centralFoso.classList.add('clicked');
                setTimeout(() => {
                    centralFoso.classList.remove('clicked');
                }, 100);
    
                showClickAnimation(per, e.clientX, e.clientY, isCritical);
                // Humo negro si est√° da√±ado
                const isDamaged = fosoHealth < 40;
                createSmokeParticle(isDamaged);
            }

            // Play sounds
            playSound('clickSfx');
            if (!musicStarted && bgMusic) {
                bgMusic.volume = state.settings.musicVolume;
                bgMusic.play().catch(e => console.warn("Music autoplay was blocked."));
                musicStarted = true;
            }

            checkAchievements();
            render();
        }

        function gainRandomLiquid(isFromClick = false) {
            const liquidIds = Object.keys(BASE_LIQUIDS);
            const randomId = liquidIds[Math.floor(Math.random() * liquidIds.length)];
            state.liquidInventory[randomId] = (state.liquidInventory[randomId] || 0) + 1;
            const liquid = BASE_LIQUIDS[randomId];
            if (isFromClick) {
                showToast(`¬°Has encontrado ${liquid.name}! ${liquid.icon}`, 'info');
            }
            document.getElementById('dotCrafting').classList.remove('hidden');
            updateMenuNotification();
        }
        
        function syncCentralAppearance(activeIndex){
            const activeCard = document.querySelector(`.shopCard[data-index="${activeIndex}"]`); // Busca en todo el documento
            if(!activeCard) return; // Si la tarjeta no existe (ej. al inicio), no hacer nada
            state.fosoConditions[activeIndex] = state.fosoConditions[activeIndex] || 100; // Asegurar que la salud existe
            const cardSvg = activeCard.querySelector('svg');
            const cardDefs = cardSvg?.querySelector('defs');
            const centralDefs = centralFoso.querySelector('defs');
            if (!cardDefs || !centralDefs) return;

            centralDefs.querySelectorAll('#gActive, #mouthActive').forEach(n=>n.remove());
            
            if (!cardDefs) return;
            centralDefs.insertAdjacentHTML('beforeend', cardDefs.innerHTML.replace(/_shop/g, '').replace(/id="g(\d+)"/g, 'id="gActive"').replace(/id="mouth(\d+)"/g, 'id="mouthActive"'));

            const fosoData = FOSOS[activeIndex];
            const gameContainer = document.querySelector('.game-container');
            if (fosoData.background && gameContainer) gameContainer.style.background = fosoData.background;

            const rects = centralFoso.querySelectorAll('rect');
            const bodyRect = rects[0];
            if(bodyRect) bodyRect.setAttribute('fill','url(#gActive)');
        }

        function playSound(id, volume = state.settings.sfxVolume) {
            const audio = document.getElementById(id);
            if (audio && state.settings.sfxVolume > 0) {
                audio.volume = state.settings.sfxVolume;
                audio.currentTime = 0;
                audio.play().catch(e => {}); // Ignore play errors
            }
        }

        
        function showToast(message, type = "info", duration = 3000) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';

                        // Ajustar la duraci√≥n de la animaci√≥n de salida
            const fadeOutTime = 0.3; // en segundos
            const displayTime = (duration / 1000) - fadeOutTime;
            toast.style.animation = `toastIn 0.3s ease forwards, toastOut ${fadeOutTime}s ease ${displayTime}s forwards`;
            toast.style.animationDelay = `${fadeOutTime}s`;

            const icons = { success: '‚úÖ', error: '‚ùå', warning: '‚ö†Ô∏è', info: '‚ÑπÔ∏è' };
            const colors = { success: '#27ae60', error: '#e74c3c', warning: '#f39c12', info: '#3498db' };

            toast.innerHTML = `<span>${icons[type] || '‚ÑπÔ∏è'}</span> ${message}`;
            toast.style.borderLeft = `4px solid ${colors[type] || '#3498db'}`;

            if (type === 'success') playSound('successSfx', 0.7);
            if (type === 'error') playSound('errorSfx', 0.7);

            container.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, duration);
        }

                function triggerGemRain() {
            const container = document.createElement('div');
            container.className = 'coin-rain'; // Reutilizamos la clase
            document.body.appendChild(container);

            for (let i = 0; i < 20; i++) {
                const gem = document.createElement('div');
                gem.className = 'coin'; // Reutilizamos la clase
                gem.textContent = 'üíé';
                gem.style.left = `${Math.random() * 100}vw`;
                gem.style.animationDelay = `${Math.random() * 1.5}s`;
                gem.style.fontSize = `${Math.random() * 10 + 15}px`;
                container.appendChild(gem);
            }

            setTimeout(() => {
                container.remove();
            }, 5000);
        }

        function updateNextRewardCountdown() {
            if (nextRewardInterval) clearInterval(nextRewardInterval);

            const now = new Date();
            const lastClaim = state.lastDailyClaim ? new Date(state.lastDailyClaim) : null;

            if (lastClaim && now.toDateString() === lastClaim.toDateString()) {
                nextRewardInterval = setInterval(() => {
                    const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
                    const diff = tomorrow - new Date();
                    if (diff <= 0) {
                        streakHint.textContent = '¬°Tu recompensa diaria est√° lista!';
                        clearInterval(nextRewardInterval);
                        checkDailyReward();
                        return;
                    }
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    streakHint.textContent = `Pr√≥xima recompensa en: ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                }, 1000);
            } else {
                 if(streakHint.dataset.lang) streakHint.textContent = LANGUAGES[state.lang || 'es'][streakHint.dataset.lang];
            }
        }

        function checkDailyReward() {
            const now = new Date();
            const lastClaim = state.lastDailyClaim ? new Date(state.lastDailyClaim) : null;
            
            if (!lastClaim) {
                canClaimDaily = true;
                state.dailyDay = 1;
            } else {
                const isSameDay = now.toDateString() === lastClaim.toDateString();
                if (!isSameDay) {
                    const yesterday = new Date(now);
                    yesterday.setDate(now.getDate() - 1);
                    const isConsecutive = yesterday.toDateString() === lastClaim.toDateString();
                    if (isConsecutive) {
                        state.dailyDay = (state.dailyDay % DAILY_REWARDS.length) + 1;
                    } else {
                        state.dailyDay = 1; // Reset streak
                    }
                    canClaimDaily = true;
                } else {
                    canClaimDaily = false;
                }
            }

            if (canClaimDaily) {
                dotDaily.classList.remove('hidden');
                updateMenuNotification();
            } else {
                dotDaily.classList.add('hidden');
            }
            updateNextRewardCountdown();
            render();
        }

        function openDailyModal() {
            if (!dailyModal) return;
            dailyModal.classList.remove('hidden');
            dailyCarousel.innerHTML = '';

            DAILY_REWARDS.forEach((reward, index) => {
                const day = index + 1;
                const card = document.createElement('div');
                card.style.cssText = `
                    flex-shrink: 0;
                    width: 120px;
                    padding: 10px;
                    border-radius: 8px;
                    text-align: center;
                    border: 2px solid #333;
                    background: #222;
                `;
                if (day < state.dailyDay) { // Claimed
                    card.style.borderColor = '#27ae60';
                    card.style.opacity = '0.6';
                } else if (day === state.dailyDay && canClaimDaily) { // Can claim
                    card.style.borderColor = '#f39c12';
                    card.style.transform = 'scale(1.05)';
                }
                
                card.innerHTML = `
                    <div style="font-weight:bold; margin-bottom:8px;">${LANGUAGES[state.lang || 'es']['days'].slice(0, -1)} ${day}</div>
                    <div style="font-size:24px; margin-bottom:8px;">üéÅ</div>
                    <div style="font-size:12px;">${reward.label}</div>
                `;
                dailyCarousel.appendChild(card);
            });

            btnClaimDaily.disabled = !canClaimDaily;
        }

        function claimDailyReward() {
            if (!canClaimDaily) return;

            const rewardIndex = state.dailyDay - 1;
            const reward = DAILY_REWARDS[rewardIndex];

            if (reward.type === 'sig') {
                state.sig += reward.value;
                state.totalSigEarned += reward.value;
                showToast(`+${formatNum(reward.value)} Œ£C!`, 'success');
            } else if (reward.type === 'multiplier') {
                state.perClickMult *= reward.value;
                showToast(`Multiplicador x${reward.value} activado por ${reward.duration / 60} min!`, 'success');
                setTimeout(() => { state.perClickMult /= reward.value; showToast(`El multiplicador del regalo diario ha terminado.`, 'info'); }, reward.duration * 1000);
                triggerGemRain();
            } else if (reward.type === 'combo') {
                state.sig += reward.value.sig;
                state.totalSigEarned += reward.value.sig;
                showToast(`+${reward.value.sig} Œ£C y multiplicador activado!`, 'success');
            }

            state.lastDailyClaim = new Date().toISOString();
            canClaimDaily = false;
            dotDaily.classList.add('hidden');
            saveState();
            dailyModal.classList.add('hidden');
            updateNextRewardCountdown();
            render();
        }

        function updateAutoClickLoop() { // CORREGIDO
            if (autoClickTimer) {
                clearInterval(autoClickTimer);
                autoClickTimer = null;
            }
            const level = state.upgradeLevels.autoclicker || 0;
            if (level > 0) {
                const cps = AUTOCLICKER_UPGRADES[level - 1].cps;
                autoClickTimer = setInterval(() => { // CORREGIDO
                    if (state.powerOn && !isCharging && state.battery > 0 && document.visibilityState === 'visible') {
                        handleCentralClick(null);
                    }
                }, 1000 / cps);
            }
        }

        function updatePassiveRechargeLoop() {
            if (passiveRechargeTimer) {
                clearInterval(passiveRechargeTimer);
                passiveRechargeTimer = null;
            }
            const level = (state.upgradeLevels && state.upgradeLevels.passive_recharge) || 0;
            if (level > 0) {
                const rechargeAmount = PASSIVE_RECHARGE_UPGRADES[level - 1].amount;
                passiveRechargeTimer = setInterval(() => {
                    if (state.powerOn && !isCharging && state.battery < state.maxBattery) {
                        state.battery = Math.min(state.maxBattery, state.battery + rechargeAmount);
                        render(); // Update battery display
                    }
                }, 1000);
            }
        }

        function calculateAfkEarnings() {
            const now = Date.now();
            const lastClaim = state.afkLastClaim || state.lastPlayed || now;
            const diffSeconds = Math.floor((now - lastClaim) / 1000);
            const afkLevel = state.upgradeLevels.afk || 0;
            let craftedAfkBonus = 1;
            if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now() && state.activeCraftedFlavor.bonus.type === 'afk_multiplier') {
                craftedAfkBonus = state.activeCraftedFlavor.bonus.value;
            }

            // showToast(`AFK check: ${diffSeconds}s since last claim. Level: ${afkLevel}`, "info"); // DEBUG
            const prestigeAfkBonus = 1 + (state.prestigeUpgrades.afk_earnings || 0) * PRESTIGE_UPGRADES.afk_earnings.bonus;
            if (afkLevel > 0) {
                const sph = AFK_UPGRADES[afkLevel - 1].sph;
                const earnings = (sph / 3600) * diffSeconds * (state.afkMultiplier || 1);
                state.afkEarnings = earnings;
                if (earnings > 0) {
                    dotAFK.classList.remove('hidden');
                }
            }
        }

        function openAfkModal() {
            calculateAfkEarnings();
            const afkLevel = state.upgradeLevels.afk || 0;
            const earnings = state.afkEarnings || 0;
            let infoText = `Ganancias actuales: ${formatNum(earnings)} Œ£C.\n`;
            if (afkLevel > 0) {
                infoText += `Ganas ${formatNum(AFK_UPGRADES[afkLevel - 1].sph)} Œ£C por hora.`;
            } else {
                infoText += 'Compra tu primera mejora para empezar a ganar AFK.';
            }
            afkInfo.innerText = infoText;

            const nextLevel = afkLevel < AFK_UPGRADES.length ? AFK_UPGRADES[afkLevel] : null;
            if (nextLevel) {
                btnUpgradeAFK.textContent = `Mejorar (${formatNum(nextLevel.cost)} Œ£C)`;
                btnUpgradeAFK.disabled = false;
            } else {
                btnUpgradeAFK.textContent = 'MAX';
                btnUpgradeAFK.disabled = true;
            }

            dotAFK.classList.add('hidden');
            afkModal.classList.remove('hidden');
        }

        function claimAfkEarnings() {
            calculateAfkEarnings();
            const earnings = state.afkEarnings || 0;
            if (earnings > 0) {
                state.sig += earnings;
                state.totalSigEarned += earnings;
                showToast(`+${formatNum(earnings)} Œ£C de ganancias AFK!`, 'success');
                state.afkEarnings = 0;
                state.afkLastClaim = Date.now();
                dotAFK.classList.add('hidden');
                saveState();
            updateMenuNotification();
            }
            afkModal.classList.add('hidden');
            render();
        }

        function upgradeAfk() {
            const level = state.upgradeLevels.afk || 0;
            if (level < AFK_UPGRADES.length) {
                const cost = AFK_UPGRADES[level].cost;
                if (state.sig >= cost) {
                    state.sig -= cost;
                    state.upgradeLevels.afk++;
                    showToast('¬°Mejora de AFK comprada!', 'success');
                    saveState();
                    openAfkModal(); // Refresh modal
                } else {
                    showToast('No tienes suficientes Sigmacoins.', 'error');
                }
            }
            render();
        }

        function openRebirthModal() {
            const rebirthInfoEl = document.getElementById('rebirthInfo');
            const btnConfirmRebirth = document.getElementById('btnConfirmRebirth');
            const nextLevelIndex = state.rebirths;

            if (nextLevelIndex < REBIRTH_LEVELS.length) {
                const nextLevel = REBIRTH_LEVELS[nextLevelIndex];
                const hasEnoughSig = state.sig >= nextLevel.cost;
                const hasEnoughFosos = state.fososOwned.length >= nextLevel.requiredFosos;
                
                rebirthInfoEl.innerHTML = `
                    <p><strong>Pr√≥ximo Rebirth (Nivel ${nextLevelIndex + 1}):</strong></p>
                    <ul>
                        <li>Costo: ${formatNum(nextLevel.cost)} Œ£C (${hasEnoughSig ? '‚úÖ' : '‚ùå'})</li>
                        <li>Fosos requeridos: ${nextLevel.requiredFosos} (${hasEnoughFosos ? '‚úÖ' : '‚ùå'})</li>
                        <li><strong>Bonificaci√≥n:</strong> +${nextLevel.bonus * 100}% de ganancias por clic</li>
                    </ul>
                `;
                btnConfirmRebirth.disabled = !(hasEnoughSig && hasEnoughFosos);
            } else {
                rebirthInfoEl.innerHTML = '<p>¬°Has alcanzado el nivel m√°ximo de Rebirth por ahora!</p>';
                btnConfirmRebirth.disabled = true;
            }

            rebirthModal.classList.remove('hidden');
        }

        function handleRebirth() {
            const nextLevelIndex = state.rebirths;
            if (nextLevelIndex >= REBIRTH_LEVELS.length) return;

            const nextLevel = REBIRTH_LEVELS[nextLevelIndex];
            const hasEnoughSig = state.sig >= nextLevel.cost;
            const hasEnoughFosos = state.fososOwned.length >= nextLevel.requiredFosos;

            if (hasEnoughSig && hasEnoughFosos) {
                if (confirm(`¬øSeguro que quieres hacer Rebirth? Perder√°s tus Sigmacoins, fosos y mejoras a cambio de una bonificaci√≥n de +${nextLevel.bonus * 100}% en las ganancias.`)) {
                    // Aplicar bonificaci√≥n
                    state.rebirthBonus += nextLevel.bonus;
                    state.rebirths++;

                    // Recompensa de Gemas por Rebirth
                    const gemsFromRebirth = 10 + (state.rebirths * 5);
                    state.gems += gemsFromRebirth;
                    showToast(`¬°Has ganado ${gemsFromRebirth} gemas üíé por el Rebirth!`, 'success');


                    // Resetear estado
                    state.sig = 0;
                    state.totalClicks = state.totalClicks; // Mantener clics totales
                    state.activeFosoIndex = 0; // CORREGIDO: Asegurar que fososOwned es un array
                    state.fososOwned = [0];
                    state.battery = 100; // Resetear bater√≠a
                    state.maxBattery = 100;
                    state.upgradeLevels = { battery: 0, autoclicker: 0, afk: 0 };
                    // Podr√≠amos resetear m√°s cosas si quisi√©ramos (cooldowns, etc.)

                    showToast(`¬°Rebirth completado! Ahora tienes un +${(state.rebirthBonus * 100).toFixed(0)}% de bonus.`, 'success', 5000);
                    rebirthModal.classList.add('hidden');
                    checkAchievements();
                    saveState();
                    updateAutoClickLoop();
                    render();
                }
            } else {
                showToast('No cumples los requisitos para el Rebirth.', 'error');
            }
        }

        function openPrestigeModal() {
            const prestigeInfoEl = document.getElementById('prestigeInfo');
            const btnConfirmPrestige = document.getElementById('btnConfirmPrestige');
            const prestigeUpgradesGrid = document.getElementById('prestigeUpgradesGrid');

            const canPrestige = state.fososOwned.length >= FOSOS.length;
            const pointsToGain = canPrestige ? Math.floor(Math.log10(state.totalSigEarned) / 2) : 0;

            prestigeInfoEl.innerHTML = `
                <p>Nivel de Prestigio actual: <strong>${state.prestigeLevel}</strong></p>
                <p>Puntos de Prestigio (PP) actuales: <strong>${state.prestigePoints}</strong></p>
                <p>PP que ganar√°s al prestigiar: <strong>${pointsToGain}</strong></p>
            `;

            btnConfirmPrestige.disabled = !canPrestige;

            // Render prestige upgrades
            prestigeUpgradesGrid.innerHTML = '';
            for (const id in PRESTIGE_UPGRADES) {
                const upgrade = PRESTIGE_UPGRADES[id];
                const level = state.prestigeUpgrades[id] || 0;
                const cost = upgrade.cost * (level + 1);

                const card = document.createElement('div');
                card.className = 'shopCard';
                card.title = upgrade.description;

                card.innerHTML = `
                    <div style="font-size: 24px;">${upgrade.icon}</div>
                    <div style="font-weight:700; font-size: 12px;">${upgrade.name} (Lvl ${level})</div>
                    <button class="mata-btn buy-prestige-btn" data-id="${id}" ${state.prestigePoints < cost || level >= upgrade.maxLevel ? 'disabled' : ''}>
                        ${level >= upgrade.maxLevel ? 'MAX' : `${cost} PP`}
                    </button>
                `;
                prestigeUpgradesGrid.appendChild(card);
            }

            prestigeModal.classList.remove('hidden');
        }

        function handlePrestige() {
            if (state.fososOwned.length < FOSOS.length) return;

            const pointsToGain = Math.floor(Math.log10(state.totalSigEarned) / 2);
            if (confirm(`¬øSeguro que quieres hacer Prestigio? Ganar√°s ${pointsToGain} Puntos de Prestigio y reiniciar√°s tu progreso.`)) {
                state.prestigeLevel++;
                state.prestigePoints += pointsToGain;

                // Reset
                state.sig = 0;
                state.activeFosoIndex = 0;
                state.fososOwned = [0];
                state.battery = 100;
                state.maxBattery = 100;
                state.upgradeLevels = { battery: 0, autoclicker: 0, afk: 0, critical: 0 };
                state.rebirths = 0;
                state.rebirthBonus = 0;

                showToast(`¬°Prestigio completado! Nivel ${state.prestigeLevel}. Has ganado ${pointsToGain} PP.`, 'success', 5000);
                prestigeModal.classList.add('hidden');
                saveState();
                updateAutoClickLoop();
                render();
            }
        }

        function openCraftingModal() {
            craftingModal.classList.remove('hidden');
            document.getElementById('dotCrafting').classList.add('hidden');
            updateMenuNotification();
            renderLiquidInventory();
            renderActiveFlavor();
        }

        function renderLiquidInventory() {
            const grid = document.getElementById('liquidInventoryGrid');
            grid.innerHTML = '';
            for (const id in state.liquidInventory) {
                if (state.liquidInventory[id] > 0) {
                    const liquid = BASE_LIQUIDS[id];
                    const item = document.createElement('div');
                    item.className = 'liquid-item';
                    item.draggable = true;
                    item.dataset.liquidId = id;
                    item.innerHTML = `
                        <div class="liquid-icon">${liquid.icon}</div>
                        <div class="liquid-name">${liquid.name}</div>
                        <div class="liquid-count">x${state.liquidInventory[id]}</div>
                    `;
                    item.addEventListener('dragstart', handleDragStart);
                    grid.appendChild(item);
                }
            }
        }

        function renderActiveFlavor() {
            const detailsEl = document.getElementById('activeFlavorDetails');
            if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now()) {
                const flavor = state.activeCraftedFlavor;
                const remaining = Math.ceil((flavor.expires - Date.now()) / 1000);
                let bonusText = '';
                if (flavor.bonus.type === 'multiplier') bonusText = `+${(flavor.bonus.value - 1) * 100}% Œ£C`;
                if (flavor.bonus.type === 'crit_chance') bonusText = `+${flavor.bonus.value * 100}% Prob. Cr√≠tico`;
                if (flavor.bonus.type === 'afk_multiplier') bonusText = `+${(flavor.bonus.value - 1) * 100}% Ganancias AFK`;
                if (flavor.bonus.type === 'battery_saver') bonusText = `-${flavor.bonus.value * 100}% Consumo Bater√≠a`;
                if (flavor.bonus.type === 'chest_chance') bonusText = `+${flavor.bonus.value * 100}% Prob. Cofre`;
                if (flavor.bonus.type === 'gem_chance') bonusText = `+${flavor.bonus.value * 100}% Prob. Gema`;
                if (flavor.bonus.type === 'no_battery_drain') bonusText = `Bater√≠a no se gasta`;

                detailsEl.innerHTML = `
                    <strong>${flavor.name}</strong>
                    <p class="metaTiny">Bonus: ${bonusText}</p>
                    <p class="metaTiny">Tiempo restante: ${remaining}s</p>
                `;
            } else {
                detailsEl.innerHTML = `<p class="metaTiny" data-lang="no_active_flavor">${LANGUAGES[state.lang || 'es']['no_active_flavor']}</p>`;
            }
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.liquidId);
        }

        function handleDrop(e) {
            e.preventDefault();
            const slot = e.target.closest('.crafting-slot');
            if (!slot) return;
            slot.classList.remove('over');
            const liquidId = e.dataTransfer.getData('text/plain');
            if (liquidId && BASE_LIQUIDS[liquidId]) {
                slot.dataset.liquidId = liquidId;
                slot.innerHTML = `<div class="liquid-icon">${BASE_LIQUIDS[liquidId].icon}</div>`;
            }
        }

        function combineLiquids() {
            const slots = document.querySelectorAll('#craftingSlots .crafting-slot');
            const ingredients = Array.from(slots).map(slot => slot.dataset.liquidId).filter(id => id).sort();

            if (ingredients.length < 2) {
                showToast("Necesitas al menos 2 ingredientes.", "error");
                return;
            }

            // Check inventory
            const tempInventory = { ...state.liquidInventory };
            for (const id of ingredients) {
                if (!tempInventory[id] || tempInventory[id] <= 0) {
                    showToast("No tienes suficientes l√≠quidos.", "error");
                    return;
                }
                tempInventory[id]--;
            }

            const recipe = CRAFTING_RECIPES.find(r => JSON.stringify(r.ingredients) === JSON.stringify(ingredients));
            
            // Consume ingredients
            state.liquidInventory = tempInventory;

            if (recipe) {
                if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now()) {
                    if (!confirm("Ya tienes un sabor activo. ¬øQuieres reemplazarlo? Perder√°s el bonus actual.")) {
                        // Devolver ingredientes si el usuario cancela
                        ingredients.forEach(id => state.liquidInventory[id]++);
                        return;
                    }
                }
                 const result = recipe.result;
                 const durationBonus = state.craftedFlavorDurationBonus || 1;
                 state.activeCraftedFlavor = {
                     ...result,
                     id: result.id,
                     name: result.name,
                     expires: Date.now() + (result.duration * 1000 * durationBonus)
                 };
                 state.craftsDone = (state.craftsDone || 0) + 1;
                 showToast(`¬°Has creado ${result.name}!`, 'success');
                 saveState();
            } else {
                showToast("La combinaci√≥n ha fallado...", "error");
            }

            // Clear slots and update UI
            slots.forEach(slot => {
                delete slot.dataset.liquidId;
                slot.innerHTML = '';
            });
            renderLiquidInventory();
            renderActiveFlavor();
        }

        function buyShopFlavor(flavorId) {
            const flavor = SHOP_FLAVORS[flavorId];
            if (!flavor) return;

            if (state.activeCraftedFlavor && state.activeCraftedFlavor.expires > Date.now()) {
                if (!confirm("Ya tienes un sabor activo. ¬øQuieres reemplazarlo? Perder√°s el bonus actual.")) {
                    return;
                }
            }

            if (flavor.currency === 'sig' && state.sig >= flavor.cost) {
                state.sig -= flavor.cost;
            } else if (flavor.currency === 'gems' && state.gems >= flavor.cost) {
                state.gems -= flavor.cost;
            } else {
                showToast(`No tienes suficientes ${flavor.currency === 'sig' ? 'Œ£C' : 'gemas'}.`, 'error');
                return;
            }

            // Handle instant-effect flavors
            if (flavor.duration === 0) {
                if (flavor.bonus.type === 'instant_repair') {
                    state.fosoConditions[state.activeFosoIndex] = Math.min(100, (state.fosoConditions[state.activeFosoIndex] || 100) + flavor.bonus.value);
                    showToast(`Foso reparado en un ${flavor.bonus.value}%!`, 'success');
                } else if (flavor.bonus.type === 'instant_afk') {
                    const afkLevel = state.upgradeLevels.afk || 0;
                    if (afkLevel > 0) {
                        const sph = AFK_UPGRADES[afkLevel - 1].sph;
                        const earnings = (sph / 3600) * flavor.bonus.value;
                        state.sig += earnings;
                        showToast(`¬°Has ganado ${formatNum(earnings)} Œ£C de la poci√≥n!`, 'success');
                    } else {
                        showToast('Compra mejoras AFK para usar esta poci√≥n.', 'warning');
                    }
                }
                render();
                return; // Don't set it as an active flavor
            }

            state.activeCraftedFlavor = {
                ...flavor,
                expires: Date.now() + (flavor.duration * 1000)
            };
            showToast(`¬°Has activado ${flavor.name}!`, 'success');
            saveState();
            render();
        }

        function updateTutorialButtonStates(step) {
            const allButtons = rightMenu.querySelectorAll('.mata-btn');
            allButtons.forEach(btn => btn.disabled = true);
            menuToggle.disabled = true;

            // Enable buttons based on tutorial step
            switch (step) {
                case 0: // No tutorial
                    allButtons.forEach(btn => btn.disabled = false);
                    menuToggle.disabled = false;
                    break;
                case 1: // Click foso
                case 2: // See battery
                    break; // All disabled
                case 3: // Charge
                    btnChargeToggle.disabled = false;
                    break;
                case 4: // Open menu
                    menuToggle.disabled = false;
                    break;
                case 5: // Open shop
                    menuToggle.disabled = true; // Keep it disabled to focus on shop
                    btnShop.disabled = false;
                    break;
                case 6: // Buy foso
                    menuToggle.disabled = false;
                    btnShop.disabled = false;
                    break;
                case 7: // Open upgrades
                    menuToggle.disabled = true;
                    btnUpgrades.disabled = false;
                    break;
                case 8: // Introduce other features
                    menuToggle.disabled = true;
                    btnDaily.disabled = false;
                    btnWheel.disabled = true; // Keep some disabled to not overwhelm
                    btnMissions.disabled = false;
                    break;
            }
            // Re-evaluate disabled state based on game logic (e.g., cooldowns)
            render();
        }

        function showTutorialStep(step) {
            if (state.tutorialCompleted) return;

            const tutorialOverlay = document.getElementById('tutorialOverlay');
            const tutorialArrow = document.getElementById('tutorialArrow');
            const lang = state.lang || 'es';
            const translations = LANGUAGES[lang];
            state.tutorialStep = step;
            tutorialOverlay.classList.remove('hidden', 'tutorial-active');

            let targetEl;
            let text = '';
            let nextBtnText = translations.next;
            let isActionStep = false; // If true, button is hidden, advances on action
            
            switch (step) {
                case 1: // Click foso
                    targetEl = vaperWrap;
                    text = translations.tutorial_1;
                    isActionStep = true;
                    break; // Wait for user click
                case 2:
                    targetEl = batteryText;
                    text = translations.tutorial_2;
                    break;
                case 3:
                    targetEl = btnChargeToggle;
                    text = translations.tutorial_3;
                    isActionStep = true;
                    break;
                case 4:
                    targetEl = menuToggle;
                    text = translations.tutorial_4;
                    isActionStep = true;
                    break;
                case 5:
                    targetEl = btnShop;
                    text = "Ahora, entra en la Tienda para ver los fosos disponibles."; // Texto de ejemplo, deber√≠a usar traducciones
                    isActionStep = true;
                    break; // Wait for user click
                case 6:
                    targetEl = document.querySelector('.shopCard[data-index="1"]'); // Foso 2
                    text = translations.tutorial_5;
                    isActionStep = true; // Wait for user click
                    break; // Wait for user click
                case 7:
                    targetEl = btnUpgrades;
                    text = "¬°Buena compra! En el men√∫ tambi√©n encontrar√°s 'Mejoras Permanentes', que son muy √∫tiles para progresar.";
                    isActionStep = true; // This should be `isActionStep`
                    break;
                case 8:
                    targetEl = rightMenu;
                    text = translations.tutorial_7;
                    break;
                case 9:
                    targetEl = vaperWrap;
                    text = translations.tutorial_8;
                    nextBtnText = translations.got_it;
                    break;
                default:
                    tutorialOverlay.classList.add('hidden');
                    tutorialOverlay.classList.remove('tutorial-active');
                    state.tutorialCompleted = true;
                    updateTutorialButtonStates(0); // Enable all buttons
                    saveState();
                    return;
            }

            if (isActionStep) {
                tutorialNextBtn.classList.add('hidden');
            } else {
                tutorialNextBtn.classList.remove('hidden');
            }

            if (step > 0) {
                if (!targetEl || !targetEl.offsetParent) { // If element is hidden or doesn't exist, skip
                    checkTutorialProgress(step + 1);
                    return;
                }
            }

            tutorialOverlay.classList.add('tutorial-active');
            
            // Posicionar el bot√≥n de saltar
            tutorialSkipBtn.style.position = 'fixed';
            tutorialSkipBtn.style.top = '20px';
            tutorialSkipBtn.style.left = '20px';
            tutorialSkipBtn.classList.remove('hidden');

            tutorialText.innerText = text;
            tutorialNextBtn.textContent = nextBtnText;

            if (targetEl) {
                const rect = targetEl.getBoundingClientRect();
                tutorialHighlight.style.left = `${rect.left - 4}px`;
                tutorialHighlight.style.top = `${rect.top - 4}px`;
                tutorialHighlight.style.width = `${rect.width + 8}px`;
                tutorialHighlight.style.height = `${rect.height + 8}px`;

                // Position tooltip and arrow
                const tooltipRect = tutorialTooltip.getBoundingClientRect();
                let top, left, arrowClass;
                if (rect.bottom + tooltipRect.height + 25 > window.innerHeight) { // Place above
                    top = rect.top - tooltipRect.height - 15;
                    arrowClass = 'bottom';
                } else { // Place below
                    top = rect.bottom + 15;
                    arrowClass = 'top';
                }
                left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
                left = Math.max(10, Math.min(left, window.innerWidth - tooltipRect.width - 10));

                tutorialTooltip.style.top = `${top}px`;
                tutorialTooltip.style.left = `${left}px`;
                tutorialArrow.className = `tutorial-arrow ${arrowClass}`;
            }

            tutorialNextBtn.onclick = () => showTutorialStep(step + 1);

            tutorialSkipBtn.onclick = () => {
                tutorialOverlay.classList.add('hidden');
                tutorialOverlay.classList.remove('tutorial-active');
                state.tutorialCompleted = true;
                saveState();
                showToast('Tutorial saltado.', 'info');
            };
        }

        function checkTutorialProgress(nextStep) {
            if (state.tutorialCompleted || state.tutorialStep >= nextStep) return;
            
            // Hide current tutorial to avoid flicker
            const tutorialOverlay = document.getElementById('tutorialOverlay');
            tutorialOverlay.classList.remove('tutorial-active');

            // Show next step after a short delay
            setTimeout(() => showTutorialStep(nextStep), 150);
        }


        function handleTutorialAction(stepCondition) {
            if (!state.tutorialCompleted && state.tutorialStep === stepCondition) {
                checkTutorialProgress(stepCondition + 1);
            }
        }

        function startTutorial() {
            if (state.tutorialCompleted) {
                // updateTutorialButtonStates(0); // Ensure all buttons are enabled on load
                return;
            } else {
                // Delay start to allow intro animations to finish
                setTimeout(() => showTutorialStep(1), 8500);
            }
        }
        function openMaintenanceModal() {
            generateMaintenanceGame();
        }

        function generateMaintenanceGame() {
            const gameArea = maintenanceGameArea;
            gameArea.innerHTML = '';
            maintenanceSequence = [];
            currentMaintenanceStep = 0;

            const fosoHealth = state.fosoConditions[state.activeFosoIndex] || 100;
            if (fosoHealth === 100) {
                maintenanceInstructions.textContent = "El foso est√° en perfectas condiciones.";
                maintenanceRewardText.textContent = "";
                setTimeout(() => maintenanceModal.classList.add('hidden'), 1500);
                return;
            } else { maintenanceModal.classList.remove('hidden');}
            
            maintenanceInstructions.textContent = LANGUAGES[state.lang || 'es']['maintenance_instructions'];
            const reward = Math.floor((100 - fosoHealth) * 10 * (state.maintenanceRewardBonus || 1));
            maintenanceRewardText.textContent = LANGUAGES[state.lang || 'es']['maintenance_reward'].replace('{amount}', formatNum(reward));
            
            const numPoints = 4;
            for (let i = 1; i <= numPoints; i++) {
                const point = document.createElement('div');
                point.className = 'maintenance-point';
                point.textContent = i;
                point.dataset.id = i;

                // Posiciones aleatorias pero dentro del foso
                point.style.top = `${Math.random() * 70 + 10}%`; // Entre 10% y 80%
                point.style.left = `${Math.random() * 60 + 20}%`; // Entre 20% y 80%

                point.addEventListener('click', handleMaintenanceClick);
                gameArea.appendChild(point);
            }
        }

        function handleMaintenanceClick(e) {
            const clickedId = parseInt(e.target.dataset.id, 10);
            if (clickedId === currentMaintenanceStep + 1) {
                currentMaintenanceStep++;
                e.target.style.background = 'lightgreen';
                e.target.style.pointerEvents = 'none'; // Desactivar tras acierto

                if (currentMaintenanceStep === 4) { // 4 es el n√∫mero de puntos
                    // √âxito
                    const fosoHealth = state.fosoConditions[state.activeFosoIndex] || 100;
                    const reward = Math.floor((100 - fosoHealth) * 10 * (state.maintenanceRewardBonus || 1));
                    state.sig += reward;
                    state.totalSigEarned += reward;
                    state.fosoConditions[state.activeFosoIndex] = 100;
                    state.maintenancesDone = (state.maintenancesDone || 0) + 1;
                    showToast(LANGUAGES[state.lang || 'es'].foso_repaired_toast.replace('{amount}', formatNum(reward)), "success");
                    maintenanceModal.classList.add('hidden');
                }
            } else {
                // Error
                showToast("¬°Secuencia incorrecta! Int√©ntalo de nuevo.", "error");
                generateMaintenanceGame(); // Reiniciar
            }
        }

        function renderPets() {
            const petsGrid = document.getElementById('petsGrid');
            const petsGems = document.getElementById('petsGems');
            if (!petsGrid || !petsGems) return;

            petsGems.textContent = formatNum(state.gems);
            petsGrid.innerHTML = '';

            Object.values(PETS).forEach(pet => {
                const isUnlocked = state.unlockedPets.includes(pet.id);
                const isEquipped = state.equippedPet === pet.id;

                const card = document.createElement('div');
                card.className = 'shopCard';
                card.dataset.petId = pet.id;

                if (isEquipped) {
                    card.style.borderColor = 'var(--accent)';
                    card.style.boxShadow = '0 0 15px -3px var(--accent)';
                }

                card.innerHTML = `
                    <div style="font-size: 48px;">${pet.icon}</div>
                    <div style="font-weight:700;">${pet.name}</div>
                    <p class="hint" style="font-size:11px; margin: 4px 0; min-height: 2.5em;">${pet.description}</p>
                    <button class="mata-btn pet-action-btn" style="width: 100%; justify-content: center;"></button>
                `;

                const actionBtn = card.querySelector('.pet-action-btn');
                if (isEquipped) {
                    actionBtn.textContent = 'Equipado';
                    actionBtn.disabled = true;
                    actionBtn.style.background = '#27ae60';
                } else if (isUnlocked) {
                    actionBtn.textContent = 'Equipar';
                    actionBtn.dataset.action = 'equip';
                } else {
                    actionBtn.textContent = `Comprar (${formatNum(pet.cost)} üíé)`;
                    actionBtn.dataset.action = 'buy';
                    actionBtn.disabled = state.gems < pet.cost;
                }

                petsGrid.appendChild(card);
            });
        }

        function openPetsModal() {
            renderPets();
            petsModal.classList.remove('hidden');
            dotPets.classList.add('hidden');
        }

        function triggerRandomEvent() {
            if (state.activeEvent) return; // Don't start a new event if one is active

            if (Math.random() < CONFIG.eventChance) {
                const eventConfig = RANDOM_EVENTS[Math.floor(Math.random() * RANDOM_EVENTS.length)];
                state.eventsParticipated = (state.eventsParticipated || 0) + 1;
                state.activeEvent = {
                    id: eventConfig.id,
                    name_key: eventConfig.name_key,
                    expires: Date.now() + eventConfig.duration,
                };

                // Apply event effect
                if (eventConfig.onStart) {
                    eventConfig.onStart(state);
                }

                showToast(LANGUAGES[state.lang || 'es'][eventConfig.name_key], 'success', 5000);
                eventBanner.classList.remove('hidden');
            }
        }

        function updateEventUI() {
            if (!state.activeEvent) {
                eventBanner.classList.add('hidden');
                return;
            }

            const remaining = state.activeEvent.expires - Date.now();
            if (remaining <= 0) {
                // Event ended
                const eventConfig = RANDOM_EVENTS.find(e => e.id === state.activeEvent.id);
                if (eventConfig && eventConfig.onEnd) {
                    eventConfig.onEnd();
                }
                showToast("El evento ha terminado.", "info");
                state.activeEvent = null;
                eventBanner.classList.add('hidden');
            } else {
                eventName.textContent = LANGUAGES[state.lang || 'es'][state.activeEvent.name_key];
                eventTimer.textContent = `${Math.ceil(remaining / 1000)}s`;
            }
        }

        function openBlackMarket() {
            state.blackMarketOffers = [];
            // Generate 3 unique offers
            const availableFosos = FOSOS.map((f, i) => i).filter(i => i > 0 && !state.fososOwned.includes(i));
            
            for (let i = 0; i < 3 && availableFosos.length > 0; i++) {
                const randIndex = Math.floor(Math.random() * availableFosos.length);
                const fosoIndex = availableFosos.splice(randIndex, 1)[0];
                const discount = 0.3 + Math.random() * 0.4; // 30% - 70% discount
                const foso = FOSOS[fosoIndex];
                state.blackMarketOffers.push({
                    fosoIndex: fosoIndex,
                    cost: Math.round(foso.cost * (1 - discount)),
                });
            }
            renderBlackMarket();
            blackMarketModal.classList.remove('hidden');
        }

        function renderBlackMarket() {
            blackMarketGrid.innerHTML = '';
            state.blackMarketOffers.forEach((offer, i) => {
                if (offer.bought) return;
                const foso = FOSOS[offer.fosoIndex];
                const card = document.createElement('div');
                card.className = 'shopCard';
                card.dataset.offerIndex = i;
                card.innerHTML = `
                    <div class="metaTiny" style="font-weight:700">${document.querySelector(`.shopCard[data-index="${offer.fosoIndex}"] .metaTiny`).textContent}</div>
                    <div class="priceTag" style="color: #2ecc71;">${formatNum(offer.cost)} Œ£C</div>
                `;
                card.addEventListener('click', () => buyBlackMarketOffer(i));
                blackMarketGrid.appendChild(card);
            });
        }

        function buyBlackMarketOffer(offerIndex) {
            const offer = state.blackMarketOffers[offerIndex];
            if (!offer || offer.bought) return;

            if (state.sig >= offer.cost) {
                state.sig -= offer.cost;
                state.fososOwned.push(offer.fosoIndex);
                offer.bought = true; // Mark as bought
                showToast("¬°Buena compra!", "success");
                renderBlackMarket(); // Re-render to show it's gone
            } else {
                showToast("No tienes suficientes Sigmacoins.", "error");
            }
        }

        function updateMarket() {
            FOSOS.forEach((foso, index) => {
                if (foso.cost > 0) {
                    const change = (Math.random() * 0.20) + 0.05; // 5% to 25%
                    const direction = Math.random() > 0.5 ? 1 : -1;
                    state.market.priceMultipliers[index] = Math.max(0.5, 1 + (change * direction)); // Min price is 50% of base
                } else {
                    state.market.priceMultipliers[index] = 1;
                }
            });
            state.market.nextUpdate = Date.now() + CONFIG.marketUpdateInterval;
            showToast("¬°Los precios del mercado han cambiado!", "info");
            render();
        }

        function updateMarketStatus() {
            const remaining = state.market.nextUpdate - Date.now();
            if (remaining <= 0) return;
            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            marketStatusEl.textContent = `Pr√≥ximo cambio de precios en: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
                function closeAndAnimate(modal) {
            modal.classList.add('closing');
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('closing');
            }, 300); // Duraci√≥n de la animaci√≥n de salida
        }

        document.addEventListener('DOMContentLoaded', () => {
            updatePassiveRechargeLoop();
            loadState();
            checkMissionReset(); // Must be before render
            renderWheel(); // Initial check
            updatePassiveRechargeLoop();
            translateUI();
            updateAutoClickLoop(); // CORREGIDO: Llamada a la funci√≥n
            updatePassiveRechargeLoop(); // CORREGIDO: Asegura que la recarga pasiva se inicie al cargar partida

            render();

            setInterval(saveState, CONFIG.autosaveMs);

                        renderWheel();
            calculateAfkEarnings();
            checkWheelCooldown(); // Initial check

            // // Intervalo para la mec√°nica de quemado (DESACTIVADO)
            // setInterval(() => {
            //     if ((state.clicksThisSecond || 0) > CONFIG.overheatCps) {
            //         state.burned = true;
            //         showToast('¬°Has quemado el foso! Equipa otro o espera a que se enfr√≠e.', 'error');
            //         render();
            //     }
            //     state.clicksThisSecond = 0;
            // }, 1000);

            setInterval(() => { render(); updateMarketStatus(); updateEventUI(); renderActiveFlavor(); }, CONFIG.uiTickMs);
            setInterval(calculateAfkEarnings, 60000);
            setInterval(checkWheelCooldown, 1000);
            checkDailyReward();

            // Lluvia de monedas peri√≥dica
            setInterval(() => {
                const rainContainer = document.createElement('div');
                rainContainer.className = 'coin-rain';
                document.body.appendChild(rainContainer);

                for (let i = 0; i < 50; i++) {
                    const coin = document.createElement('div');
                    coin.className = 'coin';
                    coin.textContent = 'Œ£';
                    coin.style.left = `${Math.random() * 100}vw`;
                    coin.style.animationDelay = `${Math.random() * 4}s`;
                    coin.style.fontSize = `${Math.random() * 16 + 12}px`;
                    coin.style.opacity = `${Math.random() * 0.5 + 0.5}`;
                    rainContainer.appendChild(coin);
                }

                showToast("¬°Lluvia de Sigmacoins!", "success", 4000);

                setTimeout(() => {
                    rainContainer.remove();
                }, 5000); // Duraci√≥n de la animaci√≥n + delay
            }, 20 * 60 * 1000); // 20 minutos

            eventInterval = setInterval(triggerRandomEvent, CONFIG.eventInterval);
            if (Date.now() > state.market.nextUpdate) {
                updateMarket();
            }
            marketUpdateInterval = setInterval(updateMarket, CONFIG.marketUpdateInterval);

            if (menuToggle) {
                menuToggle.addEventListener('click', () => {
                    rightMenu.classList.toggle('active');
                    // handleTutorialAction(4); // Descomentar si se usa el tutorial
                });
            }
            dotChests.classList.toggle('hidden', state.chests.length === 0);

            if(langSelect) langSelect.value = state.lang || 'es';

            if(centralFoso) centralFoso.addEventListener('click', handleCentralClick);

            if(btnMaintenance) btnMaintenance.addEventListener('click', openMaintenanceModal);
            if(maintenanceModal) {
                             maintenanceModal.querySelector('.close-btn').addEventListener('click', () => { 
                    closeAndAnimate(maintenanceModal);
                });
            }

            if(blackMarketModal) {
                             blackMarketModal.querySelector('.close-btn').addEventListener('click', () => { 
                    closeAndAnimate(blackMarketModal);
                });
            }

            const promoBtn = document.getElementById('promoBtn');
            if (promoBtn) {
                promoBtn.addEventListener('click', () => {
                    const code = promoInput.value.trim().toUpperCase();
                    if (!code) return;

                    const exclusiveFosoCodes = {
                        "F_DYLAND": 97, "F_AZIZ": 98, "F_ALI": 99, "F_DAVID": 100,
                        "F_ESTEVA": 101, "F_CALFA": 102
                    };

                    if (code === 'DISCORD') {
                        state.sig += 200000;
                        state.gems += 100;
                        state.exclusiveMoney += 200;
                        if (!state.fososOwned.includes(102)) state.fososOwned.push(102);
                        showToast('¬°Recompensas del c√≥digo DISCORD recibidas!', 'success');
                    } else if (exclusiveFosoCodes[code]) { // CORREGIDO: Usar el √≠ndice del foso en lugar del ID.
                        const fosoId = exclusiveFosoCodes[code];
                        const fosoIndex = FOSOS.findIndex(f => f.id === fosoId);
                        if (fosoIndex !== -1 && !state.fososOwned.includes(fosoIndex)) {
                            state.fososOwned.push(fosoIndex);
                            showToast(`¬°Has desbloqueado el ${FOSOS[fosoIndex].name}!`, 'success');
                            render(); // CORREGIDO: Actualiza la tienda para mostrar el foso como "Adquirido"
                        } else {
                            showToast('Ya tienes este foso.', 'warning');
                        }
                    } else if (code === 'SG') {
                        state.exclusiveMoney = (state.exclusiveMoney || 0) + 3000;
                        showToast('¬°C√≥digo SG! +3,000 Monedas Exclusivas üëë.', 'success');
                    } else if (code === 'SIGMA') {
                        state.sig += 1000;
                        state.totalSigEarned += 1000;
                        showToast('¬°C√≥digo SIGMA! +1,000 Œ£C.', 'success');
                    } else if (code === 'GEMAS') {
                        state.gems += 50;
                        showToast('¬°C√≥digo GEMAS! +50 gemas.', 'success');
                    }else {
                        showToast('C√≥digo promocional no v√°lido.', 'error');
                    }
                    promoInput.value = '';
                });
            }


            if(btnPower) {
                btnPower.addEventListener('click', () => {
                    state.powerOn = !state.powerOn; // CORREGIDO
                    const powerStatus = state.powerOn ? 'encendido' : 'apagado';
                    const color = state.powerOn ? 'success' : 'error';
                    btnPower.style.background = state.powerOn ? '#0ea5b7' : '#555';
                    showToast(`Foso ${powerStatus}.`, color);
                    render();
                });
            }

            if(btnChargeToggle) btnChargeToggle.addEventListener('click', toggleCharging);
            
            if(btnShop) btnShop.addEventListener('click', () => {
              if(shopModal) shopModal.classList.remove('hidden');
            });

            if(shopModal) {
              shopModal.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', () => { 
                  closeAndAnimate(shopModal);
                });
              });
            }

            if(btnUpgrades) btnUpgrades.addEventListener('click', () => {
           
                renderUpgrades();
                upgradesModal.classList.remove('hidden');
            });
            if(upgradesModal) {
                upgradesModal.querySelector('.close-btn').addEventListener('click', () => {
                    upgradesModal.classList.add('hidden');
                });
            }

            if(btnRebirth) btnRebirth.addEventListener('click', openRebirthModal);
            if(rebirthModal) {
                rebirthModal.querySelector('.close-btn').addEventListener('click', () => {
                    rebirthModal.classList.add('hidden');
                });
                document.getElementById('btnConfirmRebirth').addEventListener('click', handleRebirth);
            }

            if(btnCrafting) btnCrafting.addEventListener('click', openCraftingModal);
            if(craftingModal) {
                craftingModal.querySelector('.close-btn').addEventListener('click', () => craftingModal.classList.add('hidden'));
                document.getElementById('btnCombine').addEventListener('click', combineLiquids);
                const slots = craftingModal.querySelectorAll('.crafting-slot');
                slots.forEach(slot => {
                    slot.addEventListener('dragover', (e) => { e.preventDefault(); slot.classList.add('over'); });
                    slot.addEventListener('dragleave', () => slot.classList.remove('over'));
                    slot.addEventListener('drop', handleDrop);
                    slot.addEventListener('click', () => { // Clear slot on click
                        delete slot.dataset.liquidId; slot.innerHTML = '';
                    });
                });
            }

            if(btnPrestige) btnPrestige.addEventListener('click', openPrestigeModal);
            if(prestigeModal) {
                prestigeModal.querySelector('.close-btn').addEventListener('click', () => {
                    prestigeModal.classList.add('hidden');
                });
                document.getElementById('btnConfirmPrestige').addEventListener('click', handlePrestige);
                prestigeModal.querySelector('#prestigeUpgradesGrid').addEventListener('click', (e) => {
                    if (e.target.classList.contains('buy-prestige-btn')) buyPrestigeUpgrade(e.target.dataset.id);
                });
            }


            
            if(btnConfig) btnConfig.addEventListener('click', ()=> {
              if(configModal) configModal.classList.remove('hidden');
              chkSmoke.checked = state.settings.smokeEnabled;
              chkClickNumbers.checked = state.settings.clickNumbersEnabled;
              musicVolumeSlider.value = state.settings.musicVolume;
              sfxVolumeSlider.value = state.settings.sfxVolume;
            });

            
            if(btnConfig) btnConfig.addEventListener('click', ()=> {
              if(configModal) configModal.classList.remove('hidden');
              chkSmoke.checked = state.settings.smokeEnabled;
              chkClickNumbers.checked = state.settings.clickNumbersEnabled;
              musicVolumeSlider.value = state.settings.musicVolume;
              sfxVolumeSlider.value = state.settings.sfxVolume;
            });

            if(configModal) {
              configModal.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                  configModal.classList.add('hidden');
                });
              });
            }

            if(langSelect) langSelect.addEventListener('change', (e) => {
                state.lang = e.target.value;
                translateUI();
                render(); // Re-render dynamic parts like cooldowns
            });

            if(chkSmoke) chkSmoke.addEventListener('change', (e) => {
                state.settings.smokeEnabled = e.target.checked;
            });

            if(chkClickNumbers) chkClickNumbers.addEventListener('change', (e) => {
                state.settings.clickNumbersEnabled = e.target.checked;
            });

            if(musicVolumeSlider) musicVolumeSlider.addEventListener('input', (e) => {
                state.settings.musicVolume = parseFloat(e.target.value);
                if(bgMusic) bgMusic.volume = state.settings.musicVolume;
            });

            if(sfxVolumeSlider) sfxVolumeSlider.addEventListener('input', (e) => {
                state.settings.sfxVolume = parseFloat(e.target.value);
            });

            if(btnManualSave) btnManualSave.addEventListener('click', () => {
                saveState();
                showToast('¬°Progreso guardado!', 'success');
            });

            if(btnRepeatTutorial) btnRepeatTutorial.addEventListener('click', () => {
                state.tutorialCompleted = false;
                state.tutorialStep = 0;
                configModal.classList.add('hidden');
                showToast('El tutorial se mostrar√° de nuevo.', 'info');
                startTutorial();
            });

            if(btnReset) btnReset.addEventListener('click', ()=>{
              if(confirm('‚ö†Ô∏è Esto borrar√° absolutamente TODO el progreso guardado en este juego.')){
                localStorage.clear();
                state = {};
                location.reload(true);
              }
            });

            if(btnMata) btnMata.addEventListener('click', ()=>{
              const now = Date.now();
              if(state.mataCooldownUntil && state.mataCooldownUntil > now) return;
              state.sig += CONFIG.mataReward;
              state.totalSigEarned += CONFIG.mataReward;
              state.mataUses = (state.mataUses || 0) + 1;
              state.mataCooldownUntil = now + CONFIG.mataCooldownSec*1000;
              checkAchievements();
              render();
            });

            if(btnDaily) btnDaily.addEventListener('click', openDailyModal);
            if(closeDaily) closeDaily.addEventListener('click', () => dailyModal.classList.add('hidden'));
            if(btnClaimDaily) btnClaimDaily.addEventListener('click', claimDailyReward);
            
            if(powersModal) {
                powersModal.querySelector('.close-btn').addEventListener('click', () => closeAndAnimate(powersModal));
            }
            if(btnAFK) btnAFK.addEventListener('click', openAfkModal);
            if(afkModal) afkModal.querySelector('.close-btn').addEventListener('click', () => closeAndAnimate(afkModal));
            if(btnClaimAFK) btnClaimAFK.addEventListener('click', claimAfkEarnings);
            if(btnUpgradeAFK) btnUpgradeAFK.addEventListener('click', upgradeAfk);
            afkModal.querySelectorAll('[data-close]').forEach(btn => btn.addEventListener('click', () => afkModal.classList.add('hidden')));

            if(btnWheel) {
                btnWheel.addEventListener('click', () => {
                    wheelModal.classList.remove('hidden');
                });
            }

            if(wheelModal) {
                wheelModal.querySelector('.close-btn').addEventListener('click', () => {
                    wheelModal.classList.add('hidden');
                });
            }

            if(btnSpinWheel) {
                btnSpinWheel.addEventListener('click', spinWheel);
            }

            if(btnMissions) {
                btnMissions.addEventListener('click', () => {
                    renderMissions();
                    missionsModal.classList.remove('hidden');
                });
            }

            if(btnPromo) {
                btnPromo.addEventListener('click', () => {
                    promoModal.classList.remove('hidden');
                });
            }

            if(promoModal) {
                promoModal.querySelector('.close-btn').addEventListener('click', () => { 
                    closeAndAnimate(promoModal);
                });
            }

            if(missionsModal) {
                missionsModal.querySelector('.close-btn').addEventListener('click', () => { 
                    closeAndAnimate(missionsModal);
                });
            }

            if(btnAchievements) {
                btnAchievements.addEventListener('click', () => {
                    renderAchievements();
                    achievementsModal.classList.remove('hidden');
                    dotAchievements.classList.add('hidden');
                });
            }

            if(achievementsModal) {
                achievementsModal.querySelector('.close-btn').addEventListener('click', () => {
                    achievementsModal.classList.add('hidden');
                });
            }

            if(btnChests) {
                btnChests.addEventListener('click', openChestsModal);
            }
            if(chestsModal) {
                chestsModal.querySelector('.close-btn').addEventListener('click', () => {
                    chestsModal.classList.add('hidden');
                });
            }

            if (btnPets) {
                btnPets.addEventListener('click', openPetsModal);
            }
            // Cargar sonidos
            bgMusic = document.getElementById('bgMusic');
            clickSfx = document.getElementById('clickSfx');
            buySfx = document.getElementById('buySfx');
            successSfx = document.getElementById('successSfx');
            errorSfx = document.getElementById('errorSfx');
            if (petsModal) {
                petsModal.querySelector('.close-btn').addEventListener('click', () => {
                    petsModal.classList.add('hidden');
                });
                petsModal.querySelector('#petsGrid').addEventListener('click', handlePetAction);
            }





            if (shopModal) {
                shopModal.addEventListener('click', (e) => {
                    const card = e.target.closest('.shopCard');
                    if (!card) return;

                    const itemIndex = card.dataset.index; // For fosos
                    const gemFosoIndex = card.dataset.gemFosoIndex; // For gem fosos
                    const flavorId = card.dataset.flavorId; // For flavors

                    if (itemIndex !== undefined) {
                        const index = parseInt(itemIndex, 10);
                        const item = FOSOS[index];
                        if (!item) return;

                        if (state.fososOwned.includes(index)) {
                            state.activeFosoIndex = index;
                            showToast(`Foso ${item.name} equipado.`, 'info');
                            if (state.burned) {
                                state.burned = false;
                                showToast('Foso nuevo equipado, ¬°listo para usar!', 'success');
                            }
                        } else {
                            if (item.exclusive) {
                                const cost = parseInt(card.querySelector('.priceTag').dataset.cost, 10);
                                if (state.exclusiveMoney >= cost) {
                                    state.exclusiveMoney -= cost;
                                    state.fososOwned.push(index);
                                    state.activeFosoIndex = index;
                                    showToast(`Foso ${item.name} comprado y equipado!`, 'success');
                                    playSound('buySfx');
                                    checkAchievements();
                                } else {
                                    showToast('No tienes suficientes üëë.', 'error');
                                }
                            } else {
                                const currentCost = Math.round(item.cost * (state.market.priceMultipliers[index] || 1));
                                if (state.sig >= currentCost) {
                                    state.sig -= currentCost;
                                    state.fososOwned.push(index);
                                    state.activeFosoIndex = index;
                                    showToast(`Foso ${item.name} comprado y equipado!`, 'success');
                                    playSound('buySfx');
                                    updateMissionProgress('buy_foso', 1);
                                    checkAchievements();
                                } else {
                                    showToast('No tienes suficientes Sigmacoins.', 'error');
                                }
                            }
                        }
                    } else if (gemFosoIndex !== undefined) {
                        const index = parseInt(gemFosoIndex, 10);
                        const item = GEM_FOSOS[index];
                        if (!state.gemFososOwned.includes(index)) {
                            if (state.gems >= item.cost) {
                                state.gems -= item.cost;
                                state.gemFososOwned.push(index);
                                showToast(`¬°Foso de Gema comprado! Bonus de ganancias +5%`, 'success');
                                playSound('buySfx');
                            } else {
                                showToast('No tienes suficientes gemas.', 'error');
                            }
                        }
                    } else if (flavorId) {
                        buyShopFlavor(flavorId);
                    }
                    render();
                });
            }

            if (upgradesGrid) {
                upgradesGrid.addEventListener('click', (e) => {
                    const button = e.target.closest('button[data-upgrade]');
                    if (!button) return;

                    const upgradeType = button.dataset.upgrade; // CORREGIDO: Se usa la lista completa de mejoras
                    const allUpgrades = {
                        autoclicker: AUTOCLICKER_UPGRADES,
                        battery: BATTERY_UPGRADES,
                        critical: CRITICAL_UPGRADES,
                        efficiency: EFFICIENCY_UPGRADES,
                        combo: COMBO_UPGRADES,
                        liquid_luck: LIQUID_LUCK_UPGRADES,
                        passive_recharge: PASSIVE_RECHARGE_UPGRADES
                    };
                    const upgrades = allUpgrades[upgradeType];
                    const level = state.upgradeLevels[upgradeType] || 0;

                    if (level < upgrades.length) {
                        if (!state.upgradeLevels[upgradeType]) state.upgradeLevels[upgradeType] = 0;
                        const cost = upgrades[level].cost;
                        if (state.sig >= cost) {
                            state.sig -= cost;
                            state.upgradeLevels[upgradeType]++;
                            if (upgradeType === 'battery') state.maxBattery = upgrades[level].capacity;
                    if (upgradeType === 'autoclicker') updateAutoClickLoop(); // CORREGIDO: Llamada a la funci√≥n
                        
                            playSound('buySfx');
                            showToast(`¬°Mejora de ${upgradeType} comprada!`, 'success');
                            renderUpgrades();
                        }
                    }
                });
            }

        });

        function handlePetAction(e) {
            const button = e.target.closest('.pet-action-btn');
            if (!button) return;

            const card = button.closest('.shopCard');
            const petId = card.dataset.petId;
            const pet = PETS[petId];
            const action = button.dataset.action;

            if (action === 'buy') {
                if (state.gems >= pet.cost) {
                    state.gems -= pet.cost;
                    state.unlockedPets.push(petId);
                    playSound('buySfx');
                    showToast(`¬°Has adoptado a ${pet.name}!`, 'success');
                    renderPets();
                } else {
                    showToast('No tienes suficientes gemas.', 'error');
                }
            } else if (action === 'equip') {
                state.equippedPet = petId;
                playSound('successSfx');
                renderPets();
            }
        }

        function buyPrestigeUpgrade(id) {
            const upgrade = PRESTIGE_UPGRADES[id];
            const level = state.prestigeUpgrades[id] || 0;
            const cost = upgrade.cost * (level + 1);

            if (state.prestigePoints >= cost && level < upgrade.maxLevel) {
                state.prestigePoints -= cost;
                state.prestigeUpgrades[id] = (state.prestigeUpgrades[id] || 0) + 1;
                showToast(`¬°Mejora de prestigio '${upgrade.name}' comprada!`, 'success');
                saveState();
                openPrestigeModal(); // Refresh
            }
        }
    })();
</script>


<!-- Elementos de Audio -->
<audio id="bgMusic" loop src="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAAAAACQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEA//tA0BMAAAAAAABEluZm8AAAAPAAAABAAAASAAAAAAAAAAAAAAAAAAAAAAQU1BVE9SQUxTVE9SRQAA//tA1BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA2BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA3BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA4BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA5BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA6BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA7BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA8BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA9BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA+BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tA/BMAAAAAAAABAAAAAQU1BVE9SQUxTVE9SRQAA//tBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-"></audio>
<audio id="clickSfx" src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAAABkYXRhAAAAAA=="></audio>
<audio id="buySfx" src="data:audio/wav;base64,UklGRlIAAABXQVZFZm10IBAAAAABAAIARKwAABCxAgAEABgAZGF0YUYAAAD/////////////////v/7//v/+/////v/9//7/+//6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/e/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/a/UklGRlIAAABXQVZFZm10IBAAAAABAAIARKwAABCxAgAEABgAZGF0YUYAAAD/////////////////v/7//v/+/////v/9//7/+//6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/a/UklGRlIAAABXQVZFZm10IBAAAAABAAIARKwAABCxAgAEABgAZGF0YUYAAAD/////////////////v/7//v/+/////v/9//7/+//6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/6//r/+v/-"></audio>
<audio id="errorSfx" src="data:audio/wav;base64,UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAP//8v/L/8f/x//D/8T/wv/C/8P/w//E/8T/xP/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8-"></audio>
<audio id="successSfx" src="data:audio/wav;base64,UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAP//8v/L/8f/x//D/8T/wv/C/8P/w//E/8T/xP/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8//-"></audio>
<audio id="chestOpenSfx" src="data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAAABkYXRhPAAAAP//8v/L/8f/x//D/8T/wv/C/8P/w//E/8T/xP/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8X/xf/F/8//-"></audio>
</body>
</html>
